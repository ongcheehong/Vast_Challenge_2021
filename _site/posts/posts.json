[
  {
    "path": "posts/welcome/",
    "title": "Welcome to Vast Challenge 2021",
    "description": "Welcome to our new blog, Vast Challenge 2021. We hope you enjoy \nreading what we have to say!",
    "author": [
      {
        "name": "Nora Jones",
        "url": "https://example.com/norajones"
      }
    ],
    "date": "2021-07-27",
    "categories": [],
    "contents": "\r\n\r\n\r\n\r\n",
    "preview": {},
    "last_modified": "2021-07-27T12:53:22+08:00",
    "input_file": {}
  },
  {
    "path": "posts/2021-07-27-vastchallengepart1/",
    "title": "Vast Challenge Part 1",
    "description": "Welcome to Ong Chee Hong's Vast Challenge 2021 Assignment",
    "author": [
      {
        "name": "Ong Chee Hong",
        "url": "https://www.linkedin.com/in/alexongch/"
      }
    ],
    "date": "2021-07-27",
    "categories": [],
    "contents": "\r\nVast Challenge 2021: Mini-Challenge 2\r\nBackground\r\nMany of the Abila, Kronos-based employees of GAStech have company cars which are approved for both personal and business use. Those who do not have company cars have the ability to check out company trucks for business use, but these trucks cannot be used for personal business.\r\nEmployees with company cars are happy to have these vehicles, because the company cars are generally much higher quality than the cars they would be able to afford otherwise. However, GAStech does not trust their employees. Without the employees? knowledge, GAStech has installed geospatial tracking software in the company vehicles. The vehicles are tracked periodically as long as they are moving.\r\nThis vehicle tracking data has been made available to law enforcement to support their investigation. Unfortunately, data is not available for the day the GAStech employees went missing. Data is only available for the two weeks prior to the disappearance.\r\nTo promote local businesses, Kronos based companies provide a Kronos Kares benefit card to GASTech employees giving them discounts and rewards in exchange for collecting information about their credit card purchases and preferences as recorded on loyalty cards. This data has been made available to investigators in the hopes that it can help resolve the situation. However, Kronos Kares does not collect personal information beyond purchases.\r\nAs a visual analytics expert assisting law enforcement, your mission is to identify which GASTech employees made which purchases and identify suspicious patterns of behavior. You must cope with uncertainties that result from missing, conflicting, and imperfect data to make recommendations for further investigation.\r\nQuestions\r\nUsing just the credit and loyalty card data, identify the most popular locations, and when they are popular. What anomalies do you see? What corrections would you recommend to correct these anomalies? Please limit your answer to 8 images and 300 words.\r\nAdd the vehicle data to your analysis of the credit and loyalty card data. How does your assessment of the anomalies in question 1 change based on this new data? What discrepancies between vehicle, credit, and loyalty card data do you find? Please limit your answer to 8 images and 500 words.\r\nCan you infer the owners of each credit card and loyalty card? What is your evidence? Where are there uncertainties in your method? Where are there uncertainties in the data? Please limit your answer to 8 images and 500 words.\r\nGiven the data sources provided, identify potential informal or unofficial relationships among GASTech personnel. Provide evidence for these relationships. Please limit your response to 8 images and 500 words.\r\nDo you see evidence of suspicious activity? Identify 1- 10 locations where you believe the suspicious activity is occurring, and why Please limit your response to 10 images and 500 words.\r\nScope of work\r\nTo address the questions above, below is the required scope of work 1. Literature Review 2. Data preparation 3. Methodology and visualisation 4. Answers 5. Acknowledgment\r\n1. Literature Review\r\nThis year Vast Challenge uses the same question based on 2014 Vast Challenge. As such, we will conduct literature review on past 2014 Vast Challenge submission based on MC2 – Patterns of Life Analysis. We will select some of the past submission to identify some of the gaps that can potentially utilized interactive data visualization techniques to improve user experiences. The repository for 2014 Vast Challenge – MC2: Patterns of Life Analysis submissions can be found here\r\n1.1 University of Buenos Aries - Arcaya.\r\nThe localization of different people based on bar chart is difficult to visualize as there are too many people with indicated by different type of colours and there are too many locations thereby squeezing the bar chart altogether. A recommendation is to split location up into 3-4 groups so that it will be easier to visualize.\r\n\r\n1.2 Shandong University\r\nThe price vs consumption area by using density plot is not a very good idea as it is very confusing to know which employee is which as there are too many employees squeeze into one chart. There is no legend or tooltip to indicate the employees.\r\n\r\n1.3. ASTRI\r\nThe bar chart used to indicate less frequented location is too squeezy especially those portion with many departments squeeze into one location. These makes it difficult for people to analyse. A recommendation is to group the data into lesser locations and possibly provided some interactivity where user can click the legend to select the department they want.\r\n\r\n2. Data preparation\r\n2.1 Customisation of code chunks\r\nFirst, we will customize the all code chunks using the below knitr code. More information on chunk options can be found here\r\n2.2 Installing required R packages\r\nNext, we will install the required R packages. There are three basic groups of packages that we will install,\r\nFor data manipulation and preparation The tidyverse package is a group of R packages including dplyr, tidyr that assist user to manipulate data.\r\nDate and Time The two packages clock and lubridate are used for the manipulation of date and time data\r\nInteractive data analysis The two packages ggiraph and plotly are used to output data into interactive graphical/chart form for analysis.\r\nGeoVisual Analysis The packages raster, sf,tmap and rgdal are used for geospatial visual analytics where data are output to a map for analysis such as movement of people etc.\r\nNetwork Analysis Lastly, to analyse the relationship between people etc. We will use the packages from tidygraph, igraph, ggraph and visNetwork. visNetwork is a package to output interactive network analysis.\r\n\r\n\r\npackages = c('DT','ggiraph','plotly','tidyverse', 'raster','sf','clock','tmap',\r\n             'rgdal','dplyr', 'tidyr', 'textclean', \"plotly\", \"forcats\", \"jpeg\", \"tiff\",\r\n             \"mapview\",\"tidygraph\",\"igraph\",\"ggraph\",\"visNetwork\",\"leaflet\",\"lubridate\")\r\nfor(p in packages){\r\n  if(!require(p,character.only = T)){\r\n    install.packages(p)\r\n  }\r\n  library(p,character.only = T)\r\n}\r\n\r\n\r\n\r\n2.3 Provided data and information\r\nThere are 3 different types of data & information provided. A geospatial dataset, csv files and a jpg file consisting of the Abila tourist map.\r\nBelow is the information of all the data provided.\r\n2.3.1. A csv file on vehicle assignments to employee (car-assignments.csv)\r\nEmployee Last Name\r\nEmployee First Name\r\nCar ID (integer)\r\nCurrent Employment Type (Department; categorical)\r\nCurrent Employment Title (job title; categorical)\r\n2.3.2. A CSV file of vehicle tracking data (gps.csv)\r\n3.1 Timestamp\r\n3.2 Car ID (integer)\r\n3.3 Latitude\r\n3.4 Longitude\r\n2.3.3. A CSV file containing loyalty card transaction data (loyalty_data.csv)\r\n4.1 Timestamp\r\n4.2 Location (name of the business)\r\n4.3 Price (real)\r\n4.4 Loyalty Number (A 5-character code starting with L that is unique for each card)\r\n2.3.4. A CSV file containing credit and debit card transaction data (cc_data.csv)\r\n5.1 Timestamp\r\n5.2 Location (name of the business)\r\n5.3 Price (real)\r\n5.4 Last 4 digits of the credit or debit card number\r\n2.3.5. ESRI shapefiles of Abila (in the Geospatial folder)\r\n2.3.6. A tourist map of Abila with locations of interest identified, in JPEG format (MC2-Tourist.jpg)\r\n2.4. Importing of data\r\nWe will import the 4 different csv datasets that were provided\r\n\r\n\r\ncar <- read_csv(\"data/mc2/car-assignments.csv\")\r\ncc <- read_csv(\"data/mc2/cc_data.csv\")\r\ngps <- read_csv(\"data/mc2/gps.csv\")\r\nloyalty <- read_csv(\"data/mc2/loyalty_data.csv\")\r\n\r\n\r\n\r\nIf we take a look at the above datasets in excel, we will see that there are foreign characters in some of the datasets provided. An example is the Katerina’s Cafe as shown below. To address this, we will need to encode the dataset to allow rstudio to read properly.\r\n\r\nTo allow use to know the encoding type for both cc and loyalty dataset. Guess encoding will be used to detect the encoding type as shown below..\r\n\r\n\r\nguess_encoding(cc)\r\n\r\n\r\n# A tibble: 1 x 2\r\n  encoding confidence\r\n  <chr>         <dbl>\r\n1 ASCII             1\r\n\r\nguess_encoding(loyalty)\r\n\r\n\r\n# A tibble: 1 x 2\r\n  encoding confidence\r\n  <chr>         <dbl>\r\n1 ASCII             1\r\n\r\nNext, we will add the code locale = locale(encoding = “ASCII” on both cc and loyalty dataset)\r\n\r\n\r\ncar <- read_csv(\"data/mc2/car-assignments.csv\")\r\ncc <- read_csv(\"data/mc2/cc_data.csv\", locale = locale(encoding = \"ASCII\"))\r\ngps <- read_csv(\"data/mc2/gps.csv\")\r\nloyalty <- read_csv(\"data/mc2/loyalty_data.csv\",locale = locale(encoding = \"ASCII\"))\r\n\r\n\r\n\r\n2.5. Data examination\r\nFirst, we will look at both cc and loyalty card dataset by using the glimpse function as shown below. There are 1490 rows and 1392 rows in both the cc and loyatly dataset respectfully. If we take look closely, we will see that these two datasets are closely linked by location, price and timestamp except the last4ccnum and loyaltynum are different.\r\nIf we take a look back at the MC2 background, we will observe that Kronos based companies are allowed to collect credit card and loyalty cards information on GAStech employees purchases as such these two datasets are similar in nature.\r\nHowever, the rows for both cc and loyalty card data are different. This anomaly might have a few reasoning, 1) the employees did not used their credit cards while doing purchases but loyalty card was presented. 2) Vice versa, employees might also used their credit card but did not present their loyalty card during purchases.\r\n\r\n\r\nglimpse(cc)\r\n\r\n\r\nRows: 1,490\r\nColumns: 4\r\n$ timestamp  <chr> \"1/6/2014 7:28\", \"1/6/2014 7:34\", \"1/6/2014 7:35\"~\r\n$ location   <chr> \"Brew've Been Served\", \"Hallowed Grounds\", \"Brew'~\r\n$ price      <dbl> 11.34, 52.22, 8.33, 16.72, 4.24, 4.17, 28.73, 9.6~\r\n$ last4ccnum <dbl> 4795, 7108, 6816, 9617, 7384, 5368, 7253, 4948, 9~\r\n\r\nglimpse(loyalty)\r\n\r\n\r\nRows: 1,392\r\nColumns: 4\r\n$ timestamp  <chr> \"1/6/2014\", \"1/6/2014\", \"1/6/2014\", \"1/6/2014\", \"~\r\n$ location   <chr> \"Brew've Been Served\", \"Brew've Been Served\", \"Ha~\r\n$ price      <dbl> 4.17, 9.60, 16.53, 11.51, 12.93, 4.27, 11.20, 15.~\r\n$ loyaltynum <chr> \"L2247\", \"L9406\", \"L8328\", \"L6417\", \"L1107\", \"L40~\r\n\r\nNext, we will look at the vehicle datasets. The 44 rows car datasets are represented by the employee, employment information with their car assignment ID.\r\nThe gps datasets are based on the car movements in respect to their lat and long position with timestamp.\r\n\r\n\r\nglimpse(car)\r\n\r\n\r\nRows: 44\r\nColumns: 5\r\n$ LastName               <chr> \"Calixto\", \"Azada\", \"Balas\", \"Barranc~\r\n$ FirstName              <chr> \"Nils\", \"Lars\", \"Felix\", \"Ingrid\", \"I~\r\n$ CarID                  <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12~\r\n$ CurrentEmploymentType  <chr> \"Information Technology\", \"Engineerin~\r\n$ CurrentEmploymentTitle <chr> \"IT Helpdesk\", \"Engineer\", \"Engineer\"~\r\n\r\nglimpse(gps)\r\n\r\n\r\nRows: 685,169\r\nColumns: 4\r\n$ Timestamp <chr> \"1/6/2014 6:28\", \"1/6/2014 6:28\", \"1/6/2014 6:28\",~\r\n$ id        <dbl> 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35~\r\n$ lat       <dbl> 36.07623, 36.07622, 36.07621, 36.07622, 36.07621, ~\r\n$ long      <dbl> 24.87469, 24.87460, 24.87444, 24.87425, 24.87417, ~\r\n\r\n2.6. Data Preparation\r\n2.6.1 CC and Loyalty dataset\r\nWe will prepare the cc and loyalty datasets for data exploration later.\r\n2.6.1.1. Changing the datatypes of last4ccnum & loyaltynum\r\nThe last4ccnum of the cc datasets and the loyaltynum of the loyalty dataset should be a categorical data type. As such, we will change it by using the as.factor function.\r\n\r\n\r\ncc$last4ccnum <- as.factor(cc$last4ccnum)\r\nloyalty$loyaltynum <- as.factor(loyalty$loyaltynum)\r\n\r\n\r\n\r\nNext, we will modify the datatype for both the timestamp of cc and loyalty dataset using the clock package. If we observe below, the data_time_parse function is use to change the timestamp to dttm (datetime) format while the date_parse function is used to change the data to date format.\r\n\r\n\r\ncc$timestamp <- date_time_parse(cc$timestamp,\r\n                                 zone = \"\",\r\n                                 format = \"%m/%d/%Y %H:%M\")\r\n\r\nloyalty$timestamp <- date_parse(loyalty$timestamp,\r\n                                 format = \"%m/%d/%Y\")\r\n\r\n\r\n\r\nWe will double check the dataset to confirm that the datatype has been changed to the one we wanted.\r\n\r\n\r\nglimpse(cc)\r\n\r\n\r\nRows: 1,490\r\nColumns: 4\r\n$ timestamp  <dttm> 2014-01-06 07:28:00, 2014-01-06 07:34:00, 2014-0~\r\n$ location   <chr> \"Brew've Been Served\", \"Hallowed Grounds\", \"Brew'~\r\n$ price      <dbl> 11.34, 52.22, 8.33, 16.72, 4.24, 4.17, 28.73, 9.6~\r\n$ last4ccnum <fct> 4795, 7108, 6816, 9617, 7384, 5368, 7253, 4948, 9~\r\n\r\nglimpse(loyalty)\r\n\r\n\r\nRows: 1,392\r\nColumns: 4\r\n$ timestamp  <date> 2014-01-06, 2014-01-06, 2014-01-06, 2014-01-06, ~\r\n$ location   <chr> \"Brew've Been Served\", \"Brew've Been Served\", \"Ha~\r\n$ price      <dbl> 4.17, 9.60, 16.53, 11.51, 12.93, 4.27, 11.20, 15.~\r\n$ loyaltynum <fct> L2247, L9406, L8328, L6417, L1107, L4034, L6110, ~\r\n\r\n2.6.1.2 Splitting the timestamp data into individual date, time and day columns.\r\nTo allow us to dive deeper into our analysis later, we will split the timestamp dataset into date, time and day columns. We will first add more columns by using the mutate function from dplyr to add day, date and time columns in the cc dataset and importing in to the cc_dtsplit object.\r\nThere is no need to add columns for the loyatly dataset as we will join both the datasets together in which day will be included in the joined dataset.\r\n\r\n\r\ncc_dtsplit <- cc %>%\r\n  mutate(day = date_weekday_factor(cc$timestamp), date =  as_date(cc$timestamp), time = format(cc$timestamp, format = \"%H:%M\"))\r\n\r\ncc_dtsplit\r\n\r\n\r\n# A tibble: 1,490 x 7\r\n   timestamp           location      price last4ccnum day   date      \r\n   <dttm>              <chr>         <dbl> <fct>      <ord> <date>    \r\n 1 2014-01-06 07:28:00 Brew've Been~ 11.3  4795       Mon   2014-01-06\r\n 2 2014-01-06 07:34:00 Hallowed Gro~ 52.2  7108       Mon   2014-01-06\r\n 3 2014-01-06 07:35:00 Brew've Been~  8.33 6816       Mon   2014-01-06\r\n 4 2014-01-06 07:36:00 Hallowed Gro~ 16.7  9617       Mon   2014-01-06\r\n 5 2014-01-06 07:37:00 Brew've Been~  4.24 7384       Mon   2014-01-06\r\n 6 2014-01-06 07:38:00 Brew've Been~  4.17 5368       Mon   2014-01-06\r\n 7 2014-01-06 07:42:00 Coffee Camel~ 28.7  7253       Mon   2014-01-06\r\n 8 2014-01-06 07:43:00 Brew've Been~  9.6  4948       Mon   2014-01-06\r\n 9 2014-01-06 07:43:00 Brew've Been~ 16.9  9683       Mon   2014-01-06\r\n10 2014-01-06 07:47:00 Hallowed Gro~ 16.5  8129       Mon   2014-01-06\r\n# ... with 1,480 more rows, and 1 more variable: time <chr>\r\n\r\nTo allow us to join both datasets together, we will need to rename the timestamp column from the loyatly dataset to date so that both the date columns have the same name.\r\n\r\n\r\nloyalty_dt <- rename(loyalty, date = timestamp)\r\n\r\n\r\n\r\nWe will take a look at our newly cleaned datasets to double check the changed we have made previously.\r\n\r\n\r\nglimpse(cc_dtsplit)\r\n\r\n\r\nRows: 1,490\r\nColumns: 7\r\n$ timestamp  <dttm> 2014-01-06 07:28:00, 2014-01-06 07:34:00, 2014-0~\r\n$ location   <chr> \"Brew've Been Served\", \"Hallowed Grounds\", \"Brew'~\r\n$ price      <dbl> 11.34, 52.22, 8.33, 16.72, 4.24, 4.17, 28.73, 9.6~\r\n$ last4ccnum <fct> 4795, 7108, 6816, 9617, 7384, 5368, 7253, 4948, 9~\r\n$ day        <ord> Mon, Mon, Mon, Mon, Mon, Mon, Mon, Mon, Mon, Mon,~\r\n$ date       <date> 2014-01-06, 2014-01-06, 2014-01-06, 2014-01-06, ~\r\n$ time       <chr> \"07:28\", \"07:34\", \"07:35\", \"07:36\", \"07:37\", \"07:~\r\n\r\nglimpse(loyalty_dt)\r\n\r\n\r\nRows: 1,392\r\nColumns: 4\r\n$ date       <date> 2014-01-06, 2014-01-06, 2014-01-06, 2014-01-06, ~\r\n$ location   <chr> \"Brew've Been Served\", \"Brew've Been Served\", \"Ha~\r\n$ price      <dbl> 4.17, 9.60, 16.53, 11.51, 12.93, 4.27, 11.20, 15.~\r\n$ loyaltynum <fct> L2247, L9406, L8328, L6417, L1107, L4034, L6110, ~\r\n\r\n2.6.1.3. Changing the datatypes of car & gps\r\nFirst, we will take a look at the car & gps datasets. Notice that the CarID and id for both datasets are not of the correct categorical datatype. We will proceed to change both the two columns.\r\n\r\n\r\nglimpse(car)\r\n\r\n\r\nRows: 44\r\nColumns: 5\r\n$ LastName               <chr> \"Calixto\", \"Azada\", \"Balas\", \"Barranc~\r\n$ FirstName              <chr> \"Nils\", \"Lars\", \"Felix\", \"Ingrid\", \"I~\r\n$ CarID                  <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12~\r\n$ CurrentEmploymentType  <chr> \"Information Technology\", \"Engineerin~\r\n$ CurrentEmploymentTitle <chr> \"IT Helpdesk\", \"Engineer\", \"Engineer\"~\r\n\r\nglimpse(gps)\r\n\r\n\r\nRows: 685,169\r\nColumns: 4\r\n$ Timestamp <chr> \"1/6/2014 6:28\", \"1/6/2014 6:28\", \"1/6/2014 6:28\",~\r\n$ id        <dbl> 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35~\r\n$ lat       <dbl> 36.07623, 36.07622, 36.07621, 36.07622, 36.07621, ~\r\n$ long      <dbl> 24.87469, 24.87460, 24.87444, 24.87425, 24.87417, ~\r\n\r\nChanging of CarID and ID to categorical data.\r\n\r\n\r\ncar$CarID = as.factor(car$CarID)\r\ngps$id = as.factor(gps$id)\r\n\r\n\r\n\r\n2.6.1.4. Combining both first and last name.\r\nNext, we will combine both first and last name of the car datasets into one column for us to analyse the person easily. We will use the tidyr function unite to unify both the first and last name into name.\r\n\r\n\r\ncar_unite <- car %>%\r\n  unite(col = \"name\", LastName,FirstName, sep = \", \",  remove =FALSE) \r\n\r\n\r\n\r\n2.6.1.5. Change datatype of time and rename id to Carid\r\nNext, we will rename the id of gps to CarID to match with the car_unite data. Additionally, the Timestamp data of gps will be changed to the dttm format\r\n\r\n\r\ngps_cleaned <- rename(gps,CarID = id)\r\n\r\ngps_cleaned$Timestamp <- date_time_parse(gps_cleaned$Timestamp,\r\n                                 zone = \"\",\r\n                                 format = \"%m/%d/%Y %H:%M\")\r\n\r\n\r\n\r\nLastly, we will look at our cleaned dataset and we have done cleaning the data.\r\n\r\n\r\nglimpse(car_unite)\r\n\r\n\r\nRows: 44\r\nColumns: 6\r\n$ name                   <chr> \"Calixto, Nils\", \"Azada, Lars\", \"Bala~\r\n$ LastName               <chr> \"Calixto\", \"Azada\", \"Balas\", \"Barranc~\r\n$ FirstName              <chr> \"Nils\", \"Lars\", \"Felix\", \"Ingrid\", \"I~\r\n$ CarID                  <fct> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12~\r\n$ CurrentEmploymentType  <chr> \"Information Technology\", \"Engineerin~\r\n$ CurrentEmploymentTitle <chr> \"IT Helpdesk\", \"Engineer\", \"Engineer\"~\r\n\r\nglimpse(gps_cleaned)\r\n\r\n\r\nRows: 685,169\r\nColumns: 4\r\n$ Timestamp <dttm> 2014-01-06 06:28:00, 2014-01-06 06:28:00, 2014-01~\r\n$ CarID     <fct> 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35~\r\n$ lat       <dbl> 36.07623, 36.07622, 36.07621, 36.07622, 36.07621, ~\r\n$ long      <dbl> 24.87469, 24.87460, 24.87444, 24.87425, 24.87417, ~\r\n\r\n3. Methodology and Visualisation methods\r\nBelow we will discuss some methodology and visualization methods used to answer the questions later.\r\n3.1. Bar Chart\r\nFirst, we will be using a bar chart to analyse the number of patrons to each location. A bar chart is very useful to analyse categorical data based on number of instances.\r\nThe code uses both tidyverse and plotly packages to create the bar chart. First, a count was used to count each location by visits. Then a mutate function was used to create and sort the location by count in descending order. Next, a plotly bar chart was created by indicating the x and y axis with additional layout for the chart.\r\nThe plotly bar chart is accessible later in the question segment. \r\n3.2. Line chart\r\nTo visualize timeseries data, a time-series line chart is great for analysis.\r\nThe below line chart uses the top few most visited places to plot into a timeseries line. \r\n3.3. Geospatial visualization\r\nNext, a geospatial map visualisation is created to analyse the movement of each vehicle.\r\n\r\n3.4. Network analysis\r\nAn interactive network data analysis is created to visualise the realtionship between each person.\r\nNotice that the carid can be selected to see its relationship between other carid. Those that are nearest and highlighted are carid that have a close relationship with the person of interest.\r\n\r\n\r\n\r\n\r\n",
    "preview": {},
    "last_modified": "2021-07-27T13:00:20+08:00",
    "input_file": "vastchallengepart1.knit.md"
  },
  {
    "path": "posts/2021-07-27-vastchallengepart2/",
    "title": "Vast Challenge Part 2",
    "description": "Welcome to Ong Chee Hong's Vast Challenge 2021 Assignment",
    "author": [
      {
        "name": "Ong Chee Hong",
        "url": "https://www.linkedin.com/in/alexongch/"
      }
    ],
    "date": "2021-07-27",
    "categories": [],
    "contents": "\r\n\r\n\r\npackages = c('DT','ggiraph','plotly','tidyverse', 'raster','sf','clock','tmap',\r\n             'rgdal','dplyr', 'tidyr', 'textclean', \"plotly\", \"forcats\", \"jpeg\", \"tiff\",\r\n             \"mapview\",\"tidygraph\",\"igraph\",\"ggraph\",\"visNetwork\",\"leaflet\",\"lubridate\")\r\nfor(p in packages){\r\n  if(!require(p,character.only = T)){\r\n    install.packages(p)\r\n  }\r\n  library(p,character.only = T)\r\n}\r\n\r\n\r\n\r\n\r\n\r\ncar <- read_csv(\"data/mc2/car-assignments.csv\")\r\ncc <- read_csv(\"data/mc2/cc_data.csv\", locale = locale(encoding = \"ASCII\"))\r\ngps <- read_csv(\"data/mc2/gps.csv\")\r\nloyalty <- read_csv(\"data/mc2/loyalty_data.csv\",locale = locale(encoding = \"ASCII\"))\r\n\r\n\r\n\r\n2. Data preparation\r\n2.1 Customisation of code chunks\r\nFirst, we will customize the all code chunks using the below knitr code. More information on chunk options can be found here\r\n2.2 Installing required R packages\r\nNext, we will install the required R packages. There are three basic groups of packages that we will install,\r\nFor data manipulation and preparation The tidyverse package is a group of R packages including dplyr, tidyr that assist user to manipulate data.\r\nDate and Time The two packages clock and lubridate are used for the manipulation of date and time data\r\nInteractive data analysis The two packages ggiraph and plotly are used to output data into interactive graphical/chart form for analysis.\r\nGeoVisual Analysis The packages raster, sf,tmap and rgdal are used for geospatial visual analytics where data are output to a map for analysis such as movement of people etc.\r\nNetwork Analysis Lastly, to analyse the relationship between people etc. We will use the packages from tidygraph, igraph, ggraph and visNetwork. visNetwork is a package to output interactive network analysis.\r\n\r\n\r\npackages = c('DT','ggiraph','plotly','tidyverse', 'raster','sf','clock','tmap',\r\n             'rgdal','dplyr', 'tidyr', 'textclean', \"plotly\", \"forcats\", \"jpeg\", \"tiff\",\r\n             \"mapview\",\"tidygraph\",\"igraph\",\"ggraph\",\"visNetwork\",\"leaflet\",\"lubridate\")\r\nfor(p in packages){\r\n  if(!require(p,character.only = T)){\r\n    install.packages(p)\r\n  }\r\n  library(p,character.only = T)\r\n}\r\n\r\n\r\n\r\n2.3 Provided data and information\r\nThere are 3 different types of data & information provided. A geospatial dataset, csv files and a jpg file consisting of the Abila tourist map.\r\nBelow is the information of all the data provided.\r\n2.3.1. A csv file on vehicle assignments to employee (car-assignments.csv)\r\nEmployee Last Name\r\nEmployee First Name\r\nCar ID (integer)\r\nCurrent Employment Type (Department; categorical)\r\nCurrent Employment Title (job title; categorical)\r\n2.3.2. A CSV file of vehicle tracking data (gps.csv)\r\n3.1 Timestamp\r\n3.2 Car ID (integer)\r\n3.3 Latitude\r\n3.4 Longitude\r\n2.3.3. A CSV file containing loyalty card transaction data (loyalty_data.csv)\r\n4.1 Timestamp\r\n4.2 Location (name of the business)\r\n4.3 Price (real)\r\n4.4 Loyalty Number (A 5-character code starting with L that is unique for each card)\r\n2.3.4. A CSV file containing credit and debit card transaction data (cc_data.csv)\r\n5.1 Timestamp\r\n5.2 Location (name of the business)\r\n5.3 Price (real)\r\n5.4 Last 4 digits of the credit or debit card number\r\n2.3.5. ESRI shapefiles of Abila (in the Geospatial folder)\r\n2.3.6. A tourist map of Abila with locations of interest identified, in JPEG format (MC2-Tourist.jpg)\r\n2.4. Importing of data\r\nWe will import the 4 different csv datasets that were provided\r\n\r\n\r\ncar <- read_csv(\"data/mc2/car-assignments.csv\")\r\ncc <- read_csv(\"data/mc2/cc_data.csv\")\r\ngps <- read_csv(\"data/mc2/gps.csv\")\r\nloyalty <- read_csv(\"data/mc2/loyalty_data.csv\")\r\n\r\n\r\n\r\nIf we take a look at the above datasets in excel, we will see that there are foreign characters in some of the datasets provided. An example is the Katerina’s Cafe as shown below. To address this, we will need to encode the dataset to allow rstudio to read properly.\r\n\r\nTo allow use to know the encoding type for both cc and loyalty dataset. Guess encoding will be used to detect the encoding type as shown below..\r\n\r\n\r\nguess_encoding(cc)\r\n\r\n\r\n# A tibble: 1 x 2\r\n  encoding confidence\r\n  <chr>         <dbl>\r\n1 ASCII             1\r\n\r\nguess_encoding(loyalty)\r\n\r\n\r\n# A tibble: 1 x 2\r\n  encoding confidence\r\n  <chr>         <dbl>\r\n1 ASCII             1\r\n\r\nNext, we will add the code locale = locale(encoding = “ASCII” on both cc and loyalty dataset)\r\n\r\n\r\ncar <- read_csv(\"data/mc2/car-assignments.csv\")\r\ncc <- read_csv(\"data/mc2/cc_data.csv\", locale = locale(encoding = \"ASCII\"))\r\ngps <- read_csv(\"data/mc2/gps.csv\")\r\nloyalty <- read_csv(\"data/mc2/loyalty_data.csv\",locale = locale(encoding = \"ASCII\"))\r\n\r\n\r\n\r\n2.5. Data examination\r\nFirst, we will look at both cc and loyalty card dataset by using the glimpse function as shown below. There are 1490 rows and 1392 rows in both the cc and loyatly dataset respectfully. If we take look closely, we will see that these two datasets are closely linked by location, price and timestamp except the last4ccnum and loyaltynum are different.\r\nIf we take a look back at the MC2 background, we will observe that Kronos based companies are allowed to collect credit card and loyalty cards information on GAStech employees purchases as such these two datasets are similar in nature.\r\nHowever, the rows for both cc and loyalty card data are different. This anomaly might have a few reasoning, 1) the employees did not used their credit cards while doing purchases but loyalty card was presented. 2) Vice versa, employees might also used their credit card but did not present their loyalty card during purchases.\r\n\r\n\r\nglimpse(cc)\r\n\r\n\r\nRows: 1,490\r\nColumns: 4\r\n$ timestamp  <chr> \"1/6/2014 7:28\", \"1/6/2014 7:34\", \"1/6/2014 7:35\"~\r\n$ location   <chr> \"Brew've Been Served\", \"Hallowed Grounds\", \"Brew'~\r\n$ price      <dbl> 11.34, 52.22, 8.33, 16.72, 4.24, 4.17, 28.73, 9.6~\r\n$ last4ccnum <dbl> 4795, 7108, 6816, 9617, 7384, 5368, 7253, 4948, 9~\r\n\r\nglimpse(loyalty)\r\n\r\n\r\nRows: 1,392\r\nColumns: 4\r\n$ timestamp  <chr> \"1/6/2014\", \"1/6/2014\", \"1/6/2014\", \"1/6/2014\", \"~\r\n$ location   <chr> \"Brew've Been Served\", \"Brew've Been Served\", \"Ha~\r\n$ price      <dbl> 4.17, 9.60, 16.53, 11.51, 12.93, 4.27, 11.20, 15.~\r\n$ loyaltynum <chr> \"L2247\", \"L9406\", \"L8328\", \"L6417\", \"L1107\", \"L40~\r\n\r\nNext, we will look at the vehicle datasets. The 44 rows car datasets are represented by the employee, employment information with their car assignment ID.\r\nThe gps datasets are based on the car movements in respect to their lat and long position with timestamp.\r\n\r\n\r\nglimpse(car)\r\n\r\n\r\nRows: 44\r\nColumns: 5\r\n$ LastName               <chr> \"Calixto\", \"Azada\", \"Balas\", \"Barranc~\r\n$ FirstName              <chr> \"Nils\", \"Lars\", \"Felix\", \"Ingrid\", \"I~\r\n$ CarID                  <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12~\r\n$ CurrentEmploymentType  <chr> \"Information Technology\", \"Engineerin~\r\n$ CurrentEmploymentTitle <chr> \"IT Helpdesk\", \"Engineer\", \"Engineer\"~\r\n\r\nglimpse(gps)\r\n\r\n\r\nRows: 685,169\r\nColumns: 4\r\n$ Timestamp <chr> \"1/6/2014 6:28\", \"1/6/2014 6:28\", \"1/6/2014 6:28\",~\r\n$ id        <dbl> 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35~\r\n$ lat       <dbl> 36.07623, 36.07622, 36.07621, 36.07622, 36.07621, ~\r\n$ long      <dbl> 24.87469, 24.87460, 24.87444, 24.87425, 24.87417, ~\r\n\r\n2.6. Data Preparation\r\n2.6.1 CC and Loyalty dataset\r\nWe will prepare the cc and loyalty datasets for data exploration later.\r\n2.6.1.1. Changing the datatypes of last4ccnum & loyaltynum\r\nThe last4ccnum of the cc datasets and the loyaltynum of the loyalty dataset should be a categorical data type. As such, we will change it by using the as.factor function.\r\n\r\n\r\ncc$last4ccnum <- as.factor(cc$last4ccnum)\r\nloyalty$loyaltynum <- as.factor(loyalty$loyaltynum)\r\n\r\n\r\n\r\nNext, we will modify the datatype for both the timestamp of cc and loyalty dataset using the clock package. If we observe below, the data_time_parse function is use to change the timestamp to dttm (datetime) format while the date_parse function is used to change the data to date format.\r\n\r\n\r\ncc$timestamp <- date_time_parse(cc$timestamp,\r\n                                 zone = \"\",\r\n                                 format = \"%m/%d/%Y %H:%M\")\r\n\r\nloyalty$timestamp <- date_parse(loyalty$timestamp,\r\n                                 format = \"%m/%d/%Y\")\r\n\r\n\r\n\r\nWe will double check the dataset to confirm that the datatype has been changed to the one we wanted.\r\n\r\n\r\nglimpse(cc)\r\n\r\n\r\nRows: 1,490\r\nColumns: 4\r\n$ timestamp  <dttm> 2014-01-06 07:28:00, 2014-01-06 07:34:00, 2014-0~\r\n$ location   <chr> \"Brew've Been Served\", \"Hallowed Grounds\", \"Brew'~\r\n$ price      <dbl> 11.34, 52.22, 8.33, 16.72, 4.24, 4.17, 28.73, 9.6~\r\n$ last4ccnum <fct> 4795, 7108, 6816, 9617, 7384, 5368, 7253, 4948, 9~\r\n\r\nglimpse(loyalty)\r\n\r\n\r\nRows: 1,392\r\nColumns: 4\r\n$ timestamp  <date> 2014-01-06, 2014-01-06, 2014-01-06, 2014-01-06, ~\r\n$ location   <chr> \"Brew've Been Served\", \"Brew've Been Served\", \"Ha~\r\n$ price      <dbl> 4.17, 9.60, 16.53, 11.51, 12.93, 4.27, 11.20, 15.~\r\n$ loyaltynum <fct> L2247, L9406, L8328, L6417, L1107, L4034, L6110, ~\r\n\r\n2.6.1.2 Splitting the timestamp data into individual date, time and day columns.\r\nTo allow us to dive deeper into our analysis later, we will split the timestamp dataset into date, time and day columns. We will first add more columns by using the mutate function from dplyr to add day, date and time columns in the cc dataset and importing in to the cc_dtsplit object.\r\nThere is no need to add columns for the loyatly dataset as we will join both the datasets together in which day will be included in the joined dataset.\r\n\r\n\r\ncc_dtsplit <- cc %>%\r\n  mutate(day = date_weekday_factor(cc$timestamp), date =  as_date(cc$timestamp), time = format(cc$timestamp, format = \"%H:%M\"))\r\n\r\ncc_dtsplit\r\n\r\n\r\n# A tibble: 1,490 x 7\r\n   timestamp           location      price last4ccnum day   date      \r\n   <dttm>              <chr>         <dbl> <fct>      <ord> <date>    \r\n 1 2014-01-06 07:28:00 Brew've Been~ 11.3  4795       Mon   2014-01-06\r\n 2 2014-01-06 07:34:00 Hallowed Gro~ 52.2  7108       Mon   2014-01-06\r\n 3 2014-01-06 07:35:00 Brew've Been~  8.33 6816       Mon   2014-01-06\r\n 4 2014-01-06 07:36:00 Hallowed Gro~ 16.7  9617       Mon   2014-01-06\r\n 5 2014-01-06 07:37:00 Brew've Been~  4.24 7384       Mon   2014-01-06\r\n 6 2014-01-06 07:38:00 Brew've Been~  4.17 5368       Mon   2014-01-06\r\n 7 2014-01-06 07:42:00 Coffee Camel~ 28.7  7253       Mon   2014-01-06\r\n 8 2014-01-06 07:43:00 Brew've Been~  9.6  4948       Mon   2014-01-06\r\n 9 2014-01-06 07:43:00 Brew've Been~ 16.9  9683       Mon   2014-01-06\r\n10 2014-01-06 07:47:00 Hallowed Gro~ 16.5  8129       Mon   2014-01-06\r\n# ... with 1,480 more rows, and 1 more variable: time <chr>\r\n\r\nTo allow us to join both datasets together, we will need to rename the timestamp column from the loyatly dataset to date so that both the date columns have the same name.\r\n\r\n\r\nloyalty_dt <- rename(loyalty, date = timestamp)\r\n\r\n\r\n\r\nWe will take a look at our newly cleaned datasets to double check the changed we have made previously.\r\n\r\n\r\nglimpse(cc_dtsplit)\r\n\r\n\r\nRows: 1,490\r\nColumns: 7\r\n$ timestamp  <dttm> 2014-01-06 07:28:00, 2014-01-06 07:34:00, 2014-0~\r\n$ location   <chr> \"Brew've Been Served\", \"Hallowed Grounds\", \"Brew'~\r\n$ price      <dbl> 11.34, 52.22, 8.33, 16.72, 4.24, 4.17, 28.73, 9.6~\r\n$ last4ccnum <fct> 4795, 7108, 6816, 9617, 7384, 5368, 7253, 4948, 9~\r\n$ day        <ord> Mon, Mon, Mon, Mon, Mon, Mon, Mon, Mon, Mon, Mon,~\r\n$ date       <date> 2014-01-06, 2014-01-06, 2014-01-06, 2014-01-06, ~\r\n$ time       <chr> \"07:28\", \"07:34\", \"07:35\", \"07:36\", \"07:37\", \"07:~\r\n\r\nglimpse(loyalty_dt)\r\n\r\n\r\nRows: 1,392\r\nColumns: 4\r\n$ date       <date> 2014-01-06, 2014-01-06, 2014-01-06, 2014-01-06, ~\r\n$ location   <chr> \"Brew've Been Served\", \"Brew've Been Served\", \"Ha~\r\n$ price      <dbl> 4.17, 9.60, 16.53, 11.51, 12.93, 4.27, 11.20, 15.~\r\n$ loyaltynum <fct> L2247, L9406, L8328, L6417, L1107, L4034, L6110, ~\r\n\r\n2.6.1.3. Changing the datatypes of car & gps\r\nFirst, we will take a look at the car & gps datasets. Notice that the CarID and id for both datasets are not of the correct categorical datatype. We will proceed to change both the two columns.\r\n\r\n\r\nglimpse(car)\r\n\r\n\r\nRows: 44\r\nColumns: 5\r\n$ LastName               <chr> \"Calixto\", \"Azada\", \"Balas\", \"Barranc~\r\n$ FirstName              <chr> \"Nils\", \"Lars\", \"Felix\", \"Ingrid\", \"I~\r\n$ CarID                  <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12~\r\n$ CurrentEmploymentType  <chr> \"Information Technology\", \"Engineerin~\r\n$ CurrentEmploymentTitle <chr> \"IT Helpdesk\", \"Engineer\", \"Engineer\"~\r\n\r\nglimpse(gps)\r\n\r\n\r\nRows: 685,169\r\nColumns: 4\r\n$ Timestamp <chr> \"1/6/2014 6:28\", \"1/6/2014 6:28\", \"1/6/2014 6:28\",~\r\n$ id        <dbl> 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35~\r\n$ lat       <dbl> 36.07623, 36.07622, 36.07621, 36.07622, 36.07621, ~\r\n$ long      <dbl> 24.87469, 24.87460, 24.87444, 24.87425, 24.87417, ~\r\n\r\nChanging of CarID and ID to categorical data.\r\n\r\n\r\ncar$CarID = as.factor(car$CarID)\r\ngps$id = as.factor(gps$id)\r\n\r\n\r\n\r\n2.6.1.4. Combining both first and last name.\r\nNext, we will combine both first and last name of the car datasets into one column for us to analyse the person easily. We will use the tidyr function unite to unify both the first and last name into name.\r\n\r\n\r\ncar_unite <- car %>%\r\n  unite(col = \"name\", LastName,FirstName, sep = \", \",  remove =FALSE) \r\n\r\n\r\n\r\n2.6.1.5. Change datatype of time and rename id to Carid\r\nNext, we will rename the id of gps to CarID to match with the car_unite data. Additionally, the Timestamp data of gps will be changed to the dttm format\r\n\r\n\r\ngps_cleaned <- rename(gps,CarID = id)\r\n\r\ngps_cleaned$Timestamp <- date_time_parse(gps_cleaned$Timestamp,\r\n                                 zone = \"\",\r\n                                 format = \"%m/%d/%Y %H:%M\")\r\n\r\n\r\n\r\nLastly, we will look at our cleaned dataset and we have done cleaning the data.\r\n\r\n\r\nglimpse(car_unite)\r\n\r\n\r\nRows: 44\r\nColumns: 6\r\n$ name                   <chr> \"Calixto, Nils\", \"Azada, Lars\", \"Bala~\r\n$ LastName               <chr> \"Calixto\", \"Azada\", \"Balas\", \"Barranc~\r\n$ FirstName              <chr> \"Nils\", \"Lars\", \"Felix\", \"Ingrid\", \"I~\r\n$ CarID                  <fct> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12~\r\n$ CurrentEmploymentType  <chr> \"Information Technology\", \"Engineerin~\r\n$ CurrentEmploymentTitle <chr> \"IT Helpdesk\", \"Engineer\", \"Engineer\"~\r\n\r\nglimpse(gps_cleaned)\r\n\r\n\r\nRows: 685,169\r\nColumns: 4\r\n$ Timestamp <dttm> 2014-01-06 06:28:00, 2014-01-06 06:28:00, 2014-01~\r\n$ CarID     <fct> 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35~\r\n$ lat       <dbl> 36.07623, 36.07622, 36.07621, 36.07622, 36.07621, ~\r\n$ long      <dbl> 24.87469, 24.87460, 24.87444, 24.87425, 24.87417, ~\r\n\r\n4. Answers\r\n4.1. Using just the credit and loyalty card data, identify the most popular locations, and when they are popular. What anomalies do you see? What corrections would you recommend to correct these anomalies? Please limit your answer to 8 images and 300 words.\r\nAs shown previosuly in our data preparation segment, there is a difference in rows (difference of 98 rows) between the cc and loyalty card data. This shows an anomaly that one of the cards were used but not both during purchases which might results in a difference in number of entries.\r\n\r\n\r\nglimpse(cc_dtsplit)\r\n\r\n\r\nRows: 1,490\r\nColumns: 7\r\n$ timestamp  <dttm> 2014-01-06 07:28:00, 2014-01-06 07:34:00, 2014-0~\r\n$ location   <chr> \"Brew've Been Served\", \"Hallowed Grounds\", \"Brew'~\r\n$ price      <dbl> 11.34, 52.22, 8.33, 16.72, 4.24, 4.17, 28.73, 9.6~\r\n$ last4ccnum <fct> 4795, 7108, 6816, 9617, 7384, 5368, 7253, 4948, 9~\r\n$ day        <ord> Mon, Mon, Mon, Mon, Mon, Mon, Mon, Mon, Mon, Mon,~\r\n$ date       <date> 2014-01-06, 2014-01-06, 2014-01-06, 2014-01-06, ~\r\n$ time       <chr> \"07:28\", \"07:34\", \"07:35\", \"07:36\", \"07:37\", \"07:~\r\n\r\nglimpse(loyalty_dt)\r\n\r\n\r\nRows: 1,392\r\nColumns: 4\r\n$ date       <date> 2014-01-06, 2014-01-06, 2014-01-06, 2014-01-06, ~\r\n$ location   <chr> \"Brew've Been Served\", \"Brew've Been Served\", \"Ha~\r\n$ price      <dbl> 4.17, 9.60, 16.53, 11.51, 12.93, 4.27, 11.20, 15.~\r\n$ loyaltynum <fct> L2247, L9406, L8328, L6417, L1107, L4034, L6110, ~\r\n\r\nAs explained previously, the cc and loyalty dataset are similar in nature with just an exception of the last4ccnum and loyaltynum, therefore, a join is required to match rows where the users uses both cc and loyalty card data. However, before a join is performed, we will analyse both the cc and loyalty dataset based on location counts.\r\nA first exploratory data analysis by using a bar chart is performed on the cc_dtsplit dataset to find out the location which were patronize the most.\r\nBased on the bar chart below, we are able to observe that there are 4 locations that are siginificantly higher in visitors than the rest of the locations. The highest is Katerina’s cafe with a total of 212 visits followed by Hippokampos, Guys’Gyros and Brew’s been served. These four places excluding Hippokampos which is not determinable in the map provided are all restaurants/bars.\r\n\r\n\r\ncc_dtsplit_bar <- cc_dtsplit %>%\r\n  count(location) %>%\r\n  mutate(location = fct_reorder(location, n, .desc =TRUE)) %>%\r\n  plot_ly(x = ~location, y = ~n, marker = list(color = ~n)) %>%\r\n  add_bars() %>%\r\n  layout(title = \"Total number of visitation by location\", xaxis = list(title = \"\"),yaxis = list(title = \"Number of visitors\"))\r\n\r\ncc_dtsplit_bar\r\n\r\n\r\n\r\n{\"x\":{\"visdat\":{\"4aec2554658\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"4aec2554658\",\"attrs\":{\"4aec2554658\":{\"x\":{},\"y\":{},\"marker\":{\"color\":{}},\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"bar\",\"inherit\":true}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":\"Total number of visitation by location\",\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"\",\"type\":\"category\",\"categoryorder\":\"array\",\"categoryarray\":[\"Katerina\\u0012s Cafi\",\"Hippokampos\",\"Guy's Gyros\",\"Brew've Been Served\",\"Hallowed Grounds\",\"Ouzeri Elian\",\"Abila Zacharo\",\"Gelatogalore\",\"Kalami Kafenion\",\"Bean There Done That\",\"Frydos Autosupply n' More\",\"Coffee Cameleon\",\"Jack's Magical Beans\",\"Brewed Awakenings\",\"Abila Airport\",\"Albert's Fine Clothing\",\"Nationwide Refinery\",\"Shoppers' Delight\",\"Carlyle Chemical Inc.\",\"Stewart and Sons Fabrication\",\"General Grocer\",\"Kronos Mart\",\"Chostus Hotel\",\"Coffee Shack\",\"Desafio Golf Course\",\"Roberts and Sons\",\"Ahaggo Museum\",\"Kronos Pipe and Irrigation\",\"Maximum Iron and Steel\",\"Abila Scrapyard\",\"Octavio's Office Supplies\",\"Frank's Fuel\",\"U-Pump\",\"Daily Dealz\"]},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Number of visitors\"},\"hovermode\":\"closest\",\"showlegend\":false},\"source\":\"A\",\"config\":{\"showSendToCloud\":false},\"data\":[{\"x\":[\"Abila Airport\",\"Abila Scrapyard\",\"Abila Zacharo\",\"Ahaggo Museum\",\"Albert's Fine Clothing\",\"Bean There Done That\",\"Brew've Been Served\",\"Brewed Awakenings\",\"Carlyle Chemical Inc.\",\"Chostus Hotel\",\"Coffee Cameleon\",\"Coffee Shack\",\"Daily Dealz\",\"Desafio Golf Course\",\"Frank's Fuel\",\"Frydos Autosupply n' More\",\"Gelatogalore\",\"General Grocer\",\"Guy's Gyros\",\"Hallowed Grounds\",\"Hippokampos\",\"Jack's Magical Beans\",\"Kalami Kafenion\",\"Katerina\\u0012s Cafi\",\"Kronos Mart\",\"Kronos Pipe and Irrigation\",\"Maximum Iron and Steel\",\"Nationwide Refinery\",\"Octavio's Office Supplies\",\"Ouzeri Elian\",\"Roberts and Sons\",\"Shoppers' Delight\",\"Stewart and Sons Fabrication\",\"U-Pump\"],\"y\":[25,4,72,6,25,47,156,30,19,9,38,8,1,8,2,47,64,10,158,92,171,37,64,212,10,6,6,24,4,87,8,20,18,2],\"marker\":{\"color\":[25,4,72,6,25,47,156,30,19,9,38,8,1,8,2,47,64,10,158,92,171,37,64,212,10,6,6,24,4,87,8,20,18,2],\"line\":{\"color\":\"rgba(31,119,180,1)\"}},\"type\":\"bar\",\"error_y\":{\"color\":\"rgba(31,119,180,1)\"},\"error_x\":{\"color\":\"rgba(31,119,180,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}\r\nNext, we will take a look at the loyalty_dt dataset.\r\nBased on the bar chart below, we are able to observe that the 4 locations that were visited mostly are the same four locations that was shown on the cc_dtsplit dataset.\r\nOne difference is that Ouzeri Elian jumps to the fifth spot which differs from the cc_dtsplit dataset where Ouzeri Elian is in the sixth spot.\r\n\r\n\r\nloyalty_dt_bar <- loyalty_dt %>%\r\n  count(location) %>%\r\n  mutate(location = fct_reorder(location, n, .desc =TRUE)) %>%\r\n  plot_ly(x = ~location, y = ~n, marker = list(color = ~n)) %>%\r\n  add_bars() %>%\r\n  layout(title = \"Total number of visitation by \", xaxis = list(title = \"\"),yaxis = list(title = \"Number of visitors\"))\r\n\r\nloyalty_dt_bar\r\n\r\n\r\n\r\n{\"x\":{\"visdat\":{\"4aec53116a08\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"4aec53116a08\",\"attrs\":{\"4aec53116a08\":{\"x\":{},\"y\":{},\"marker\":{\"color\":{}},\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"bar\",\"inherit\":true}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":\"Total number of visitation by \",\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"\",\"type\":\"category\",\"categoryorder\":\"array\",\"categoryarray\":[\"Katerina\\u0012s Cafi\",\"Hippokampos\",\"Guy's Gyros\",\"Brew've Been Served\",\"Ouzeri Elian\",\"Hallowed Grounds\",\"Abila Zacharo\",\"Kalami Kafenion\",\"Gelatogalore\",\"Bean There Done That\",\"Frydos Autosupply n' More\",\"Coffee Cameleon\",\"Jack's Magical Beans\",\"Brewed Awakenings\",\"Abila Airport\",\"Albert's Fine Clothing\",\"Nationwide Refinery\",\"Carlyle Chemical Inc.\",\"Shoppers' Delight\",\"Stewart and Sons Fabrication\",\"General Grocer\",\"Coffee Shack\",\"Chostus Hotel\",\"Desafio Golf Course\",\"Kronos Mart\",\"Ahaggo Museum\",\"Kronos Pipe and Irrigation\",\"Maximum Iron and Steel\",\"Roberts and Sons\",\"Abila Scrapyard\",\"Octavio's Office Supplies\",\"Frank's Fuel\",\"U-Pump\"]},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Number of visitors\"},\"hovermode\":\"closest\",\"showlegend\":false},\"source\":\"A\",\"config\":{\"showSendToCloud\":false},\"data\":[{\"x\":[\"Abila Airport\",\"Abila Scrapyard\",\"Abila Zacharo\",\"Ahaggo Museum\",\"Albert's Fine Clothing\",\"Bean There Done That\",\"Brew've Been Served\",\"Brewed Awakenings\",\"Carlyle Chemical Inc.\",\"Chostus Hotel\",\"Coffee Cameleon\",\"Coffee Shack\",\"Desafio Golf Course\",\"Frank's Fuel\",\"Frydos Autosupply n' More\",\"Gelatogalore\",\"General Grocer\",\"Guy's Gyros\",\"Hallowed Grounds\",\"Hippokampos\",\"Jack's Magical Beans\",\"Kalami Kafenion\",\"Katerina\\u0012s Cafi\",\"Kronos Mart\",\"Kronos Pipe and Irrigation\",\"Maximum Iron and Steel\",\"Nationwide Refinery\",\"Octavio's Office Supplies\",\"Ouzeri Elian\",\"Roberts and Sons\",\"Shoppers' Delight\",\"Stewart and Sons Fabrication\",\"U-Pump\"],\"y\":[26,4,71,6,25,45,140,29,19,8,37,9,8,2,42,60,12,146,80,155,35,66,195,8,6,6,23,3,84,6,18,17,1],\"marker\":{\"color\":[26,4,71,6,25,45,140,29,19,8,37,9,8,2,42,60,12,146,80,155,35,66,195,8,6,6,23,3,84,6,18,17,1],\"line\":{\"color\":\"rgba(31,119,180,1)\"}},\"type\":\"bar\",\"error_y\":{\"color\":\"rgba(31,119,180,1)\"},\"error_x\":{\"color\":\"rgba(31,119,180,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}\r\nNext, an inner join will be conducted by joining date, location and price and will will output into a new object cc_loyalty_join.\r\nNotice that there are only 1,087 rows wheareas both cc_dtsplit and loyalty_dt has 1490 and 1392 rows respectfully. These shows that some of the data in cc does not match the loyalty data which strengthens the initial anomaly that some of the employees uses one of each card but not both during purchases.\r\n\r\n\r\ncc_loyalty_join <- cc_dtsplit %>%\r\n  inner_join(loyalty_dt, by = c(\"date\",\"location\", \"price\"))\r\n\r\ncc_loyalty_join\r\n\r\n\r\n# A tibble: 1,087 x 8\r\n   timestamp           location      price last4ccnum day   date      \r\n   <dttm>              <chr>         <dbl> <fct>      <ord> <date>    \r\n 1 2014-01-06 07:28:00 Brew've Been~ 11.3  4795       Mon   2014-01-06\r\n 2 2014-01-06 07:35:00 Brew've Been~  8.33 6816       Mon   2014-01-06\r\n 3 2014-01-06 07:36:00 Hallowed Gro~ 16.7  9617       Mon   2014-01-06\r\n 4 2014-01-06 07:37:00 Brew've Been~  4.24 7384       Mon   2014-01-06\r\n 5 2014-01-06 07:38:00 Brew've Been~  4.17 5368       Mon   2014-01-06\r\n 6 2014-01-06 07:43:00 Brew've Been~  9.6  4948       Mon   2014-01-06\r\n 7 2014-01-06 07:43:00 Brew've Been~ 16.9  9683       Mon   2014-01-06\r\n 8 2014-01-06 07:47:00 Hallowed Gro~ 16.5  8129       Mon   2014-01-06\r\n 9 2014-01-06 07:48:00 Hallowed Gro~ 10.7  3492       Mon   2014-01-06\r\n10 2014-01-06 07:49:00 Coffee Camel~  8.39 5921       Mon   2014-01-06\r\n# ... with 1,077 more rows, and 2 more variables: time <chr>,\r\n#   loyaltynum <fct>\r\n\r\nAfter joining the dataset, we found that there are 1087 rows of data available. This means that some of the credit card purchases are not linked to any of the loyalty card, vice versa, some of the loyalty card are not linked to the credit card purchases. These strengthen the anomaly that we have highlighted before. We will take a look at those datasets that does not match later.\r\nBefore we begin further analysis on further anomalies between the two datasets. We shall conduct some exploratory data analysis. First, we will analyse the most popular place visited during the duration of study.\r\nTo do the above, we will group all the location by the number of visitations. Taking a look at the raw output, we can see that the 4 most visited place is the same four as mentioned previosuly.\r\n\r\n\r\ncc_location_count <- cc_loyalty_join %>%\r\n  group_by(location) %>%\r\n  summarize(count = n()) %>%\r\n  arrange(desc(count))\r\n\r\ncc_location_count\r\n\r\n\r\n# A tibble: 32 x 2\r\n   location               count\r\n   <chr>                  <int>\r\n 1 \"Katerina\\u0012s Cafi\"   155\r\n 2 \"Guy's Gyros\"            121\r\n 3 \"Hippokampos\"            117\r\n 4 \"Brew've Been Served\"    111\r\n 5 \"Ouzeri Elian\"            62\r\n 6 \"Hallowed Grounds\"        60\r\n 7 \"Kalami Kafenion\"         53\r\n 8 \"Abila Zacharo\"           52\r\n 9 \"Gelatogalore\"            48\r\n10 \"Bean There Done That\"    36\r\n# ... with 22 more rows\r\n\r\nNext, a bar chart is produced sorted descendingly by the number of visitations.\r\n\r\n\r\ncc_join <- cc_loyalty_join %>%\r\n  count(location) %>%\r\n  mutate(location = fct_reorder(location, n, .desc =TRUE)) %>%\r\n  plot_ly(x = ~location, y = ~n, marker = list(color = ~n)) %>%\r\n  add_bars(name = \"inner-join\") %>%\r\n  layout(title = \"Total number of visitation by area\", xaxis = list(title = \"\"),yaxis = list(title = \"Number of visitors\"))\r\n\r\ncc_join\r\n\r\n\r\n\r\n{\"x\":{\"visdat\":{\"4aec356e5715\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"4aec356e5715\",\"attrs\":{\"4aec356e5715\":{\"x\":{},\"y\":{},\"marker\":{\"color\":{}},\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"bar\",\"name\":\"inner-join\",\"inherit\":true}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":\"Total number of visitation by area\",\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"\",\"type\":\"category\",\"categoryorder\":\"array\",\"categoryarray\":[\"Katerina\\u0012s Cafi\",\"Guy's Gyros\",\"Hippokampos\",\"Brew've Been Served\",\"Ouzeri Elian\",\"Hallowed Grounds\",\"Kalami Kafenion\",\"Abila Zacharo\",\"Gelatogalore\",\"Bean There Done That\",\"Frydos Autosupply n' More\",\"Coffee Cameleon\",\"Jack's Magical Beans\",\"Albert's Fine Clothing\",\"Brewed Awakenings\",\"Abila Airport\",\"Nationwide Refinery\",\"Carlyle Chemical Inc.\",\"Shoppers' Delight\",\"Stewart and Sons Fabrication\",\"General Grocer\",\"Coffee Shack\",\"Desafio Golf Course\",\"Chostus Hotel\",\"Maximum Iron and Steel\",\"Ahaggo Museum\",\"Kronos Pipe and Irrigation\",\"Abila Scrapyard\",\"Roberts and Sons\",\"Octavio's Office Supplies\",\"Frank's Fuel\",\"U-Pump\"]},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Number of visitors\"},\"hovermode\":\"closest\",\"showlegend\":false},\"source\":\"A\",\"config\":{\"showSendToCloud\":false},\"data\":[{\"x\":[\"Abila Airport\",\"Abila Scrapyard\",\"Abila Zacharo\",\"Ahaggo Museum\",\"Albert's Fine Clothing\",\"Bean There Done That\",\"Brew've Been Served\",\"Brewed Awakenings\",\"Carlyle Chemical Inc.\",\"Chostus Hotel\",\"Coffee Cameleon\",\"Coffee Shack\",\"Desafio Golf Course\",\"Frank's Fuel\",\"Frydos Autosupply n' More\",\"Gelatogalore\",\"General Grocer\",\"Guy's Gyros\",\"Hallowed Grounds\",\"Hippokampos\",\"Jack's Magical Beans\",\"Kalami Kafenion\",\"Katerina\\u0012s Cafi\",\"Kronos Pipe and Irrigation\",\"Maximum Iron and Steel\",\"Nationwide Refinery\",\"Octavio's Office Supplies\",\"Ouzeri Elian\",\"Roberts and Sons\",\"Shoppers' Delight\",\"Stewart and Sons Fabrication\",\"U-Pump\"],\"y\":[20,4,52,5,24,36,111,21,16,6,28,7,7,2,34,48,8,121,60,117,25,53,155,5,6,19,3,62,4,15,12,1],\"marker\":{\"color\":[20,4,52,5,24,36,111,21,16,6,28,7,7,2,34,48,8,121,60,117,25,53,155,5,6,19,3,62,4,15,12,1],\"line\":{\"color\":\"rgba(31,119,180,1)\"}},\"type\":\"bar\",\"name\":\"inner-join\",\"error_y\":{\"color\":\"rgba(31,119,180,1)\"},\"error_x\":{\"color\":\"rgba(31,119,180,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}\r\nFrom the chart above, we can observe that “Katerine”s Cafe\" (155 counts), “Guy’s Gyros” (121 counts), “Hippokampos” (117 counts), “Brew’ve Been Serve” (111 counts) have the most visitation during the period of study. If we take a look closely, the 4th most visited place is actually around 2x the 5th most visited place. This shows that top 4 most visited places takes up most of places visited by patrons.\r\nAlthough we have shown the overall most visited places. However, the more interesting analysis lies in when are the places visited by patrons. As such, we will group the joined data by location, date, day and time to see at which point of time was the location the most.\r\n\r\n\r\ncc_loyalty_group <- cc_loyalty_join %>%\r\n  group_by(location,date,day,time) %>%\r\n  summarize(count = n()) %>%\r\n  arrange(desc(count)) %>%\r\n  ungroup()\r\n\r\ncc_loyalty_group\r\n\r\n\r\n# A tibble: 992 x 5\r\n   location             date       day   time  count\r\n   <chr>                <date>     <ord> <chr> <int>\r\n 1 Bean There Done That 2014-01-13 Mon   12:00     6\r\n 2 Bean There Done That 2014-01-06 Mon   12:00     5\r\n 3 Bean There Done That 2014-01-10 Fri   12:00     5\r\n 4 Bean There Done That 2014-01-17 Fri   12:00     5\r\n 5 Bean There Done That 2014-01-16 Thu   12:00     4\r\n 6 Guy's Gyros          2014-01-19 Sun   19:45     4\r\n 7 Jack's Magical Beans 2014-01-13 Mon   12:00     4\r\n 8 Jack's Magical Beans 2014-01-16 Thu   12:00     4\r\n 9 Bean There Done That 2014-01-14 Tue   12:00     3\r\n10 Bean There Done That 2014-01-15 Wed   12:00     3\r\n# ... with 982 more rows\r\n\r\nFrom the above table we can already observe that “Bean There Done That” was patronized the most at one point of time. Next, are “Guy’s Gyros” and “Jack’s Magical Beans”. Interestingly, “Bean There Done That” has the highest count of high visitation at one point of time.\r\nNext, we will plot a line chart of the restaurant based on count of 3 or more based on a time series line chart to see if there is a trend. The reason to plot 3 or more is to show those location that were highly visited at one point of time.\r\nWe will first filter the dataset.\r\n\r\n\r\ncc_loyalty_top <- cc_loyalty_group %>%\r\n  filter(count >= 3) %>%\r\n  ungroup()\r\n\r\n\r\n\r\nNext, we will create the line chart.\r\nBased on the most frequented places, we can see that January 13 clock the highest count for one day. Additonally, Bean there done that has clocked the highest visitations per day followed by Jack’s Magical Beans.\r\n\r\n\r\ncc_timeseries <- cc_loyalty_top %>%\r\n  plot_ly(x = ~date, y =~count, color = ~location, hoverinfo = \"text\",\r\n          text = ~paste(\"Location:\", location, \"<br>\",\"Date:\", date, \"<br>\",\"Time:\", time, \"<br>\", \"Day:\", day)) %>%\r\n  add_lines() %>%\r\n  add_markers(showlegend = FALSE) %>%\r\n  layout(title = \"Most frequented places by groups of people\", xaxis = list(title = \"\", dtick = ~date, showgrid = FALSE), yaxis = list(title = \"Number of people\"))\r\n\r\ncc_timeseries\r\n\r\n\r\n\r\n{\"x\":{\"visdat\":{\"4aec781267c\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"4aec781267c\",\"attrs\":{\"4aec781267c\":{\"x\":{},\"y\":{},\"hoverinfo\":\"text\",\"text\":{},\"color\":{},\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"scatter\",\"mode\":\"lines\",\"inherit\":true},\"4aec781267c.1\":{\"x\":{},\"y\":{},\"hoverinfo\":\"text\",\"text\":{},\"color\":{},\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"scatter\",\"mode\":\"markers\",\"showlegend\":false,\"inherit\":true}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":\"Most frequented places by groups of people\",\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"\",\"dtick\":[\"2014-01-13\",\"2014-01-06\",\"2014-01-10\",\"2014-01-17\",\"2014-01-16\",\"2014-01-19\",\"2014-01-13\",\"2014-01-16\",\"2014-01-14\",\"2014-01-15\",\"2014-01-08\",\"2014-01-14\",\"2014-01-14\",\"2014-01-15\",\"2014-01-06\",\"2014-01-10\",\"2014-01-14\",\"2014-01-10\",\"2014-01-16\",\"2014-01-06\",\"2014-01-08\",\"2014-01-10\"],\"showgrid\":false},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Number of people\"},\"hovermode\":\"closest\",\"showlegend\":true},\"source\":\"A\",\"config\":{\"showSendToCloud\":false},\"data\":[{\"x\":[\"2014-01-06\",\"2014-01-10\",\"2014-01-13\",\"2014-01-14\",\"2014-01-15\",\"2014-01-16\",\"2014-01-17\"],\"y\":[5,5,6,3,3,4,5],\"hoverinfo\":[\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\"],\"text\":[\"Location: Bean There Done That <br> Date: 2014-01-06 <br> Time: 12:00 <br> Day: Mon\",\"Location: Bean There Done That <br> Date: 2014-01-10 <br> Time: 12:00 <br> Day: Fri\",\"Location: Bean There Done That <br> Date: 2014-01-13 <br> Time: 12:00 <br> Day: Mon\",\"Location: Bean There Done That <br> Date: 2014-01-14 <br> Time: 12:00 <br> Day: Tue\",\"Location: Bean There Done That <br> Date: 2014-01-15 <br> Time: 12:00 <br> Day: Wed\",\"Location: Bean There Done That <br> Date: 2014-01-16 <br> Time: 12:00 <br> Day: Thu\",\"Location: Bean There Done That <br> Date: 2014-01-17 <br> Time: 12:00 <br> Day: Fri\"],\"type\":\"scatter\",\"mode\":\"lines\",\"name\":\"Bean There Done That\",\"marker\":{\"color\":\"rgba(102,194,165,1)\",\"line\":{\"color\":\"rgba(102,194,165,1)\"}},\"textfont\":{\"color\":\"rgba(102,194,165,1)\"},\"error_y\":{\"color\":\"rgba(102,194,165,1)\"},\"error_x\":{\"color\":\"rgba(102,194,165,1)\"},\"line\":{\"color\":\"rgba(102,194,165,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-08\",\"2014-01-14\",\"2014-01-14\",\"2014-01-15\"],\"y\":[3,3,3,3],\"hoverinfo\":[\"text\",\"text\",\"text\",\"text\"],\"text\":[\"Location: Brew've Been Served <br> Date: 2014-01-08 <br> Time: 08:01 <br> Day: Wed\",\"Location: Brew've Been Served <br> Date: 2014-01-14 <br> Time: 07:45 <br> Day: Tue\",\"Location: Brew've Been Served <br> Date: 2014-01-14 <br> Time: 07:53 <br> Day: Tue\",\"Location: Brew've Been Served <br> Date: 2014-01-15 <br> Time: 07:58 <br> Day: Wed\"],\"type\":\"scatter\",\"mode\":\"lines\",\"name\":\"Brew've Been Served\",\"marker\":{\"color\":\"rgba(252,141,98,1)\",\"line\":{\"color\":\"rgba(252,141,98,1)\"}},\"textfont\":{\"color\":\"rgba(252,141,98,1)\"},\"error_y\":{\"color\":\"rgba(252,141,98,1)\"},\"error_x\":{\"color\":\"rgba(252,141,98,1)\"},\"line\":{\"color\":\"rgba(252,141,98,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-06\",\"2014-01-10\",\"2014-01-14\"],\"y\":[3,3,3],\"hoverinfo\":[\"text\",\"text\",\"text\"],\"text\":[\"Location: Brewed Awakenings <br> Date: 2014-01-06 <br> Time: 12:00 <br> Day: Mon\",\"Location: Brewed Awakenings <br> Date: 2014-01-10 <br> Time: 12:00 <br> Day: Fri\",\"Location: Brewed Awakenings <br> Date: 2014-01-14 <br> Time: 12:00 <br> Day: Tue\"],\"type\":\"scatter\",\"mode\":\"lines\",\"name\":\"Brewed Awakenings\",\"marker\":{\"color\":\"rgba(141,160,203,1)\",\"line\":{\"color\":\"rgba(141,160,203,1)\"}},\"textfont\":{\"color\":\"rgba(141,160,203,1)\"},\"error_y\":{\"color\":\"rgba(141,160,203,1)\"},\"error_x\":{\"color\":\"rgba(141,160,203,1)\"},\"line\":{\"color\":\"rgba(141,160,203,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-19\"],\"y\":[4],\"hoverinfo\":\"text\",\"text\":\"Location: Guy's Gyros <br> Date: 2014-01-19 <br> Time: 19:45 <br> Day: Sun\",\"type\":\"scatter\",\"mode\":\"lines\",\"name\":\"Guy's Gyros\",\"marker\":{\"color\":\"rgba(231,138,195,1)\",\"line\":{\"color\":\"rgba(231,138,195,1)\"}},\"textfont\":{\"color\":\"rgba(231,138,195,1)\"},\"error_y\":{\"color\":\"rgba(231,138,195,1)\"},\"error_x\":{\"color\":\"rgba(231,138,195,1)\"},\"line\":{\"color\":\"rgba(231,138,195,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-10\",\"2014-01-16\"],\"y\":[3,3],\"hoverinfo\":[\"text\",\"text\"],\"text\":[\"Location: Hallowed Grounds <br> Date: 2014-01-10 <br> Time: 07:41 <br> Day: Fri\",\"Location: Hallowed Grounds <br> Date: 2014-01-16 <br> Time: 07:44 <br> Day: Thu\"],\"type\":\"scatter\",\"mode\":\"lines\",\"name\":\"Hallowed Grounds\",\"marker\":{\"color\":\"rgba(166,216,84,1)\",\"line\":{\"color\":\"rgba(166,216,84,1)\"}},\"textfont\":{\"color\":\"rgba(166,216,84,1)\"},\"error_y\":{\"color\":\"rgba(166,216,84,1)\"},\"error_x\":{\"color\":\"rgba(166,216,84,1)\"},\"line\":{\"color\":\"rgba(166,216,84,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-06\",\"2014-01-08\",\"2014-01-10\",\"2014-01-13\",\"2014-01-16\"],\"y\":[3,3,3,4,4],\"hoverinfo\":[\"text\",\"text\",\"text\",\"text\",\"text\"],\"text\":[\"Location: Jack's Magical Beans <br> Date: 2014-01-06 <br> Time: 12:00 <br> Day: Mon\",\"Location: Jack's Magical Beans <br> Date: 2014-01-08 <br> Time: 12:00 <br> Day: Wed\",\"Location: Jack's Magical Beans <br> Date: 2014-01-10 <br> Time: 12:00 <br> Day: Fri\",\"Location: Jack's Magical Beans <br> Date: 2014-01-13 <br> Time: 12:00 <br> Day: Mon\",\"Location: Jack's Magical Beans <br> Date: 2014-01-16 <br> Time: 12:00 <br> Day: Thu\"],\"type\":\"scatter\",\"mode\":\"lines\",\"name\":\"Jack's Magical Beans\",\"marker\":{\"color\":\"rgba(255,217,47,1)\",\"line\":{\"color\":\"rgba(255,217,47,1)\"}},\"textfont\":{\"color\":\"rgba(255,217,47,1)\"},\"error_y\":{\"color\":\"rgba(255,217,47,1)\"},\"error_x\":{\"color\":\"rgba(255,217,47,1)\"},\"line\":{\"color\":\"rgba(255,217,47,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-13\",\"2014-01-06\",\"2014-01-10\",\"2014-01-17\",\"2014-01-16\",\"2014-01-14\",\"2014-01-15\"],\"y\":[6,5,5,5,4,3,3],\"hoverinfo\":[\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\"],\"text\":[\"Location: Bean There Done That <br> Date: 2014-01-13 <br> Time: 12:00 <br> Day: Mon\",\"Location: Bean There Done That <br> Date: 2014-01-06 <br> Time: 12:00 <br> Day: Mon\",\"Location: Bean There Done That <br> Date: 2014-01-10 <br> Time: 12:00 <br> Day: Fri\",\"Location: Bean There Done That <br> Date: 2014-01-17 <br> Time: 12:00 <br> Day: Fri\",\"Location: Bean There Done That <br> Date: 2014-01-16 <br> Time: 12:00 <br> Day: Thu\",\"Location: Bean There Done That <br> Date: 2014-01-14 <br> Time: 12:00 <br> Day: Tue\",\"Location: Bean There Done That <br> Date: 2014-01-15 <br> Time: 12:00 <br> Day: Wed\"],\"type\":\"scatter\",\"mode\":\"markers\",\"showlegend\":false,\"name\":\"Bean There Done That\",\"marker\":{\"color\":\"rgba(102,194,165,1)\",\"line\":{\"color\":\"rgba(102,194,165,1)\"}},\"textfont\":{\"color\":\"rgba(102,194,165,1)\"},\"error_y\":{\"color\":\"rgba(102,194,165,1)\"},\"error_x\":{\"color\":\"rgba(102,194,165,1)\"},\"line\":{\"color\":\"rgba(102,194,165,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-08\",\"2014-01-14\",\"2014-01-14\",\"2014-01-15\"],\"y\":[3,3,3,3],\"hoverinfo\":[\"text\",\"text\",\"text\",\"text\"],\"text\":[\"Location: Brew've Been Served <br> Date: 2014-01-08 <br> Time: 08:01 <br> Day: Wed\",\"Location: Brew've Been Served <br> Date: 2014-01-14 <br> Time: 07:45 <br> Day: Tue\",\"Location: Brew've Been Served <br> Date: 2014-01-14 <br> Time: 07:53 <br> Day: Tue\",\"Location: Brew've Been Served <br> Date: 2014-01-15 <br> Time: 07:58 <br> Day: Wed\"],\"type\":\"scatter\",\"mode\":\"markers\",\"showlegend\":false,\"name\":\"Brew've Been Served\",\"marker\":{\"color\":\"rgba(252,141,98,1)\",\"line\":{\"color\":\"rgba(252,141,98,1)\"}},\"textfont\":{\"color\":\"rgba(252,141,98,1)\"},\"error_y\":{\"color\":\"rgba(252,141,98,1)\"},\"error_x\":{\"color\":\"rgba(252,141,98,1)\"},\"line\":{\"color\":\"rgba(252,141,98,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-06\",\"2014-01-10\",\"2014-01-14\"],\"y\":[3,3,3],\"hoverinfo\":[\"text\",\"text\",\"text\"],\"text\":[\"Location: Brewed Awakenings <br> Date: 2014-01-06 <br> Time: 12:00 <br> Day: Mon\",\"Location: Brewed Awakenings <br> Date: 2014-01-10 <br> Time: 12:00 <br> Day: Fri\",\"Location: Brewed Awakenings <br> Date: 2014-01-14 <br> Time: 12:00 <br> Day: Tue\"],\"type\":\"scatter\",\"mode\":\"markers\",\"showlegend\":false,\"name\":\"Brewed Awakenings\",\"marker\":{\"color\":\"rgba(141,160,203,1)\",\"line\":{\"color\":\"rgba(141,160,203,1)\"}},\"textfont\":{\"color\":\"rgba(141,160,203,1)\"},\"error_y\":{\"color\":\"rgba(141,160,203,1)\"},\"error_x\":{\"color\":\"rgba(141,160,203,1)\"},\"line\":{\"color\":\"rgba(141,160,203,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-19\"],\"y\":[4],\"hoverinfo\":\"text\",\"text\":\"Location: Guy's Gyros <br> Date: 2014-01-19 <br> Time: 19:45 <br> Day: Sun\",\"type\":\"scatter\",\"mode\":\"markers\",\"showlegend\":false,\"name\":\"Guy's Gyros\",\"marker\":{\"color\":\"rgba(231,138,195,1)\",\"line\":{\"color\":\"rgba(231,138,195,1)\"}},\"textfont\":{\"color\":\"rgba(231,138,195,1)\"},\"error_y\":{\"color\":\"rgba(231,138,195,1)\"},\"error_x\":{\"color\":\"rgba(231,138,195,1)\"},\"line\":{\"color\":\"rgba(231,138,195,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-10\",\"2014-01-16\"],\"y\":[3,3],\"hoverinfo\":[\"text\",\"text\"],\"text\":[\"Location: Hallowed Grounds <br> Date: 2014-01-10 <br> Time: 07:41 <br> Day: Fri\",\"Location: Hallowed Grounds <br> Date: 2014-01-16 <br> Time: 07:44 <br> Day: Thu\"],\"type\":\"scatter\",\"mode\":\"markers\",\"showlegend\":false,\"name\":\"Hallowed Grounds\",\"marker\":{\"color\":\"rgba(166,216,84,1)\",\"line\":{\"color\":\"rgba(166,216,84,1)\"}},\"textfont\":{\"color\":\"rgba(166,216,84,1)\"},\"error_y\":{\"color\":\"rgba(166,216,84,1)\"},\"error_x\":{\"color\":\"rgba(166,216,84,1)\"},\"line\":{\"color\":\"rgba(166,216,84,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-13\",\"2014-01-16\",\"2014-01-06\",\"2014-01-08\",\"2014-01-10\"],\"y\":[4,4,3,3,3],\"hoverinfo\":[\"text\",\"text\",\"text\",\"text\",\"text\"],\"text\":[\"Location: Jack's Magical Beans <br> Date: 2014-01-13 <br> Time: 12:00 <br> Day: Mon\",\"Location: Jack's Magical Beans <br> Date: 2014-01-16 <br> Time: 12:00 <br> Day: Thu\",\"Location: Jack's Magical Beans <br> Date: 2014-01-06 <br> Time: 12:00 <br> Day: Mon\",\"Location: Jack's Magical Beans <br> Date: 2014-01-08 <br> Time: 12:00 <br> Day: Wed\",\"Location: Jack's Magical Beans <br> Date: 2014-01-10 <br> Time: 12:00 <br> Day: Fri\"],\"type\":\"scatter\",\"mode\":\"markers\",\"showlegend\":false,\"name\":\"Jack's Magical Beans\",\"marker\":{\"color\":\"rgba(255,217,47,1)\",\"line\":{\"color\":\"rgba(255,217,47,1)\"}},\"textfont\":{\"color\":\"rgba(255,217,47,1)\"},\"error_y\":{\"color\":\"rgba(255,217,47,1)\"},\"error_x\":{\"color\":\"rgba(255,217,47,1)\"},\"line\":{\"color\":\"rgba(255,217,47,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}\r\nNext, we will analyse the highest frequented location based on day and time. To do that, we will need to use this unite to combine both day and time together and group the, by location and daytime.\r\n\r\n\r\ncc_loyalty_day <- cc_loyalty_join %>%\r\n  unite(col = \"daytime\", day,time, sep = \" \",  remove =FALSE) %>%\r\n  group_by(location, daytime) %>%\r\n  summarize(count = n()) %>%\r\n  arrange(desc(count))\r\n\r\ncc_loyalty_day\r\n\r\n\r\n# A tibble: 937 x 3\r\n# Groups:   location [32]\r\n   location             daytime   count\r\n   <chr>                <chr>     <int>\r\n 1 Bean There Done That Mon 12:00    11\r\n 2 Bean There Done That Fri 12:00    10\r\n 3 Jack's Magical Beans Mon 12:00     7\r\n 4 Bean There Done That Thu 12:00     6\r\n 5 Jack's Magical Beans Thu 12:00     6\r\n 6 Bean There Done That Wed 12:00     5\r\n 7 Brewed Awakenings    Fri 12:00     5\r\n 8 Brewed Awakenings    Mon 12:00     5\r\n 9 Jack's Magical Beans Fri 12:00     5\r\n10 Jack's Magical Beans Wed 12:00     5\r\n# ... with 927 more rows\r\n\r\nNext, a bar chart is plotted by filtering out those with more than or equal to 5. From the bar chart, we are able to see that Bean there done that has the highest visitations at a point of time, this is similar to the analysis we did before. The highest is 11 counts on Mon, 12:00H, next is Fri, 12:00H with 11 counts. The nect highest visited location at a point of time is Jack’s Magical Beans which clock 7 counts on Mon, 12:00H, followed by Thu, 12:00H of 6 counts.\r\n\r\n\r\ncc_day <- cc_loyalty_day %>%\r\n  filter(count >=5) %>%\r\n  plot_ly(x = ~daytime, y = ~count, color = ~location, hoverinfo = \"text\", text = ~paste(\"Location:\", location, \"<br>\",\"Day Time:\", daytime, \"<br>\", \"No.of visitors:\", count)) %>%\r\n  add_bars() %>%\r\n  layout (title = \"Total counts of visitors by day and time\", xaxis = list(title = \"\", size = 3, dtick = ~daytime), yaxis = list(title = \"Number of visitors\") )\r\n\r\ncc_day\r\n\r\n\r\n\r\n{\"x\":{\"visdat\":{\"4aec7b23956\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"4aec7b23956\",\"attrs\":{\"4aec7b23956\":{\"x\":{},\"y\":{},\"hoverinfo\":\"text\",\"text\":{},\"color\":{},\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"bar\",\"inherit\":true}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":\"Total counts of visitors by day and time\",\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"\",\"size\":3,\"dtick\":[\"Mon 12:00\",\"Fri 12:00\",\"Mon 12:00\",\"Thu 12:00\",\"Thu 12:00\",\"Wed 12:00\",\"Fri 12:00\",\"Mon 12:00\",\"Fri 12:00\",\"Wed 12:00\"],\"type\":\"category\",\"categoryorder\":\"array\",\"categoryarray\":[\"Fri 12:00\",\"Mon 12:00\",\"Thu 12:00\",\"Wed 12:00\"]},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Number of visitors\"},\"hovermode\":\"closest\",\"showlegend\":true},\"source\":\"A\",\"config\":{\"showSendToCloud\":false},\"data\":[{\"x\":[\"Mon 12:00\",\"Fri 12:00\",\"Thu 12:00\",\"Wed 12:00\"],\"y\":[11,10,6,5],\"hoverinfo\":[\"text\",\"text\",\"text\",\"text\"],\"text\":[\"Location: Bean There Done That <br> Day Time: Mon 12:00 <br> No.of visitors: 11\",\"Location: Bean There Done That <br> Day Time: Fri 12:00 <br> No.of visitors: 10\",\"Location: Bean There Done That <br> Day Time: Thu 12:00 <br> No.of visitors: 6\",\"Location: Bean There Done That <br> Day Time: Wed 12:00 <br> No.of visitors: 5\"],\"type\":\"bar\",\"name\":\"Bean There Done That\",\"marker\":{\"color\":\"rgba(102,194,165,1)\",\"line\":{\"color\":\"rgba(102,194,165,1)\"}},\"textfont\":{\"color\":\"rgba(102,194,165,1)\"},\"error_y\":{\"color\":\"rgba(102,194,165,1)\"},\"error_x\":{\"color\":\"rgba(102,194,165,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"Fri 12:00\",\"Mon 12:00\"],\"y\":[5,5],\"hoverinfo\":[\"text\",\"text\"],\"text\":[\"Location: Brewed Awakenings <br> Day Time: Fri 12:00 <br> No.of visitors: 5\",\"Location: Brewed Awakenings <br> Day Time: Mon 12:00 <br> No.of visitors: 5\"],\"type\":\"bar\",\"name\":\"Brewed Awakenings\",\"marker\":{\"color\":\"rgba(252,141,98,1)\",\"line\":{\"color\":\"rgba(252,141,98,1)\"}},\"textfont\":{\"color\":\"rgba(252,141,98,1)\"},\"error_y\":{\"color\":\"rgba(252,141,98,1)\"},\"error_x\":{\"color\":\"rgba(252,141,98,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"Mon 12:00\",\"Thu 12:00\",\"Fri 12:00\",\"Wed 12:00\"],\"y\":[7,6,5,5],\"hoverinfo\":[\"text\",\"text\",\"text\",\"text\"],\"text\":[\"Location: Jack's Magical Beans <br> Day Time: Mon 12:00 <br> No.of visitors: 7\",\"Location: Jack's Magical Beans <br> Day Time: Thu 12:00 <br> No.of visitors: 6\",\"Location: Jack's Magical Beans <br> Day Time: Fri 12:00 <br> No.of visitors: 5\",\"Location: Jack's Magical Beans <br> Day Time: Wed 12:00 <br> No.of visitors: 5\"],\"type\":\"bar\",\"name\":\"Jack's Magical Beans\",\"marker\":{\"color\":\"rgba(141,160,203,1)\",\"line\":{\"color\":\"rgba(141,160,203,1)\"}},\"textfont\":{\"color\":\"rgba(141,160,203,1)\"},\"error_y\":{\"color\":\"rgba(141,160,203,1)\"},\"error_x\":{\"color\":\"rgba(141,160,203,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}\r\nHaving completed some EDA by inner joining both cc and loyalty dataset. We will sieve out those dataset that were in cc but not in loyalty. The method to do this is by using anti-join. Anti-join will take out those dataset that does not belongs to the secondary dataset but in the main dataset.\r\nThis method is similar to full join therafter sieving those NA values.\r\nFrom the anti-joined data below, we are able to see that there are 409 rows that were in cc but not in loyalty. This form an anomaly that cc were used in the purchases but not the loyalty card.\r\n\r\n\r\ncc_loyalty_antijoin <- cc_dtsplit %>%\r\n  anti_join(loyalty_dt, by = c(\"date\",\"location\", \"price\"))\r\n\r\n\r\ncc_loyalty_antijoin\r\n\r\n\r\n# A tibble: 409 x 7\r\n   timestamp           location      price last4ccnum day   date      \r\n   <dttm>              <chr>         <dbl> <fct>      <ord> <date>    \r\n 1 2014-01-06 07:34:00 Hallowed Gr~ 5.22e1 7108       Mon   2014-01-06\r\n 2 2014-01-06 07:42:00 Coffee Came~ 2.87e1 7253       Mon   2014-01-06\r\n 3 2014-01-06 07:52:00 Brew've Bee~ 3.28e1 9405       Mon   2014-01-06\r\n 4 2014-01-06 07:54:00 Hallowed Gr~ 1.69e1 7889       Mon   2014-01-06\r\n 5 2014-01-06 07:54:00 Hallowed Gr~ 3.29e1 2681       Mon   2014-01-06\r\n 6 2014-01-06 08:00:00 Hallowed Gr~ 9.69e0 6691       Mon   2014-01-06\r\n 7 2014-01-06 08:14:00 Coffee Came~ 3.2 e0 2418       Mon   2014-01-06\r\n 8 2014-01-06 12:00:00 Coffee Shack 5.15e1 7117       Mon   2014-01-06\r\n 9 2014-01-06 12:00:00 Jack's Magi~ 2.78e1 8156       Mon   2014-01-06\r\n10 2014-01-06 12:16:00 Abila Airpo~ 1.87e3 8642       Mon   2014-01-06\r\n# ... with 399 more rows, and 1 more variable: time <chr>\r\n\r\nNext, we will create a basic bar chart based on the anti join dataset.\r\nBased on the bar chart below, we can see that similar to the inner join dataset, the four locations are Katerina’s Cafe, Hippokampos, Brew’s been served and Guy’s Gyros with the highest count of 59 clock at Katerina’s Cafe.\r\nOne major difference between this anti joined dataset versus the inner joined is that the descending gradient for each restaurant is not as steep as the inner joined. In the inner joined dataset, the 4th highest visited location is almost 2x the 5th highest visited location. As for the below chart, we can see that the decrement is not that steep.\r\n\r\n\r\ncc_anti <- cc_loyalty_antijoin %>%\r\n  count(location) %>%\r\n  mutate(location = fct_reorder(location, n, .desc =TRUE)) %>%\r\n  plot_ly(x = ~location, y = ~n, marker = list(color = ~n)) %>%\r\n  add_bars(name = \"anti-join\") %>%\r\n  layout(title = \"Total number of visitation by area\", xaxis = list(title = \"\", automargin = TRUE),yaxis = list(title = \"Number of visitors\", automargin = TRUE))\r\n\r\ncc_anti\r\n\r\n\r\n\r\n{\"x\":{\"visdat\":{\"4aec702b449d\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"4aec702b449d\",\"attrs\":{\"4aec702b449d\":{\"x\":{},\"y\":{},\"marker\":{\"color\":{}},\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"bar\",\"name\":\"anti-join\",\"inherit\":true}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":\"Total number of visitation by area\",\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"\",\"type\":\"category\",\"categoryorder\":\"array\",\"categoryarray\":[\"Katerina\\u0012s Cafi\",\"Hippokampos\",\"Brew've Been Served\",\"Guy's Gyros\",\"Hallowed Grounds\",\"Ouzeri Elian\",\"Abila Zacharo\",\"Gelatogalore\",\"Frydos Autosupply n' More\",\"Jack's Magical Beans\",\"Bean There Done That\",\"Kalami Kafenion\",\"Coffee Cameleon\",\"Kronos Mart\",\"Brewed Awakenings\",\"Stewart and Sons Fabrication\",\"Abila Airport\",\"Nationwide Refinery\",\"Shoppers' Delight\",\"Roberts and Sons\",\"Carlyle Chemical Inc.\",\"Chostus Hotel\",\"General Grocer\",\"Ahaggo Museum\",\"Albert's Fine Clothing\",\"Coffee Shack\",\"Daily Dealz\",\"Desafio Golf Course\",\"Kronos Pipe and Irrigation\",\"Octavio's Office Supplies\",\"U-Pump\"]},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Number of visitors\"},\"hovermode\":\"closest\",\"showlegend\":false},\"source\":\"A\",\"config\":{\"showSendToCloud\":false},\"data\":[{\"x\":[\"Abila Airport\",\"Abila Zacharo\",\"Ahaggo Museum\",\"Albert's Fine Clothing\",\"Bean There Done That\",\"Brew've Been Served\",\"Brewed Awakenings\",\"Carlyle Chemical Inc.\",\"Chostus Hotel\",\"Coffee Cameleon\",\"Coffee Shack\",\"Daily Dealz\",\"Desafio Golf Course\",\"Frydos Autosupply n' More\",\"Gelatogalore\",\"General Grocer\",\"Guy's Gyros\",\"Hallowed Grounds\",\"Hippokampos\",\"Jack's Magical Beans\",\"Kalami Kafenion\",\"Katerina\\u0012s Cafi\",\"Kronos Mart\",\"Kronos Pipe and Irrigation\",\"Nationwide Refinery\",\"Octavio's Office Supplies\",\"Ouzeri Elian\",\"Roberts and Sons\",\"Shoppers' Delight\",\"Stewart and Sons Fabrication\",\"U-Pump\"],\"y\":[5,20,1,1,11,45,9,3,3,10,1,1,1,13,16,2,39,32,56,12,11,59,10,1,5,1,25,4,5,6,1],\"marker\":{\"color\":[5,20,1,1,11,45,9,3,3,10,1,1,1,13,16,2,39,32,56,12,11,59,10,1,5,1,25,4,5,6,1],\"line\":{\"color\":\"rgba(31,119,180,1)\"}},\"type\":\"bar\",\"name\":\"anti-join\",\"error_y\":{\"color\":\"rgba(31,119,180,1)\"},\"error_x\":{\"color\":\"rgba(31,119,180,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}\r\nNext, we will group the anti joined dataset to extract the number of visitations at a point of time. Based on the raw grouped data below, we can see that the count of visitations is quite linear with no high variations observed.\r\n\r\n\r\ncc_loyalty_anti_group <- cc_loyalty_antijoin %>%\r\n  group_by(location, day, date, time) %>%\r\n  summarize(count = n()) %>%\r\n  arrange(desc(count)) %>%\r\n  ungroup()\r\n\r\ncc_loyalty_anti_group\r\n\r\n\r\n# A tibble: 391 x 5\r\n   location             day   date       time  count\r\n   <chr>                <ord> <date>     <chr> <int>\r\n 1 Bean There Done That Tue   2014-01-07 12:00     3\r\n 2 Brewed Awakenings    Tue   2014-01-07 12:00     3\r\n 3 Jack's Magical Beans Thu   2014-01-09 12:00     3\r\n 4 Bean There Done That Tue   2014-01-14 12:00     2\r\n 5 Bean There Done That Wed   2014-01-08 12:00     2\r\n 6 Brew've Been Served  Fri   2014-01-10 07:56     2\r\n 7 Guy's Gyros          Tue   2014-01-07 20:10     2\r\n 8 Hallowed Grounds     Mon   2014-01-06 07:54     2\r\n 9 Hallowed Grounds     Wed   2014-01-08 07:39     2\r\n10 Hallowed Grounds     Thu   2014-01-16 07:51     2\r\n# ... with 381 more rows\r\n\r\nUsing the group data, we will create a time-series chart to see the trend throughout the duration of study. We will output those data with count of more than or equal to 2.\r\nBased on the chart below, we can observe that Bean there done that and Jack’s Magical Beans at one point has the highest visitations of 3 transactions. The rest of the location are quite constant with 2 transactions.\r\n\r\n\r\n cc_anti_timeseries <- cc_loyalty_anti_group %>%\r\n  filter(count >= 2) %>%\r\n  plot_ly(x = ~date, y =~count, color = ~location, hoverinfo = \"text\",\r\n          text = ~paste(\"Location:\", location, \"<br>\",\"Date:\", date, \"<br>\",\"Time:\", time, \"<br>\", \"Day:\", day)) %>%\r\n  add_lines() %>%\r\n  add_markers(showlegend = FALSE) %>%\r\n  layout(title = \"Most frequented places by groups of people\", xaxis = list(title = \"\", dtick = ~date, showgrid = FALSE), yaxis = list(title = \"Number of people\"))\r\n\r\ncc_anti_timeseries\r\n\r\n\r\n\r\n{\"x\":{\"visdat\":{\"4aec62336999\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"4aec62336999\",\"attrs\":{\"4aec62336999\":{\"x\":{},\"y\":{},\"hoverinfo\":\"text\",\"text\":{},\"color\":{},\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"scatter\",\"mode\":\"lines\",\"inherit\":true},\"4aec62336999.1\":{\"x\":{},\"y\":{},\"hoverinfo\":\"text\",\"text\":{},\"color\":{},\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"scatter\",\"mode\":\"markers\",\"showlegend\":false,\"inherit\":true}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":\"Most frequented places by groups of people\",\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"\",\"dtick\":[\"2014-01-07\",\"2014-01-07\",\"2014-01-09\",\"2014-01-14\",\"2014-01-08\",\"2014-01-10\",\"2014-01-07\",\"2014-01-06\",\"2014-01-08\",\"2014-01-16\",\"2014-01-11\",\"2014-01-07\",\"2014-01-14\",\"2014-01-15\",\"2014-01-07\"],\"showgrid\":false},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Number of people\"},\"hovermode\":\"closest\",\"showlegend\":true},\"source\":\"A\",\"config\":{\"showSendToCloud\":false},\"data\":[{\"x\":[\"2014-01-07\",\"2014-01-08\",\"2014-01-14\"],\"y\":[3,2,2],\"hoverinfo\":[\"text\",\"text\",\"text\"],\"text\":[\"Location: Bean There Done That <br> Date: 2014-01-07 <br> Time: 12:00 <br> Day: Tue\",\"Location: Bean There Done That <br> Date: 2014-01-08 <br> Time: 12:00 <br> Day: Wed\",\"Location: Bean There Done That <br> Date: 2014-01-14 <br> Time: 12:00 <br> Day: Tue\"],\"type\":\"scatter\",\"mode\":\"lines\",\"name\":\"Bean There Done That\",\"marker\":{\"color\":\"rgba(102,194,165,1)\",\"line\":{\"color\":\"rgba(102,194,165,1)\"}},\"textfont\":{\"color\":\"rgba(102,194,165,1)\"},\"error_y\":{\"color\":\"rgba(102,194,165,1)\"},\"error_x\":{\"color\":\"rgba(102,194,165,1)\"},\"line\":{\"color\":\"rgba(102,194,165,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-10\"],\"y\":[2],\"hoverinfo\":\"text\",\"text\":\"Location: Brew've Been Served <br> Date: 2014-01-10 <br> Time: 07:56 <br> Day: Fri\",\"type\":\"scatter\",\"mode\":\"lines\",\"name\":\"Brew've Been Served\",\"marker\":{\"color\":\"rgba(252,141,98,1)\",\"line\":{\"color\":\"rgba(252,141,98,1)\"}},\"textfont\":{\"color\":\"rgba(252,141,98,1)\"},\"error_y\":{\"color\":\"rgba(252,141,98,1)\"},\"error_x\":{\"color\":\"rgba(252,141,98,1)\"},\"line\":{\"color\":\"rgba(252,141,98,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-07\"],\"y\":[3],\"hoverinfo\":\"text\",\"text\":\"Location: Brewed Awakenings <br> Date: 2014-01-07 <br> Time: 12:00 <br> Day: Tue\",\"type\":\"scatter\",\"mode\":\"lines\",\"name\":\"Brewed Awakenings\",\"marker\":{\"color\":\"rgba(141,160,203,1)\",\"line\":{\"color\":\"rgba(141,160,203,1)\"}},\"textfont\":{\"color\":\"rgba(141,160,203,1)\"},\"error_y\":{\"color\":\"rgba(141,160,203,1)\"},\"error_x\":{\"color\":\"rgba(141,160,203,1)\"},\"line\":{\"color\":\"rgba(141,160,203,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-07\"],\"y\":[2],\"hoverinfo\":\"text\",\"text\":\"Location: Guy's Gyros <br> Date: 2014-01-07 <br> Time: 20:10 <br> Day: Tue\",\"type\":\"scatter\",\"mode\":\"lines\",\"name\":\"Guy's Gyros\",\"marker\":{\"color\":\"rgba(231,138,195,1)\",\"line\":{\"color\":\"rgba(231,138,195,1)\"}},\"textfont\":{\"color\":\"rgba(231,138,195,1)\"},\"error_y\":{\"color\":\"rgba(231,138,195,1)\"},\"error_x\":{\"color\":\"rgba(231,138,195,1)\"},\"line\":{\"color\":\"rgba(231,138,195,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-06\",\"2014-01-08\",\"2014-01-16\"],\"y\":[2,2,2],\"hoverinfo\":[\"text\",\"text\",\"text\"],\"text\":[\"Location: Hallowed Grounds <br> Date: 2014-01-06 <br> Time: 07:54 <br> Day: Mon\",\"Location: Hallowed Grounds <br> Date: 2014-01-08 <br> Time: 07:39 <br> Day: Wed\",\"Location: Hallowed Grounds <br> Date: 2014-01-16 <br> Time: 07:51 <br> Day: Thu\"],\"type\":\"scatter\",\"mode\":\"lines\",\"name\":\"Hallowed Grounds\",\"marker\":{\"color\":\"rgba(166,216,84,1)\",\"line\":{\"color\":\"rgba(166,216,84,1)\"}},\"textfont\":{\"color\":\"rgba(166,216,84,1)\"},\"error_y\":{\"color\":\"rgba(166,216,84,1)\"},\"error_x\":{\"color\":\"rgba(166,216,84,1)\"},\"line\":{\"color\":\"rgba(166,216,84,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-11\"],\"y\":[2],\"hoverinfo\":\"text\",\"text\":\"Location: Hippokampos <br> Date: 2014-01-11 <br> Time: 13:37 <br> Day: Sat\",\"type\":\"scatter\",\"mode\":\"lines\",\"name\":\"Hippokampos\",\"marker\":{\"color\":\"rgba(255,217,47,1)\",\"line\":{\"color\":\"rgba(255,217,47,1)\"}},\"textfont\":{\"color\":\"rgba(255,217,47,1)\"},\"error_y\":{\"color\":\"rgba(255,217,47,1)\"},\"error_x\":{\"color\":\"rgba(255,217,47,1)\"},\"line\":{\"color\":\"rgba(255,217,47,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-07\",\"2014-01-09\",\"2014-01-14\",\"2014-01-15\"],\"y\":[2,3,2,2],\"hoverinfo\":[\"text\",\"text\",\"text\",\"text\"],\"text\":[\"Location: Jack's Magical Beans <br> Date: 2014-01-07 <br> Time: 12:00 <br> Day: Tue\",\"Location: Jack's Magical Beans <br> Date: 2014-01-09 <br> Time: 12:00 <br> Day: Thu\",\"Location: Jack's Magical Beans <br> Date: 2014-01-14 <br> Time: 12:00 <br> Day: Tue\",\"Location: Jack's Magical Beans <br> Date: 2014-01-15 <br> Time: 12:00 <br> Day: Wed\"],\"type\":\"scatter\",\"mode\":\"lines\",\"name\":\"Jack's Magical Beans\",\"marker\":{\"color\":\"rgba(229,196,148,1)\",\"line\":{\"color\":\"rgba(229,196,148,1)\"}},\"textfont\":{\"color\":\"rgba(229,196,148,1)\"},\"error_y\":{\"color\":\"rgba(229,196,148,1)\"},\"error_x\":{\"color\":\"rgba(229,196,148,1)\"},\"line\":{\"color\":\"rgba(229,196,148,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-07\"],\"y\":[2],\"hoverinfo\":\"text\",\"text\":\"Location: Katerina\\u0012s Cafi <br> Date: 2014-01-07 <br> Time: 20:13 <br> Day: Tue\",\"type\":\"scatter\",\"mode\":\"lines\",\"name\":\"Katerina\\u0012s Cafi\",\"marker\":{\"color\":\"rgba(179,179,179,1)\",\"line\":{\"color\":\"rgba(179,179,179,1)\"}},\"textfont\":{\"color\":\"rgba(179,179,179,1)\"},\"error_y\":{\"color\":\"rgba(179,179,179,1)\"},\"error_x\":{\"color\":\"rgba(179,179,179,1)\"},\"line\":{\"color\":\"rgba(179,179,179,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-07\",\"2014-01-14\",\"2014-01-08\"],\"y\":[3,2,2],\"hoverinfo\":[\"text\",\"text\",\"text\"],\"text\":[\"Location: Bean There Done That <br> Date: 2014-01-07 <br> Time: 12:00 <br> Day: Tue\",\"Location: Bean There Done That <br> Date: 2014-01-14 <br> Time: 12:00 <br> Day: Tue\",\"Location: Bean There Done That <br> Date: 2014-01-08 <br> Time: 12:00 <br> Day: Wed\"],\"type\":\"scatter\",\"mode\":\"markers\",\"showlegend\":false,\"name\":\"Bean There Done That\",\"marker\":{\"color\":\"rgba(102,194,165,1)\",\"line\":{\"color\":\"rgba(102,194,165,1)\"}},\"textfont\":{\"color\":\"rgba(102,194,165,1)\"},\"error_y\":{\"color\":\"rgba(102,194,165,1)\"},\"error_x\":{\"color\":\"rgba(102,194,165,1)\"},\"line\":{\"color\":\"rgba(102,194,165,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-10\"],\"y\":[2],\"hoverinfo\":\"text\",\"text\":\"Location: Brew've Been Served <br> Date: 2014-01-10 <br> Time: 07:56 <br> Day: Fri\",\"type\":\"scatter\",\"mode\":\"markers\",\"showlegend\":false,\"name\":\"Brew've Been Served\",\"marker\":{\"color\":\"rgba(252,141,98,1)\",\"line\":{\"color\":\"rgba(252,141,98,1)\"}},\"textfont\":{\"color\":\"rgba(252,141,98,1)\"},\"error_y\":{\"color\":\"rgba(252,141,98,1)\"},\"error_x\":{\"color\":\"rgba(252,141,98,1)\"},\"line\":{\"color\":\"rgba(252,141,98,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-07\"],\"y\":[3],\"hoverinfo\":\"text\",\"text\":\"Location: Brewed Awakenings <br> Date: 2014-01-07 <br> Time: 12:00 <br> Day: Tue\",\"type\":\"scatter\",\"mode\":\"markers\",\"showlegend\":false,\"name\":\"Brewed Awakenings\",\"marker\":{\"color\":\"rgba(141,160,203,1)\",\"line\":{\"color\":\"rgba(141,160,203,1)\"}},\"textfont\":{\"color\":\"rgba(141,160,203,1)\"},\"error_y\":{\"color\":\"rgba(141,160,203,1)\"},\"error_x\":{\"color\":\"rgba(141,160,203,1)\"},\"line\":{\"color\":\"rgba(141,160,203,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-07\"],\"y\":[2],\"hoverinfo\":\"text\",\"text\":\"Location: Guy's Gyros <br> Date: 2014-01-07 <br> Time: 20:10 <br> Day: Tue\",\"type\":\"scatter\",\"mode\":\"markers\",\"showlegend\":false,\"name\":\"Guy's Gyros\",\"marker\":{\"color\":\"rgba(231,138,195,1)\",\"line\":{\"color\":\"rgba(231,138,195,1)\"}},\"textfont\":{\"color\":\"rgba(231,138,195,1)\"},\"error_y\":{\"color\":\"rgba(231,138,195,1)\"},\"error_x\":{\"color\":\"rgba(231,138,195,1)\"},\"line\":{\"color\":\"rgba(231,138,195,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-06\",\"2014-01-08\",\"2014-01-16\"],\"y\":[2,2,2],\"hoverinfo\":[\"text\",\"text\",\"text\"],\"text\":[\"Location: Hallowed Grounds <br> Date: 2014-01-06 <br> Time: 07:54 <br> Day: Mon\",\"Location: Hallowed Grounds <br> Date: 2014-01-08 <br> Time: 07:39 <br> Day: Wed\",\"Location: Hallowed Grounds <br> Date: 2014-01-16 <br> Time: 07:51 <br> Day: Thu\"],\"type\":\"scatter\",\"mode\":\"markers\",\"showlegend\":false,\"name\":\"Hallowed Grounds\",\"marker\":{\"color\":\"rgba(166,216,84,1)\",\"line\":{\"color\":\"rgba(166,216,84,1)\"}},\"textfont\":{\"color\":\"rgba(166,216,84,1)\"},\"error_y\":{\"color\":\"rgba(166,216,84,1)\"},\"error_x\":{\"color\":\"rgba(166,216,84,1)\"},\"line\":{\"color\":\"rgba(166,216,84,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-11\"],\"y\":[2],\"hoverinfo\":\"text\",\"text\":\"Location: Hippokampos <br> Date: 2014-01-11 <br> Time: 13:37 <br> Day: Sat\",\"type\":\"scatter\",\"mode\":\"markers\",\"showlegend\":false,\"name\":\"Hippokampos\",\"marker\":{\"color\":\"rgba(255,217,47,1)\",\"line\":{\"color\":\"rgba(255,217,47,1)\"}},\"textfont\":{\"color\":\"rgba(255,217,47,1)\"},\"error_y\":{\"color\":\"rgba(255,217,47,1)\"},\"error_x\":{\"color\":\"rgba(255,217,47,1)\"},\"line\":{\"color\":\"rgba(255,217,47,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-09\",\"2014-01-07\",\"2014-01-14\",\"2014-01-15\"],\"y\":[3,2,2,2],\"hoverinfo\":[\"text\",\"text\",\"text\",\"text\"],\"text\":[\"Location: Jack's Magical Beans <br> Date: 2014-01-09 <br> Time: 12:00 <br> Day: Thu\",\"Location: Jack's Magical Beans <br> Date: 2014-01-07 <br> Time: 12:00 <br> Day: Tue\",\"Location: Jack's Magical Beans <br> Date: 2014-01-14 <br> Time: 12:00 <br> Day: Tue\",\"Location: Jack's Magical Beans <br> Date: 2014-01-15 <br> Time: 12:00 <br> Day: Wed\"],\"type\":\"scatter\",\"mode\":\"markers\",\"showlegend\":false,\"name\":\"Jack's Magical Beans\",\"marker\":{\"color\":\"rgba(229,196,148,1)\",\"line\":{\"color\":\"rgba(229,196,148,1)\"}},\"textfont\":{\"color\":\"rgba(229,196,148,1)\"},\"error_y\":{\"color\":\"rgba(229,196,148,1)\"},\"error_x\":{\"color\":\"rgba(229,196,148,1)\"},\"line\":{\"color\":\"rgba(229,196,148,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-07\"],\"y\":[2],\"hoverinfo\":\"text\",\"text\":\"Location: Katerina\\u0012s Cafi <br> Date: 2014-01-07 <br> Time: 20:13 <br> Day: Tue\",\"type\":\"scatter\",\"mode\":\"markers\",\"showlegend\":false,\"name\":\"Katerina\\u0012s Cafi\",\"marker\":{\"color\":\"rgba(179,179,179,1)\",\"line\":{\"color\":\"rgba(179,179,179,1)\"}},\"textfont\":{\"color\":\"rgba(179,179,179,1)\"},\"error_y\":{\"color\":\"rgba(179,179,179,1)\"},\"error_x\":{\"color\":\"rgba(179,179,179,1)\"},\"line\":{\"color\":\"rgba(179,179,179,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}\r\nSimilar to the above inner joined dataset, we will create a daytime column to observe which daytime has the highest count.\r\n\r\n\r\ncc_loyalty_day_anti <- cc_loyalty_antijoin %>%\r\n  unite(col = \"daytime\", day,time, sep = \" \",  remove =FALSE) %>%\r\n  group_by(location, daytime) %>%\r\n  summarize(count = n()) %>%\r\n  arrange(desc(count))\r\n\r\ncc_loyalty_day_anti\r\n\r\n\r\n# A tibble: 379 x 3\r\n# Groups:   location [31]\r\n   location             daytime   count\r\n   <chr>                <chr>     <int>\r\n 1 Bean There Done That Tue 12:00     5\r\n 2 Jack's Magical Beans Tue 12:00     4\r\n 3 Bean There Done That Wed 12:00     3\r\n 4 Brewed Awakenings    Tue 12:00     3\r\n 5 Hallowed Grounds     Thu 07:51     3\r\n 6 Hallowed Grounds     Wed 07:39     3\r\n 7 Jack's Magical Beans Thu 12:00     3\r\n 8 Jack's Magical Beans Wed 12:00     3\r\n 9 Bean There Done That Thu 12:00     2\r\n10 Brew've Been Served  Fri 07:56     2\r\n# ... with 369 more rows\r\n\r\nBased on the chart below, we can see that the highest count per daytime is 5 counts of visitors at Bean there done that which was clocked on Tue, 12:00pm followed by Jack’s Magical bean of 4 counts on the same day.\r\n\r\n\r\ncc_anti_day <- cc_loyalty_day_anti %>%\r\n  filter(count >=3) %>%\r\n  plot_ly(x = ~daytime, y = ~count, color = ~location, hoverinfo = \"text\", text = ~paste(\"Location:\", location, \"<br>\",\"Day Time:\", daytime, \"<br>\", \"No.of visitors:\", count)) %>%\r\n  add_bars() %>%\r\n  layout (title = \"Total counts of visitors by day and time\", xaxis = list(title = \"\", size = 3, dtick = ~daytime), automargin = TRUE, yaxis = list(title = \"Number of visitors\"))\r\n\r\ncc_anti_day\r\n\r\n\r\n\r\n{\"x\":{\"visdat\":{\"4aec4005502\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"4aec4005502\",\"attrs\":{\"4aec4005502\":{\"x\":{},\"y\":{},\"hoverinfo\":\"text\",\"text\":{},\"color\":{},\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"bar\",\"inherit\":true}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":\"Total counts of visitors by day and time\",\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"\",\"size\":3,\"dtick\":[\"Tue 12:00\",\"Tue 12:00\",\"Wed 12:00\",\"Tue 12:00\",\"Thu 07:51\",\"Wed 07:39\",\"Thu 12:00\",\"Wed 12:00\"],\"type\":\"category\",\"categoryorder\":\"array\",\"categoryarray\":[\"Thu 07:51\",\"Thu 12:00\",\"Tue 12:00\",\"Wed 07:39\",\"Wed 12:00\"]},\"automargin\":true,\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Number of visitors\"},\"hovermode\":\"closest\",\"showlegend\":true},\"source\":\"A\",\"config\":{\"showSendToCloud\":false},\"data\":[{\"x\":[\"Tue 12:00\",\"Wed 12:00\"],\"y\":[5,3],\"hoverinfo\":[\"text\",\"text\"],\"text\":[\"Location: Bean There Done That <br> Day Time: Tue 12:00 <br> No.of visitors: 5\",\"Location: Bean There Done That <br> Day Time: Wed 12:00 <br> No.of visitors: 3\"],\"type\":\"bar\",\"name\":\"Bean There Done That\",\"marker\":{\"color\":\"rgba(102,194,165,1)\",\"line\":{\"color\":\"rgba(102,194,165,1)\"}},\"textfont\":{\"color\":\"rgba(102,194,165,1)\"},\"error_y\":{\"color\":\"rgba(102,194,165,1)\"},\"error_x\":{\"color\":\"rgba(102,194,165,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"Tue 12:00\"],\"y\":[3],\"hoverinfo\":\"text\",\"text\":\"Location: Brewed Awakenings <br> Day Time: Tue 12:00 <br> No.of visitors: 3\",\"type\":\"bar\",\"name\":\"Brewed Awakenings\",\"marker\":{\"color\":\"rgba(252,141,98,1)\",\"line\":{\"color\":\"rgba(252,141,98,1)\"}},\"textfont\":{\"color\":\"rgba(252,141,98,1)\"},\"error_y\":{\"color\":\"rgba(252,141,98,1)\"},\"error_x\":{\"color\":\"rgba(252,141,98,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"Thu 07:51\",\"Wed 07:39\"],\"y\":[3,3],\"hoverinfo\":[\"text\",\"text\"],\"text\":[\"Location: Hallowed Grounds <br> Day Time: Thu 07:51 <br> No.of visitors: 3\",\"Location: Hallowed Grounds <br> Day Time: Wed 07:39 <br> No.of visitors: 3\"],\"type\":\"bar\",\"name\":\"Hallowed Grounds\",\"marker\":{\"color\":\"rgba(141,160,203,1)\",\"line\":{\"color\":\"rgba(141,160,203,1)\"}},\"textfont\":{\"color\":\"rgba(141,160,203,1)\"},\"error_y\":{\"color\":\"rgba(141,160,203,1)\"},\"error_x\":{\"color\":\"rgba(141,160,203,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"Tue 12:00\",\"Thu 12:00\",\"Wed 12:00\"],\"y\":[4,3,3],\"hoverinfo\":[\"text\",\"text\",\"text\"],\"text\":[\"Location: Jack's Magical Beans <br> Day Time: Tue 12:00 <br> No.of visitors: 4\",\"Location: Jack's Magical Beans <br> Day Time: Thu 12:00 <br> No.of visitors: 3\",\"Location: Jack's Magical Beans <br> Day Time: Wed 12:00 <br> No.of visitors: 3\"],\"type\":\"bar\",\"name\":\"Jack's Magical Beans\",\"marker\":{\"color\":\"rgba(231,138,195,1)\",\"line\":{\"color\":\"rgba(231,138,195,1)\"}},\"textfont\":{\"color\":\"rgba(231,138,195,1)\"},\"error_y\":{\"color\":\"rgba(231,138,195,1)\"},\"error_x\":{\"color\":\"rgba(231,138,195,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}\r\nNext, we will anti join from loyalty to cc.\r\nBased on the anti-joined data, we observe that there are 311 rows of transaction which uses loyalty card with no credit card.\r\n\r\n\r\ncc_loyalty_antijoin_right <- loyalty_dt%>%\r\n  anti_join(cc_dtsplit, by = c(\"date\",\"location\", \"price\")) %>%\r\n  ungroup()\r\n\r\ncc_loyalty_antijoin_right\r\n\r\n\r\n# A tibble: 311 x 4\r\n   date       location                    price loyaltynum\r\n   <date>     <chr>                       <dbl> <fct>     \r\n 1 2014-01-06 \"Coffee Shack\"              11.5  L6417     \r\n 2 2014-01-06 \"Hallowed Grounds\"          12.9  L1107     \r\n 3 2014-01-06 \"Abila Zacharo\"             26.9  L9018     \r\n 4 2014-01-06 \"Katerina\\u0012s Cafi\"      38.6  L6110     \r\n 5 2014-01-06 \"Frydos Autosupply n' More\" 89.3  L4034     \r\n 6 2014-01-07 \"Hallowed Grounds\"           8.42 L1107     \r\n 7 2014-01-07 \"Coffee Cameleon\"           12.4  L9018     \r\n 8 2014-01-07 \"Ouzeri Elian\"              17.7  L2247     \r\n 9 2014-01-07 \"Katerina\\u0012s Cafi\"      25.0  L2343     \r\n10 2014-01-08 \"Brew've Been Served\"       14.9  L2247     \r\n# ... with 301 more rows\r\n\r\nNotice that there is no day after the anti join was performed this is due to the fact that originally, the loyalty_dt dataset does not have the day included. As such, day is being created using the date_weekday_factor function.\r\n\r\n\r\ncc_loyalty_antijoin_mutate <- cc_loyalty_antijoin_right %>%\r\n  mutate(day = date_weekday_factor(cc_loyalty_antijoin_right$date))\r\ncc_loyalty_antijoin_mutate\r\n\r\n\r\n# A tibble: 311 x 5\r\n   date       location                    price loyaltynum day  \r\n   <date>     <chr>                       <dbl> <fct>      <ord>\r\n 1 2014-01-06 \"Coffee Shack\"              11.5  L6417      Mon  \r\n 2 2014-01-06 \"Hallowed Grounds\"          12.9  L1107      Mon  \r\n 3 2014-01-06 \"Abila Zacharo\"             26.9  L9018      Mon  \r\n 4 2014-01-06 \"Katerina\\u0012s Cafi\"      38.6  L6110      Mon  \r\n 5 2014-01-06 \"Frydos Autosupply n' More\" 89.3  L4034      Mon  \r\n 6 2014-01-07 \"Hallowed Grounds\"           8.42 L1107      Tue  \r\n 7 2014-01-07 \"Coffee Cameleon\"           12.4  L9018      Tue  \r\n 8 2014-01-07 \"Ouzeri Elian\"              17.7  L2247      Tue  \r\n 9 2014-01-07 \"Katerina\\u0012s Cafi\"      25.0  L2343      Tue  \r\n10 2014-01-08 \"Brew've Been Served\"       14.9  L2247      Wed  \r\n# ... with 301 more rows\r\n\r\nSimilar to the previous inner join and left anti join data. The four highest visited locations are Katerina’s Cafe, Hippokampos, Brew’s been served and Guy’s Gyros.\r\nKaterina’s Cafe and Hippokampos lead the two most visited location of 42 and 40 respectively.\r\n\r\n\r\ncc_anti_right <- cc_loyalty_antijoin_mutate %>%\r\n  count(location) %>%\r\n  mutate(location = fct_reorder(location, n, .desc =TRUE)) %>%\r\n  plot_ly(x = ~location, y = ~n, marker = list(color = ~n)) %>%\r\n  add_bars(name = \"anti-join-right\") %>%\r\n  layout(title = \"Total number of visitation by area\", xaxis = list(title = \"\", automargin = TRUE),yaxis = list(title = \"Number of visitors\", automargin = TRUE))\r\n\r\ncc_anti_right\r\n\r\n\r\n\r\n{\"x\":{\"visdat\":{\"4aec43182509\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"4aec43182509\",\"attrs\":{\"4aec43182509\":{\"x\":{},\"y\":{},\"marker\":{\"color\":{}},\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"bar\",\"name\":\"anti-join-right\",\"inherit\":true}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":\"Total number of visitation by area\",\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"\",\"type\":\"category\",\"categoryorder\":\"array\",\"categoryarray\":[\"Katerina\\u0012s Cafi\",\"Hippokampos\",\"Brew've Been Served\",\"Guy's Gyros\",\"Ouzeri Elian\",\"Hallowed Grounds\",\"Abila Zacharo\",\"Kalami Kafenion\",\"Gelatogalore\",\"Jack's Magical Beans\",\"Bean There Done That\",\"Coffee Cameleon\",\"Brewed Awakenings\",\"Frydos Autosupply n' More\",\"Kronos Mart\",\"Abila Airport\",\"Stewart and Sons Fabrication\",\"General Grocer\",\"Nationwide Refinery\",\"Carlyle Chemical Inc.\",\"Shoppers' Delight\",\"Chostus Hotel\",\"Coffee Shack\",\"Roberts and Sons\",\"Ahaggo Museum\",\"Albert's Fine Clothing\",\"Desafio Golf Course\",\"Kronos Pipe and Irrigation\"]},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Number of visitors\"},\"hovermode\":\"closest\",\"showlegend\":false},\"source\":\"A\",\"config\":{\"showSendToCloud\":false},\"data\":[{\"x\":[\"Abila Airport\",\"Abila Zacharo\",\"Ahaggo Museum\",\"Albert's Fine Clothing\",\"Bean There Done That\",\"Brew've Been Served\",\"Brewed Awakenings\",\"Carlyle Chemical Inc.\",\"Chostus Hotel\",\"Coffee Cameleon\",\"Coffee Shack\",\"Desafio Golf Course\",\"Frydos Autosupply n' More\",\"Gelatogalore\",\"General Grocer\",\"Guy's Gyros\",\"Hallowed Grounds\",\"Hippokampos\",\"Jack's Magical Beans\",\"Kalami Kafenion\",\"Katerina\\u0012s Cafi\",\"Kronos Mart\",\"Kronos Pipe and Irrigation\",\"Nationwide Refinery\",\"Ouzeri Elian\",\"Roberts and Sons\",\"Shoppers' Delight\",\"Stewart and Sons Fabrication\"],\"y\":[6,19,1,1,9,29,8,3,2,9,2,1,8,12,4,27,20,40,10,13,42,8,1,4,22,2,3,5],\"marker\":{\"color\":[6,19,1,1,9,29,8,3,2,9,2,1,8,12,4,27,20,40,10,13,42,8,1,4,22,2,3,5],\"line\":{\"color\":\"rgba(31,119,180,1)\"}},\"type\":\"bar\",\"name\":\"anti-join-right\",\"error_y\":{\"color\":\"rgba(31,119,180,1)\"},\"error_x\":{\"color\":\"rgba(31,119,180,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}\r\nNext, we will group the right anti joined dataset to get the count per day based on location.\r\nFrom the below chart, we can see that Hallowed Grounds have the highest count of 6 visitations on 2014-01-09.\r\n\r\n\r\ncc_loyalty_day_anti_right <- cc_loyalty_antijoin_mutate %>%\r\n  group_by(location, date,day) %>%\r\n  summarize(count = n()) %>%\r\n  arrange(desc(count)) %>%\r\n  ungroup()\r\n\r\ncc_loyalty_day_anti_right\r\n\r\n\r\n# A tibble: 161 x 4\r\n   location               date       day   count\r\n   <chr>                  <date>     <ord> <int>\r\n 1 \"Hallowed Grounds\"     2014-01-09 Thu       6\r\n 2 \"Brew've Been Served\"  2014-01-08 Wed       5\r\n 3 \"Brew've Been Served\"  2014-01-09 Thu       5\r\n 4 \"Brew've Been Served\"  2014-01-10 Fri       5\r\n 5 \"Guy's Gyros\"          2014-01-15 Wed       5\r\n 6 \"Hippokampos\"          2014-01-10 Fri       5\r\n 7 \"Katerina\\u0012s Cafi\" 2014-01-13 Mon       5\r\n 8 \"Katerina\\u0012s Cafi\" 2014-01-14 Tue       5\r\n 9 \"Katerina\\u0012s Cafi\" 2014-01-16 Thu       5\r\n10 \"Abila Zacharo\"        2014-01-13 Mon       4\r\n# ... with 151 more rows\r\n\r\nNext, we will created a bar chart to analyse those visitations of more than or equal to 4 counts. Based on the chart below, we can see that although Hallowed Grounds has the highest visitation at one point, however, it only clock once. This is also considered another anomaly as the count of visitations is not consistent in the dataset provided.\r\nThe next highest count of 5 visitations were clocked by Guys’s Gyros on 2014-01-15, Hippokampos on 2014-01-10, Katerina’s Cafe and Brew’s been served on three different occasions.\r\n\r\n\r\ncc_anti_day_right <- cc_loyalty_day_anti_right %>%\r\n  unite(col = \"daydate\", day, date, sep = \" \", remove = FALSE) %>%\r\n  filter(count >=4) %>%\r\n  plot_ly(x = ~daydate, y = ~count, color = ~location, hoverinfo = \"text\", text = ~paste(\"Location:\", location, \"<br>\",\"DayDate:\", daydate, \"<br>\", \"No.of visitors:\", count)) %>%\r\n  add_bars() %>%\r\n  layout (title = \"Total counts of visitors by date\", xaxis = list(title = \"\", size = 3, dtick = ~daydate), automargin = TRUE, yaxis = list(title = \"Number of visitors\"))\r\n\r\ncc_anti_day_right\r\n\r\n\r\n\r\n{\"x\":{\"visdat\":{\"4aec65c823b7\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"4aec65c823b7\",\"attrs\":{\"4aec65c823b7\":{\"x\":{},\"y\":{},\"hoverinfo\":\"text\",\"text\":{},\"color\":{},\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"bar\",\"inherit\":true}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":\"Total counts of visitors by date\",\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"\",\"size\":3,\"dtick\":[\"Thu 2014-01-09\",\"Wed 2014-01-08\",\"Thu 2014-01-09\",\"Fri 2014-01-10\",\"Wed 2014-01-15\",\"Fri 2014-01-10\",\"Mon 2014-01-13\",\"Tue 2014-01-14\",\"Thu 2014-01-16\",\"Mon 2014-01-13\",\"Fri 2014-01-17\",\"Tue 2014-01-07\",\"Tue 2014-01-07\",\"Mon 2014-01-13\",\"Wed 2014-01-15\",\"Fri 2014-01-17\",\"Tue 2014-01-14\",\"Tue 2014-01-07\",\"Wed 2014-01-15\",\"Fri 2014-01-17\",\"Tue 2014-01-07\",\"Wed 2014-01-08\",\"Tue 2014-01-14\"],\"type\":\"category\",\"categoryorder\":\"array\",\"categoryarray\":[\"Fri 2014-01-10\",\"Fri 2014-01-17\",\"Mon 2014-01-13\",\"Thu 2014-01-09\",\"Thu 2014-01-16\",\"Tue 2014-01-07\",\"Tue 2014-01-14\",\"Wed 2014-01-08\",\"Wed 2014-01-15\"]},\"automargin\":true,\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Number of visitors\"},\"hovermode\":\"closest\",\"showlegend\":true},\"source\":\"A\",\"config\":{\"showSendToCloud\":false},\"data\":[{\"x\":[\"Mon 2014-01-13\",\"Fri 2014-01-17\"],\"y\":[4,4],\"hoverinfo\":[\"text\",\"text\"],\"text\":[\"Location: Abila Zacharo <br> DayDate: Mon 2014-01-13 <br> No.of visitors: 4\",\"Location: Abila Zacharo <br> DayDate: Fri 2014-01-17 <br> No.of visitors: 4\"],\"type\":\"bar\",\"name\":\"Abila Zacharo\",\"marker\":{\"color\":\"rgba(102,194,165,1)\",\"line\":{\"color\":\"rgba(102,194,165,1)\"}},\"textfont\":{\"color\":\"rgba(102,194,165,1)\"},\"error_y\":{\"color\":\"rgba(102,194,165,1)\"},\"error_x\":{\"color\":\"rgba(102,194,165,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"Wed 2014-01-08\",\"Thu 2014-01-09\",\"Fri 2014-01-10\"],\"y\":[5,5,5],\"hoverinfo\":[\"text\",\"text\",\"text\"],\"text\":[\"Location: Brew've Been Served <br> DayDate: Wed 2014-01-08 <br> No.of visitors: 5\",\"Location: Brew've Been Served <br> DayDate: Thu 2014-01-09 <br> No.of visitors: 5\",\"Location: Brew've Been Served <br> DayDate: Fri 2014-01-10 <br> No.of visitors: 5\"],\"type\":\"bar\",\"name\":\"Brew've Been Served\",\"marker\":{\"color\":\"rgba(252,141,98,1)\",\"line\":{\"color\":\"rgba(252,141,98,1)\"}},\"textfont\":{\"color\":\"rgba(252,141,98,1)\"},\"error_y\":{\"color\":\"rgba(252,141,98,1)\"},\"error_x\":{\"color\":\"rgba(252,141,98,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"Wed 2014-01-15\",\"Tue 2014-01-07\"],\"y\":[5,4],\"hoverinfo\":[\"text\",\"text\"],\"text\":[\"Location: Guy's Gyros <br> DayDate: Wed 2014-01-15 <br> No.of visitors: 5\",\"Location: Guy's Gyros <br> DayDate: Tue 2014-01-07 <br> No.of visitors: 4\"],\"type\":\"bar\",\"name\":\"Guy's Gyros\",\"marker\":{\"color\":\"rgba(141,160,203,1)\",\"line\":{\"color\":\"rgba(141,160,203,1)\"}},\"textfont\":{\"color\":\"rgba(141,160,203,1)\"},\"error_y\":{\"color\":\"rgba(141,160,203,1)\"},\"error_x\":{\"color\":\"rgba(141,160,203,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"Thu 2014-01-09\"],\"y\":[6],\"hoverinfo\":\"text\",\"text\":\"Location: Hallowed Grounds <br> DayDate: Thu 2014-01-09 <br> No.of visitors: 6\",\"type\":\"bar\",\"name\":\"Hallowed Grounds\",\"marker\":{\"color\":\"rgba(231,138,195,1)\",\"line\":{\"color\":\"rgba(231,138,195,1)\"}},\"textfont\":{\"color\":\"rgba(231,138,195,1)\"},\"error_y\":{\"color\":\"rgba(231,138,195,1)\"},\"error_x\":{\"color\":\"rgba(231,138,195,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"Fri 2014-01-10\",\"Tue 2014-01-07\",\"Mon 2014-01-13\",\"Wed 2014-01-15\",\"Fri 2014-01-17\"],\"y\":[5,4,4,4,4],\"hoverinfo\":[\"text\",\"text\",\"text\",\"text\",\"text\"],\"text\":[\"Location: Hippokampos <br> DayDate: Fri 2014-01-10 <br> No.of visitors: 5\",\"Location: Hippokampos <br> DayDate: Tue 2014-01-07 <br> No.of visitors: 4\",\"Location: Hippokampos <br> DayDate: Mon 2014-01-13 <br> No.of visitors: 4\",\"Location: Hippokampos <br> DayDate: Wed 2014-01-15 <br> No.of visitors: 4\",\"Location: Hippokampos <br> DayDate: Fri 2014-01-17 <br> No.of visitors: 4\"],\"type\":\"bar\",\"name\":\"Hippokampos\",\"marker\":{\"color\":\"rgba(166,216,84,1)\",\"line\":{\"color\":\"rgba(166,216,84,1)\"}},\"textfont\":{\"color\":\"rgba(166,216,84,1)\"},\"error_y\":{\"color\":\"rgba(166,216,84,1)\"},\"error_x\":{\"color\":\"rgba(166,216,84,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"Tue 2014-01-14\"],\"y\":[4],\"hoverinfo\":\"text\",\"text\":\"Location: Jack's Magical Beans <br> DayDate: Tue 2014-01-14 <br> No.of visitors: 4\",\"type\":\"bar\",\"name\":\"Jack's Magical Beans\",\"marker\":{\"color\":\"rgba(255,217,47,1)\",\"line\":{\"color\":\"rgba(255,217,47,1)\"}},\"textfont\":{\"color\":\"rgba(255,217,47,1)\"},\"error_y\":{\"color\":\"rgba(255,217,47,1)\"},\"error_x\":{\"color\":\"rgba(255,217,47,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"Mon 2014-01-13\",\"Tue 2014-01-14\",\"Thu 2014-01-16\",\"Tue 2014-01-07\",\"Wed 2014-01-15\",\"Fri 2014-01-17\"],\"y\":[5,5,5,4,4,4],\"hoverinfo\":[\"text\",\"text\",\"text\",\"text\",\"text\",\"text\"],\"text\":[\"Location: Katerina\\u0012s Cafi <br> DayDate: Mon 2014-01-13 <br> No.of visitors: 5\",\"Location: Katerina\\u0012s Cafi <br> DayDate: Tue 2014-01-14 <br> No.of visitors: 5\",\"Location: Katerina\\u0012s Cafi <br> DayDate: Thu 2014-01-16 <br> No.of visitors: 5\",\"Location: Katerina\\u0012s Cafi <br> DayDate: Tue 2014-01-07 <br> No.of visitors: 4\",\"Location: Katerina\\u0012s Cafi <br> DayDate: Wed 2014-01-15 <br> No.of visitors: 4\",\"Location: Katerina\\u0012s Cafi <br> DayDate: Fri 2014-01-17 <br> No.of visitors: 4\"],\"type\":\"bar\",\"name\":\"Katerina\\u0012s Cafi\",\"marker\":{\"color\":\"rgba(229,196,148,1)\",\"line\":{\"color\":\"rgba(229,196,148,1)\"}},\"textfont\":{\"color\":\"rgba(229,196,148,1)\"},\"error_y\":{\"color\":\"rgba(229,196,148,1)\"},\"error_x\":{\"color\":\"rgba(229,196,148,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"Tue 2014-01-07\",\"Wed 2014-01-08\",\"Tue 2014-01-14\"],\"y\":[4,4,4],\"hoverinfo\":[\"text\",\"text\",\"text\"],\"text\":[\"Location: Ouzeri Elian <br> DayDate: Tue 2014-01-07 <br> No.of visitors: 4\",\"Location: Ouzeri Elian <br> DayDate: Wed 2014-01-08 <br> No.of visitors: 4\",\"Location: Ouzeri Elian <br> DayDate: Tue 2014-01-14 <br> No.of visitors: 4\"],\"type\":\"bar\",\"name\":\"Ouzeri Elian\",\"marker\":{\"color\":\"rgba(179,179,179,1)\",\"line\":{\"color\":\"rgba(179,179,179,1)\"}},\"textfont\":{\"color\":\"rgba(179,179,179,1)\"},\"error_y\":{\"color\":\"rgba(179,179,179,1)\"},\"error_x\":{\"color\":\"rgba(179,179,179,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}\r\nNext, we will created a time-series chart to see the trends of visitations to the respective locations.\r\nOne more peculiar occurrence can be discovered from the chart below. Brew’s Been Served has 5 transactions consecutively for 3 days. However, after which no visits were recorded of Brew’ve been served for right anti join of more than or equal to 4 transactions.\r\n\r\n\r\n cc_anti_timeseries_right <- cc_loyalty_day_anti_right %>%\r\n  filter(count >= 4) %>%\r\n  plot_ly(x = ~date, y =~count, color = ~location, hoverinfo = \"text\",\r\n          text = ~paste(\"Location:\", location, \"<br>\",\"Date:\", date, \"<br>\", \"<br>\", \"Day:\", day)) %>%\r\n  add_lines() %>%\r\n  add_markers(showlegend = FALSE) %>%\r\n  layout(title = \"Most frequented places by groups of people\", xaxis = list(title = \"\", dtick = ~date, showgrid = FALSE), yaxis = list(title = \"Number of people\"))\r\n\r\ncc_anti_timeseries_right\r\n\r\n\r\n\r\n{\"x\":{\"visdat\":{\"4aec433e6988\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"4aec433e6988\",\"attrs\":{\"4aec433e6988\":{\"x\":{},\"y\":{},\"hoverinfo\":\"text\",\"text\":{},\"color\":{},\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"scatter\",\"mode\":\"lines\",\"inherit\":true},\"4aec433e6988.1\":{\"x\":{},\"y\":{},\"hoverinfo\":\"text\",\"text\":{},\"color\":{},\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"scatter\",\"mode\":\"markers\",\"showlegend\":false,\"inherit\":true}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":\"Most frequented places by groups of people\",\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"\",\"dtick\":[\"2014-01-09\",\"2014-01-08\",\"2014-01-09\",\"2014-01-10\",\"2014-01-15\",\"2014-01-10\",\"2014-01-13\",\"2014-01-14\",\"2014-01-16\",\"2014-01-13\",\"2014-01-17\",\"2014-01-07\",\"2014-01-07\",\"2014-01-13\",\"2014-01-15\",\"2014-01-17\",\"2014-01-14\",\"2014-01-07\",\"2014-01-15\",\"2014-01-17\",\"2014-01-07\",\"2014-01-08\",\"2014-01-14\"],\"showgrid\":false},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Number of people\"},\"hovermode\":\"closest\",\"showlegend\":true},\"source\":\"A\",\"config\":{\"showSendToCloud\":false},\"data\":[{\"x\":[\"2014-01-13\",\"2014-01-17\"],\"y\":[4,4],\"hoverinfo\":[\"text\",\"text\"],\"text\":[\"Location: Abila Zacharo <br> Date: 2014-01-13 <br> <br> Day: Mon\",\"Location: Abila Zacharo <br> Date: 2014-01-17 <br> <br> Day: Fri\"],\"type\":\"scatter\",\"mode\":\"lines\",\"name\":\"Abila Zacharo\",\"marker\":{\"color\":\"rgba(102,194,165,1)\",\"line\":{\"color\":\"rgba(102,194,165,1)\"}},\"textfont\":{\"color\":\"rgba(102,194,165,1)\"},\"error_y\":{\"color\":\"rgba(102,194,165,1)\"},\"error_x\":{\"color\":\"rgba(102,194,165,1)\"},\"line\":{\"color\":\"rgba(102,194,165,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-08\",\"2014-01-09\",\"2014-01-10\"],\"y\":[5,5,5],\"hoverinfo\":[\"text\",\"text\",\"text\"],\"text\":[\"Location: Brew've Been Served <br> Date: 2014-01-08 <br> <br> Day: Wed\",\"Location: Brew've Been Served <br> Date: 2014-01-09 <br> <br> Day: Thu\",\"Location: Brew've Been Served <br> Date: 2014-01-10 <br> <br> Day: Fri\"],\"type\":\"scatter\",\"mode\":\"lines\",\"name\":\"Brew've Been Served\",\"marker\":{\"color\":\"rgba(252,141,98,1)\",\"line\":{\"color\":\"rgba(252,141,98,1)\"}},\"textfont\":{\"color\":\"rgba(252,141,98,1)\"},\"error_y\":{\"color\":\"rgba(252,141,98,1)\"},\"error_x\":{\"color\":\"rgba(252,141,98,1)\"},\"line\":{\"color\":\"rgba(252,141,98,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-07\",\"2014-01-15\"],\"y\":[4,5],\"hoverinfo\":[\"text\",\"text\"],\"text\":[\"Location: Guy's Gyros <br> Date: 2014-01-07 <br> <br> Day: Tue\",\"Location: Guy's Gyros <br> Date: 2014-01-15 <br> <br> Day: Wed\"],\"type\":\"scatter\",\"mode\":\"lines\",\"name\":\"Guy's Gyros\",\"marker\":{\"color\":\"rgba(141,160,203,1)\",\"line\":{\"color\":\"rgba(141,160,203,1)\"}},\"textfont\":{\"color\":\"rgba(141,160,203,1)\"},\"error_y\":{\"color\":\"rgba(141,160,203,1)\"},\"error_x\":{\"color\":\"rgba(141,160,203,1)\"},\"line\":{\"color\":\"rgba(141,160,203,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-09\"],\"y\":[6],\"hoverinfo\":\"text\",\"text\":\"Location: Hallowed Grounds <br> Date: 2014-01-09 <br> <br> Day: Thu\",\"type\":\"scatter\",\"mode\":\"lines\",\"name\":\"Hallowed Grounds\",\"marker\":{\"color\":\"rgba(231,138,195,1)\",\"line\":{\"color\":\"rgba(231,138,195,1)\"}},\"textfont\":{\"color\":\"rgba(231,138,195,1)\"},\"error_y\":{\"color\":\"rgba(231,138,195,1)\"},\"error_x\":{\"color\":\"rgba(231,138,195,1)\"},\"line\":{\"color\":\"rgba(231,138,195,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-07\",\"2014-01-10\",\"2014-01-13\",\"2014-01-15\",\"2014-01-17\"],\"y\":[4,5,4,4,4],\"hoverinfo\":[\"text\",\"text\",\"text\",\"text\",\"text\"],\"text\":[\"Location: Hippokampos <br> Date: 2014-01-07 <br> <br> Day: Tue\",\"Location: Hippokampos <br> Date: 2014-01-10 <br> <br> Day: Fri\",\"Location: Hippokampos <br> Date: 2014-01-13 <br> <br> Day: Mon\",\"Location: Hippokampos <br> Date: 2014-01-15 <br> <br> Day: Wed\",\"Location: Hippokampos <br> Date: 2014-01-17 <br> <br> Day: Fri\"],\"type\":\"scatter\",\"mode\":\"lines\",\"name\":\"Hippokampos\",\"marker\":{\"color\":\"rgba(166,216,84,1)\",\"line\":{\"color\":\"rgba(166,216,84,1)\"}},\"textfont\":{\"color\":\"rgba(166,216,84,1)\"},\"error_y\":{\"color\":\"rgba(166,216,84,1)\"},\"error_x\":{\"color\":\"rgba(166,216,84,1)\"},\"line\":{\"color\":\"rgba(166,216,84,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-14\"],\"y\":[4],\"hoverinfo\":\"text\",\"text\":\"Location: Jack's Magical Beans <br> Date: 2014-01-14 <br> <br> Day: Tue\",\"type\":\"scatter\",\"mode\":\"lines\",\"name\":\"Jack's Magical Beans\",\"marker\":{\"color\":\"rgba(255,217,47,1)\",\"line\":{\"color\":\"rgba(255,217,47,1)\"}},\"textfont\":{\"color\":\"rgba(255,217,47,1)\"},\"error_y\":{\"color\":\"rgba(255,217,47,1)\"},\"error_x\":{\"color\":\"rgba(255,217,47,1)\"},\"line\":{\"color\":\"rgba(255,217,47,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-07\",\"2014-01-13\",\"2014-01-14\",\"2014-01-15\",\"2014-01-16\",\"2014-01-17\"],\"y\":[4,5,5,4,5,4],\"hoverinfo\":[\"text\",\"text\",\"text\",\"text\",\"text\",\"text\"],\"text\":[\"Location: Katerina\\u0012s Cafi <br> Date: 2014-01-07 <br> <br> Day: Tue\",\"Location: Katerina\\u0012s Cafi <br> Date: 2014-01-13 <br> <br> Day: Mon\",\"Location: Katerina\\u0012s Cafi <br> Date: 2014-01-14 <br> <br> Day: Tue\",\"Location: Katerina\\u0012s Cafi <br> Date: 2014-01-15 <br> <br> Day: Wed\",\"Location: Katerina\\u0012s Cafi <br> Date: 2014-01-16 <br> <br> Day: Thu\",\"Location: Katerina\\u0012s Cafi <br> Date: 2014-01-17 <br> <br> Day: Fri\"],\"type\":\"scatter\",\"mode\":\"lines\",\"name\":\"Katerina\\u0012s Cafi\",\"marker\":{\"color\":\"rgba(229,196,148,1)\",\"line\":{\"color\":\"rgba(229,196,148,1)\"}},\"textfont\":{\"color\":\"rgba(229,196,148,1)\"},\"error_y\":{\"color\":\"rgba(229,196,148,1)\"},\"error_x\":{\"color\":\"rgba(229,196,148,1)\"},\"line\":{\"color\":\"rgba(229,196,148,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-07\",\"2014-01-08\",\"2014-01-14\"],\"y\":[4,4,4],\"hoverinfo\":[\"text\",\"text\",\"text\"],\"text\":[\"Location: Ouzeri Elian <br> Date: 2014-01-07 <br> <br> Day: Tue\",\"Location: Ouzeri Elian <br> Date: 2014-01-08 <br> <br> Day: Wed\",\"Location: Ouzeri Elian <br> Date: 2014-01-14 <br> <br> Day: Tue\"],\"type\":\"scatter\",\"mode\":\"lines\",\"name\":\"Ouzeri Elian\",\"marker\":{\"color\":\"rgba(179,179,179,1)\",\"line\":{\"color\":\"rgba(179,179,179,1)\"}},\"textfont\":{\"color\":\"rgba(179,179,179,1)\"},\"error_y\":{\"color\":\"rgba(179,179,179,1)\"},\"error_x\":{\"color\":\"rgba(179,179,179,1)\"},\"line\":{\"color\":\"rgba(179,179,179,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-13\",\"2014-01-17\"],\"y\":[4,4],\"hoverinfo\":[\"text\",\"text\"],\"text\":[\"Location: Abila Zacharo <br> Date: 2014-01-13 <br> <br> Day: Mon\",\"Location: Abila Zacharo <br> Date: 2014-01-17 <br> <br> Day: Fri\"],\"type\":\"scatter\",\"mode\":\"markers\",\"showlegend\":false,\"name\":\"Abila Zacharo\",\"marker\":{\"color\":\"rgba(102,194,165,1)\",\"line\":{\"color\":\"rgba(102,194,165,1)\"}},\"textfont\":{\"color\":\"rgba(102,194,165,1)\"},\"error_y\":{\"color\":\"rgba(102,194,165,1)\"},\"error_x\":{\"color\":\"rgba(102,194,165,1)\"},\"line\":{\"color\":\"rgba(102,194,165,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-08\",\"2014-01-09\",\"2014-01-10\"],\"y\":[5,5,5],\"hoverinfo\":[\"text\",\"text\",\"text\"],\"text\":[\"Location: Brew've Been Served <br> Date: 2014-01-08 <br> <br> Day: Wed\",\"Location: Brew've Been Served <br> Date: 2014-01-09 <br> <br> Day: Thu\",\"Location: Brew've Been Served <br> Date: 2014-01-10 <br> <br> Day: Fri\"],\"type\":\"scatter\",\"mode\":\"markers\",\"showlegend\":false,\"name\":\"Brew've Been Served\",\"marker\":{\"color\":\"rgba(252,141,98,1)\",\"line\":{\"color\":\"rgba(252,141,98,1)\"}},\"textfont\":{\"color\":\"rgba(252,141,98,1)\"},\"error_y\":{\"color\":\"rgba(252,141,98,1)\"},\"error_x\":{\"color\":\"rgba(252,141,98,1)\"},\"line\":{\"color\":\"rgba(252,141,98,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-15\",\"2014-01-07\"],\"y\":[5,4],\"hoverinfo\":[\"text\",\"text\"],\"text\":[\"Location: Guy's Gyros <br> Date: 2014-01-15 <br> <br> Day: Wed\",\"Location: Guy's Gyros <br> Date: 2014-01-07 <br> <br> Day: Tue\"],\"type\":\"scatter\",\"mode\":\"markers\",\"showlegend\":false,\"name\":\"Guy's Gyros\",\"marker\":{\"color\":\"rgba(141,160,203,1)\",\"line\":{\"color\":\"rgba(141,160,203,1)\"}},\"textfont\":{\"color\":\"rgba(141,160,203,1)\"},\"error_y\":{\"color\":\"rgba(141,160,203,1)\"},\"error_x\":{\"color\":\"rgba(141,160,203,1)\"},\"line\":{\"color\":\"rgba(141,160,203,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-09\"],\"y\":[6],\"hoverinfo\":\"text\",\"text\":\"Location: Hallowed Grounds <br> Date: 2014-01-09 <br> <br> Day: Thu\",\"type\":\"scatter\",\"mode\":\"markers\",\"showlegend\":false,\"name\":\"Hallowed Grounds\",\"marker\":{\"color\":\"rgba(231,138,195,1)\",\"line\":{\"color\":\"rgba(231,138,195,1)\"}},\"textfont\":{\"color\":\"rgba(231,138,195,1)\"},\"error_y\":{\"color\":\"rgba(231,138,195,1)\"},\"error_x\":{\"color\":\"rgba(231,138,195,1)\"},\"line\":{\"color\":\"rgba(231,138,195,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-10\",\"2014-01-07\",\"2014-01-13\",\"2014-01-15\",\"2014-01-17\"],\"y\":[5,4,4,4,4],\"hoverinfo\":[\"text\",\"text\",\"text\",\"text\",\"text\"],\"text\":[\"Location: Hippokampos <br> Date: 2014-01-10 <br> <br> Day: Fri\",\"Location: Hippokampos <br> Date: 2014-01-07 <br> <br> Day: Tue\",\"Location: Hippokampos <br> Date: 2014-01-13 <br> <br> Day: Mon\",\"Location: Hippokampos <br> Date: 2014-01-15 <br> <br> Day: Wed\",\"Location: Hippokampos <br> Date: 2014-01-17 <br> <br> Day: Fri\"],\"type\":\"scatter\",\"mode\":\"markers\",\"showlegend\":false,\"name\":\"Hippokampos\",\"marker\":{\"color\":\"rgba(166,216,84,1)\",\"line\":{\"color\":\"rgba(166,216,84,1)\"}},\"textfont\":{\"color\":\"rgba(166,216,84,1)\"},\"error_y\":{\"color\":\"rgba(166,216,84,1)\"},\"error_x\":{\"color\":\"rgba(166,216,84,1)\"},\"line\":{\"color\":\"rgba(166,216,84,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-14\"],\"y\":[4],\"hoverinfo\":\"text\",\"text\":\"Location: Jack's Magical Beans <br> Date: 2014-01-14 <br> <br> Day: Tue\",\"type\":\"scatter\",\"mode\":\"markers\",\"showlegend\":false,\"name\":\"Jack's Magical Beans\",\"marker\":{\"color\":\"rgba(255,217,47,1)\",\"line\":{\"color\":\"rgba(255,217,47,1)\"}},\"textfont\":{\"color\":\"rgba(255,217,47,1)\"},\"error_y\":{\"color\":\"rgba(255,217,47,1)\"},\"error_x\":{\"color\":\"rgba(255,217,47,1)\"},\"line\":{\"color\":\"rgba(255,217,47,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-13\",\"2014-01-14\",\"2014-01-16\",\"2014-01-07\",\"2014-01-15\",\"2014-01-17\"],\"y\":[5,5,5,4,4,4],\"hoverinfo\":[\"text\",\"text\",\"text\",\"text\",\"text\",\"text\"],\"text\":[\"Location: Katerina\\u0012s Cafi <br> Date: 2014-01-13 <br> <br> Day: Mon\",\"Location: Katerina\\u0012s Cafi <br> Date: 2014-01-14 <br> <br> Day: Tue\",\"Location: Katerina\\u0012s Cafi <br> Date: 2014-01-16 <br> <br> Day: Thu\",\"Location: Katerina\\u0012s Cafi <br> Date: 2014-01-07 <br> <br> Day: Tue\",\"Location: Katerina\\u0012s Cafi <br> Date: 2014-01-15 <br> <br> Day: Wed\",\"Location: Katerina\\u0012s Cafi <br> Date: 2014-01-17 <br> <br> Day: Fri\"],\"type\":\"scatter\",\"mode\":\"markers\",\"showlegend\":false,\"name\":\"Katerina\\u0012s Cafi\",\"marker\":{\"color\":\"rgba(229,196,148,1)\",\"line\":{\"color\":\"rgba(229,196,148,1)\"}},\"textfont\":{\"color\":\"rgba(229,196,148,1)\"},\"error_y\":{\"color\":\"rgba(229,196,148,1)\"},\"error_x\":{\"color\":\"rgba(229,196,148,1)\"},\"line\":{\"color\":\"rgba(229,196,148,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2014-01-07\",\"2014-01-08\",\"2014-01-14\"],\"y\":[4,4,4],\"hoverinfo\":[\"text\",\"text\",\"text\"],\"text\":[\"Location: Ouzeri Elian <br> Date: 2014-01-07 <br> <br> Day: Tue\",\"Location: Ouzeri Elian <br> Date: 2014-01-08 <br> <br> Day: Wed\",\"Location: Ouzeri Elian <br> Date: 2014-01-14 <br> <br> Day: Tue\"],\"type\":\"scatter\",\"mode\":\"markers\",\"showlegend\":false,\"name\":\"Ouzeri Elian\",\"marker\":{\"color\":\"rgba(179,179,179,1)\",\"line\":{\"color\":\"rgba(179,179,179,1)\"}},\"textfont\":{\"color\":\"rgba(179,179,179,1)\"},\"error_y\":{\"color\":\"rgba(179,179,179,1)\"},\"error_x\":{\"color\":\"rgba(179,179,179,1)\"},\"line\":{\"color\":\"rgba(179,179,179,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}\r\nNext, we will create a facet grid of all the three joined dataset to analyse everything at one go. To create a facet grid, we will use the subplot function based on the plotly package to create three chart side by side for analysis.\r\n\r\n\r\nsubplot(cc_join, cc_anti, cc_anti_right, nrows = 1, shareX = TRUE, shareY = TRUE)\r\n\r\n\r\n\r\n{\"x\":{\"data\":[{\"x\":[\"Abila Airport\",\"Abila Scrapyard\",\"Abila Zacharo\",\"Ahaggo Museum\",\"Albert's Fine Clothing\",\"Bean There Done That\",\"Brew've Been Served\",\"Brewed Awakenings\",\"Carlyle Chemical Inc.\",\"Chostus Hotel\",\"Coffee Cameleon\",\"Coffee Shack\",\"Desafio Golf Course\",\"Frank's Fuel\",\"Frydos Autosupply n' More\",\"Gelatogalore\",\"General Grocer\",\"Guy's Gyros\",\"Hallowed Grounds\",\"Hippokampos\",\"Jack's Magical Beans\",\"Kalami Kafenion\",\"Katerina\\u0012s Cafi\",\"Kronos Pipe and Irrigation\",\"Maximum Iron and Steel\",\"Nationwide Refinery\",\"Octavio's Office Supplies\",\"Ouzeri Elian\",\"Roberts and Sons\",\"Shoppers' Delight\",\"Stewart and Sons Fabrication\",\"U-Pump\"],\"y\":[20,4,52,5,24,36,111,21,16,6,28,7,7,2,34,48,8,121,60,117,25,53,155,5,6,19,3,62,4,15,12,1],\"marker\":{\"color\":[20,4,52,5,24,36,111,21,16,6,28,7,7,2,34,48,8,121,60,117,25,53,155,5,6,19,3,62,4,15,12,1],\"line\":{\"color\":\"rgba(31,119,180,1)\"}},\"type\":\"bar\",\"name\":\"inner-join\",\"error_y\":{\"color\":\"rgba(31,119,180,1)\"},\"error_x\":{\"color\":\"rgba(31,119,180,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"Abila Airport\",\"Abila Zacharo\",\"Ahaggo Museum\",\"Albert's Fine Clothing\",\"Bean There Done That\",\"Brew've Been Served\",\"Brewed Awakenings\",\"Carlyle Chemical Inc.\",\"Chostus Hotel\",\"Coffee Cameleon\",\"Coffee Shack\",\"Daily Dealz\",\"Desafio Golf Course\",\"Frydos Autosupply n' More\",\"Gelatogalore\",\"General Grocer\",\"Guy's Gyros\",\"Hallowed Grounds\",\"Hippokampos\",\"Jack's Magical Beans\",\"Kalami Kafenion\",\"Katerina\\u0012s Cafi\",\"Kronos Mart\",\"Kronos Pipe and Irrigation\",\"Nationwide Refinery\",\"Octavio's Office Supplies\",\"Ouzeri Elian\",\"Roberts and Sons\",\"Shoppers' Delight\",\"Stewart and Sons Fabrication\",\"U-Pump\"],\"y\":[5,20,1,1,11,45,9,3,3,10,1,1,1,13,16,2,39,32,56,12,11,59,10,1,5,1,25,4,5,6,1],\"marker\":{\"color\":[5,20,1,1,11,45,9,3,3,10,1,1,1,13,16,2,39,32,56,12,11,59,10,1,5,1,25,4,5,6,1],\"line\":{\"color\":\"rgba(255,127,14,1)\"}},\"type\":\"bar\",\"name\":\"anti-join\",\"error_y\":{\"color\":\"rgba(255,127,14,1)\"},\"error_x\":{\"color\":\"rgba(255,127,14,1)\"},\"xaxis\":\"x2\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"Abila Airport\",\"Abila Zacharo\",\"Ahaggo Museum\",\"Albert's Fine Clothing\",\"Bean There Done That\",\"Brew've Been Served\",\"Brewed Awakenings\",\"Carlyle Chemical Inc.\",\"Chostus Hotel\",\"Coffee Cameleon\",\"Coffee Shack\",\"Desafio Golf Course\",\"Frydos Autosupply n' More\",\"Gelatogalore\",\"General Grocer\",\"Guy's Gyros\",\"Hallowed Grounds\",\"Hippokampos\",\"Jack's Magical Beans\",\"Kalami Kafenion\",\"Katerina\\u0012s Cafi\",\"Kronos Mart\",\"Kronos Pipe and Irrigation\",\"Nationwide Refinery\",\"Ouzeri Elian\",\"Roberts and Sons\",\"Shoppers' Delight\",\"Stewart and Sons Fabrication\"],\"y\":[6,19,1,1,9,29,8,3,2,9,2,1,8,12,4,27,20,40,10,13,42,8,1,4,22,2,3,5],\"marker\":{\"color\":[6,19,1,1,9,29,8,3,2,9,2,1,8,12,4,27,20,40,10,13,42,8,1,4,22,2,3,5],\"line\":{\"color\":\"rgba(44,160,44,1)\"}},\"type\":\"bar\",\"name\":\"anti-join-right\",\"error_y\":{\"color\":\"rgba(44,160,44,1)\"},\"error_x\":{\"color\":\"rgba(44,160,44,1)\"},\"xaxis\":\"x3\",\"yaxis\":\"y\",\"frame\":null}],\"layout\":{\"xaxis\":{\"domain\":[0,0.313333333333333],\"automargin\":true,\"title\":\"\",\"type\":\"category\",\"categoryorder\":\"array\",\"categoryarray\":[\"Katerina\\u0012s Cafi\",\"Guy's Gyros\",\"Hippokampos\",\"Brew've Been Served\",\"Ouzeri Elian\",\"Hallowed Grounds\",\"Kalami Kafenion\",\"Abila Zacharo\",\"Gelatogalore\",\"Bean There Done That\",\"Frydos Autosupply n' More\",\"Coffee Cameleon\",\"Jack's Magical Beans\",\"Albert's Fine Clothing\",\"Brewed Awakenings\",\"Abila Airport\",\"Nationwide Refinery\",\"Carlyle Chemical Inc.\",\"Shoppers' Delight\",\"Stewart and Sons Fabrication\",\"General Grocer\",\"Coffee Shack\",\"Desafio Golf Course\",\"Chostus Hotel\",\"Maximum Iron and Steel\",\"Ahaggo Museum\",\"Kronos Pipe and Irrigation\",\"Abila Scrapyard\",\"Roberts and Sons\",\"Octavio's Office Supplies\",\"Frank's Fuel\",\"U-Pump\"],\"anchor\":\"y\"},\"xaxis2\":{\"domain\":[0.353333333333333,0.646666666666667],\"automargin\":true,\"title\":\"\",\"type\":\"category\",\"categoryorder\":\"array\",\"categoryarray\":[\"Katerina\\u0012s Cafi\",\"Hippokampos\",\"Brew've Been Served\",\"Guy's Gyros\",\"Hallowed Grounds\",\"Ouzeri Elian\",\"Abila Zacharo\",\"Gelatogalore\",\"Frydos Autosupply n' More\",\"Jack's Magical Beans\",\"Bean There Done That\",\"Kalami Kafenion\",\"Coffee Cameleon\",\"Kronos Mart\",\"Brewed Awakenings\",\"Stewart and Sons Fabrication\",\"Abila Airport\",\"Nationwide Refinery\",\"Shoppers' Delight\",\"Roberts and Sons\",\"Carlyle Chemical Inc.\",\"Chostus Hotel\",\"General Grocer\",\"Ahaggo Museum\",\"Albert's Fine Clothing\",\"Coffee Shack\",\"Daily Dealz\",\"Desafio Golf Course\",\"Kronos Pipe and Irrigation\",\"Octavio's Office Supplies\",\"U-Pump\"],\"anchor\":\"y\"},\"xaxis3\":{\"domain\":[0.686666666666667,1],\"automargin\":true,\"title\":\"\",\"type\":\"category\",\"categoryorder\":\"array\",\"categoryarray\":[\"Katerina\\u0012s Cafi\",\"Hippokampos\",\"Brew've Been Served\",\"Guy's Gyros\",\"Ouzeri Elian\",\"Hallowed Grounds\",\"Abila Zacharo\",\"Kalami Kafenion\",\"Gelatogalore\",\"Jack's Magical Beans\",\"Bean There Done That\",\"Coffee Cameleon\",\"Brewed Awakenings\",\"Frydos Autosupply n' More\",\"Kronos Mart\",\"Abila Airport\",\"Stewart and Sons Fabrication\",\"General Grocer\",\"Nationwide Refinery\",\"Carlyle Chemical Inc.\",\"Shoppers' Delight\",\"Chostus Hotel\",\"Coffee Shack\",\"Roberts and Sons\",\"Ahaggo Museum\",\"Albert's Fine Clothing\",\"Desafio Golf Course\",\"Kronos Pipe and Irrigation\"],\"anchor\":\"y\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Number of visitors\",\"anchor\":\"x\"},\"annotations\":[],\"shapes\":[],\"images\":[],\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":\"Total number of visitation by area\",\"hovermode\":\"closest\",\"showlegend\":true},\"attrs\":{\"4aec356e5715\":{\"x\":{},\"y\":{},\"marker\":{\"color\":{}},\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"bar\",\"name\":\"inner-join\",\"inherit\":true},\"4aec702b449d\":{\"x\":{},\"y\":{},\"marker\":{\"color\":{}},\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"bar\",\"name\":\"anti-join\",\"inherit\":true},\"4aec43182509\":{\"x\":{},\"y\":{},\"marker\":{\"color\":{}},\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"bar\",\"name\":\"anti-join-right\",\"inherit\":true}},\"source\":\"A\",\"config\":{\"showSendToCloud\":false},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"subplot\":true,\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}\r\nLastly, we will the cc_loyalty_join dataset with itself by “last4ccnum”,“location”,“price”, “time”, “date” and filter by different loyaltynum. The cc_loyalty dataset is the initial inner join dataset.\r\nBased on the below tibble. We can see that there are 12 instances where there are 6 cc users using different loyaltynum. This is another anomaly that has been found.\r\n\r\n\r\ncc_loyalty_join %>% \r\n  inner_join(cc_loyalty_join, by = c(\"last4ccnum\", \"location\", \"price\",\"time\", \"date\")) %>%\r\n  filter(loyaltynum.x != loyaltynum.y)\r\n\r\n\r\n# A tibble: 12 x 11\r\n   timestamp.x         location      price last4ccnum day.x date      \r\n   <dttm>              <chr>         <dbl> <fct>      <ord> <date>    \r\n 1 2014-01-09 19:30:00 \"Katerina\\u0~ 26.6  5921       Thu   2014-01-09\r\n 2 2014-01-09 19:30:00 \"Katerina\\u0~ 26.6  5921       Thu   2014-01-09\r\n 3 2014-01-09 20:06:00 \"Katerina\\u0~ 26.6  4948       Thu   2014-01-09\r\n 4 2014-01-09 20:06:00 \"Katerina\\u0~ 26.6  4948       Thu   2014-01-09\r\n 5 2014-01-09 20:23:00 \"Guy's Gyros\"  8.23 7889       Thu   2014-01-09\r\n 6 2014-01-09 20:23:00 \"Guy's Gyros\"  8.23 7889       Thu   2014-01-09\r\n 7 2014-01-09 20:38:00 \"Guy's Gyros\"  8.23 5368       Thu   2014-01-09\r\n 8 2014-01-09 20:38:00 \"Guy's Gyros\"  8.23 5368       Thu   2014-01-09\r\n 9 2014-01-11 19:29:00 \"Hippokampos\" 63.2  4795       Sat   2014-01-11\r\n10 2014-01-11 19:29:00 \"Hippokampos\" 63.2  4795       Sat   2014-01-11\r\n11 2014-01-11 19:45:00 \"Hippokampos\" 63.2  8332       Sat   2014-01-11\r\n12 2014-01-11 19:45:00 \"Hippokampos\" 63.2  8332       Sat   2014-01-11\r\n# ... with 5 more variables: time <chr>, loyaltynum.x <fct>,\r\n#   timestamp.y <dttm>, day.y <ord>, loyaltynum.y <fct>\r\n\r\n\r\n\r\n\r\n",
    "preview": {},
    "last_modified": "2021-07-27T13:13:01+08:00",
    "input_file": "vastchallengepart2.knit.md"
  }
]
