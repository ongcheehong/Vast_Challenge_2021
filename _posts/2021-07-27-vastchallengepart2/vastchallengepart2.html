<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Vast Challenge Part 2</title>

  <meta property="description" itemprop="description" content="Welcome to Ong Chee Hong&#39;s Vast Challenge 2021 Assignment"/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2021-07-27"/>
  <meta property="article:created" itemprop="dateCreated" content="2021-07-27"/>
  <meta name="article:author" content="Ong Chee Hong"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Vast Challenge Part 2"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Welcome to Ong Chee Hong&#39;s Vast Challenge 2021 Assignment"/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Vast Challenge Part 2"/>
  <meta property="twitter:description" content="Welcome to Ong Chee Hong&#39;s Vast Challenge 2021 Assignment"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["Vast Challenge Part 2"]},{"type":"character","attributes":{},"value":["Welcome to Ong Chee Hong's Vast Challenge 2021 Assignment"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Ong Chee Hong"]},{"type":"character","attributes":{},"value":["https://www.linkedin.com/in/alexongch/"]}]}]},{"type":"character","attributes":{},"value":["07-27-2021"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[false]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["data/MC2/~$2_data_readme.docx","data/MC2/AnswerSheet/VAST Challenge 2021 MC2 Answer Sheet.htm","data/MC2/AnswerSheet/VAST Challenge 2021 MC2 Answer Sheet_files/colorschememapping.xml","data/MC2/AnswerSheet/VAST Challenge 2021 MC2 Answer Sheet_files/filelist.xml","data/MC2/AnswerSheet/VAST Challenge 2021 MC2 Answer Sheet_files/themedata.thmx","data/MC2/car-assignments.csv","data/MC2/cc_data.csv","data/MC2/Geospatial/Abila.dbf","data/MC2/Geospatial/Abila.kml","data/MC2/Geospatial/Abila.prj","data/MC2/Geospatial/Abila.sbn","data/MC2/Geospatial/Abila.sbx","data/MC2/Geospatial/Abila.shp","data/MC2/Geospatial/Abila.shx","data/MC2/Geospatial/Kronos Island.kmz","data/MC2/Geospatial/Kronos_Island.dbf","data/MC2/Geospatial/Kronos_Island.prj","data/MC2/Geospatial/Kronos_Island.sbn","data/MC2/Geospatial/Kronos_Island.sbx","data/MC2/Geospatial/Kronos_Island.shp","data/MC2/Geospatial/Kronos_Island.shx","data/MC2/Geospatial/MC2-tourist_modified.tif","data/MC2/Geospatial/MC2-tourist_modified.tif.points","data/MC2/gps.csv","data/MC2/loyalty_data.csv","data/MC2/MC2-tourist.jpg","data/MC2/MC2-tourist_modified.tif","data/MC2/MC2-tourist_modified.tif.points","data/MC2/MC2_data_readme.docx","img/101_106_107.png","img/107 data.png","img/107 map.png","img/14 network.png","img/16.png","img/17 data.png","img/17 map.png","img/17 network.png","img/18 network.png","img/18.png","img/21 map.png","img/21.png","img/24.png","img/26 canero street.png","img/26 network.png","img/5.png","img/8 data.png","img/8 map.png","img/8 network 2.png","img/8 network.png","img/bar chart.PNG","img/bar.png","img/day 10.png","img/Density plot.jpg","img/geo.PNG","img/katerine.png","img/line chart.PNG","img/localization.png","img/map tif.png","img/MC2-tourist.jpg","img/network.PNG","img/Ouzeri Elian.png","img/uturn.png"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="vastchallengepart2_files/header-attrs/header-attrs.js"></script>
  <script src="vastchallengepart2_files/htmlwidgets/htmlwidgets.js"></script>
  <script src="vastchallengepart2_files/plotly-binding/plotly.js"></script>
  <script src="vastchallengepart2_files/typedarray/typedarray.min.js"></script>
  <script src="vastchallengepart2_files/jquery/jquery.min.js"></script>
  <link href="vastchallengepart2_files/crosstalk/css/crosstalk.css" rel="stylesheet" />
  <script src="vastchallengepart2_files/crosstalk/js/crosstalk.min.js"></script>
  <link href="vastchallengepart2_files/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
  <script src="vastchallengepart2_files/plotly-main/plotly-latest.min.js"></script>
  <script src="vastchallengepart2_files/popper/popper.min.js"></script>
  <link href="vastchallengepart2_files/tippy/tippy.css" rel="stylesheet" />
  <link href="vastchallengepart2_files/tippy/tippy-light-border.css" rel="stylesheet" />
  <script src="vastchallengepart2_files/tippy/tippy.umd.min.js"></script>
  <script src="vastchallengepart2_files/anchor/anchor.min.js"></script>
  <script src="vastchallengepart2_files/bowser/bowser.min.js"></script>
  <script src="vastchallengepart2_files/webcomponents/webcomponents.js"></script>
  <script src="vastchallengepart2_files/distill/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Vast Challenge Part 2","description":"Welcome to Ong Chee Hong's Vast Challenge 2021 Assignment","authors":[{"author":"Ong Chee Hong","authorURL":"https://www.linkedin.com/in/alexongch/","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2021-07-27T00:00:00.000+08:00","citationText":"Hong, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Vast Challenge Part 2</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p>Welcome to Ong Chee Hongâ€™s Vast Challenge 2021 Assignment</p>
</div>

<div class="d-byline">
  Ong Chee Hong <a href="https://www.linkedin.com/in/alexongch/" class="uri">https://www.linkedin.com/in/alexongch/</a> 
  
<br/>07-27-2021
</div>

<div class="d-article">
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>packages</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'DT'</span>,<span class='st'>'ggiraph'</span>,<span class='st'>'plotly'</span>,<span class='st'>'tidyverse'</span>, <span class='st'>'raster'</span>,<span class='st'>'sf'</span>,<span class='st'>'clock'</span>,<span class='st'>'tmap'</span>,
             <span class='st'>'rgdal'</span>,<span class='st'>'dplyr'</span>, <span class='st'>'tidyr'</span>, <span class='st'>'textclean'</span>, <span class='st'>"plotly"</span>, <span class='st'>"forcats"</span>, <span class='st'>"jpeg"</span>, <span class='st'>"tiff"</span>,
             <span class='st'>"mapview"</span>,<span class='st'>"tidygraph"</span>,<span class='st'>"igraph"</span>,<span class='st'>"ggraph"</span>,<span class='st'>"visNetwork"</span>,<span class='st'>"leaflet"</span>,<span class='st'>"lubridate"</span><span class='op'>)</span>
<span class='kw'>for</span><span class='op'>(</span><span class='va'>p</span> <span class='kw'>in</span> <span class='va'>packages</span><span class='op'>)</span><span class='op'>{</span>
  <span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'>p</span>,character.only <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
    <span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span>
  <span class='op'>}</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>p</span>,character.only <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>car</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/mc2/car-assignments.csv"</span><span class='op'>)</span>
<span class='va'>cc</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/mc2/cc_data.csv"</span>, locale <span class='op'>=</span> <span class='fu'>locale</span><span class='op'>(</span>encoding <span class='op'>=</span> <span class='st'>"ASCII"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>gps</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/mc2/gps.csv"</span><span class='op'>)</span>
<span class='va'>loyalty</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/mc2/loyalty_data.csv"</span>,locale <span class='op'>=</span> <span class='fu'>locale</span><span class='op'>(</span>encoding <span class='op'>=</span> <span class='st'>"ASCII"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h1 id="data-preparation">2. Data preparation</h1>
<h2 id="customisation-of-code-chunks">2.1 Customisation of code chunks</h2>
<p>First, we will customize the all code chunks using the below knitr code. More information on chunk options can be found <a href="https://yihui.org/knitr/options/#animation">here</a></p>
<h2 id="installing-required-r-packages">2.2 Installing required R packages</h2>
<p>Next, we will install the required R packages. There are three basic groups of packages that we will install,</p>
<ol type="1">
<li><p>For data manipulation and preparation The <a href="https://www.tidyverse.org/"><em>tidyverse</em></a> package is a group of R packages including <a href="https://dplyr.tidyverse.org/"><em>dplyr</em></a>, <a href="https://tidyr.tidyverse.org/"><em>tidyr</em></a> that assist user to manipulate data.</p></li>
<li><p>Date and Time The two packages <a href="https://clock.r-lib.org/"><em>clock</em></a> and <a href="https://lubridate.tidyverse.org/"><em>lubridate</em></a> are used for the manipulation of date and time data</p></li>
<li><p>Interactive data analysis The two packages <a href="https://cran.rstudio.com/web/packages/ggiraph/ggiraph.pdf"><em>ggiraph</em></a> and <a href="https://plotly.com/r/"><em>plotly</em></a> are used to output data into interactive graphical/chart form for analysis.</p></li>
<li><p>GeoVisual Analysis The packages <a href="https://cran.r-project.org/web/packages/raster/raster.pdf"><em>raster</em></a>, <a href="https://r-spatial.github.io/sf/"><em>sf</em></a>,<a href="https://cran.r-project.org/web/packages/tmap/vignettes/tmap-getstarted.html"><em>tmap</em></a> and <a href="https://cran.r-project.org/web/packages/rgdal/index.html"><em>rgdal</em></a> are used for geospatial visual analytics where data are output to a map for analysis such as movement of people etc.</p></li>
<li><p>Network Analysis Lastly, to analyse the relationship between people etc. We will use the packages from <a href="https://www.data-imaginist.com/2017/introducing-tidygraph/"><em>tidygraph</em></a>, <a href="https://igraph.org/"><em>igraph</em></a>, <a href="https://www.data-imaginist.com/2017/ggraph-introduction-layouts/"><em>ggraph</em></a> and <a href="https://datastorm-open.github.io/visNetwork/#:~:text=visNetwork%20is%20an%20R%20package,%2Fdatastorm%2Dopen%2FvisNetwork."><em>visNetwork</em></a>. <em>visNetwork</em> is a package to output interactive network analysis.</p></li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>packages</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'DT'</span>,<span class='st'>'ggiraph'</span>,<span class='st'>'plotly'</span>,<span class='st'>'tidyverse'</span>, <span class='st'>'raster'</span>,<span class='st'>'sf'</span>,<span class='st'>'clock'</span>,<span class='st'>'tmap'</span>,
             <span class='st'>'rgdal'</span>,<span class='st'>'dplyr'</span>, <span class='st'>'tidyr'</span>, <span class='st'>'textclean'</span>, <span class='st'>"plotly"</span>, <span class='st'>"forcats"</span>, <span class='st'>"jpeg"</span>, <span class='st'>"tiff"</span>,
             <span class='st'>"mapview"</span>,<span class='st'>"tidygraph"</span>,<span class='st'>"igraph"</span>,<span class='st'>"ggraph"</span>,<span class='st'>"visNetwork"</span>,<span class='st'>"leaflet"</span>,<span class='st'>"lubridate"</span><span class='op'>)</span>
<span class='kw'>for</span><span class='op'>(</span><span class='va'>p</span> <span class='kw'>in</span> <span class='va'>packages</span><span class='op'>)</span><span class='op'>{</span>
  <span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'>p</span>,character.only <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
    <span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span>
  <span class='op'>}</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>p</span>,character.only <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<h2 id="provided-data-and-information">2.3 Provided data and information</h2>
<p>There are 3 different types of data &amp; information provided. A <em>geospatial dataset</em>, <em>csv files</em> and a <em>jpg file</em> consisting of the Abila tourist map.</p>
<p>Below is the information of all the data provided.</p>
<h3 id="a-csv-file-on-vehicle-assignments-to-employee-car-assignments.csv">2.3.1. A csv file on vehicle assignments to employee (car-assignments.csv)</h3>
<ol type="1">
<li><p>Employee Last Name</p></li>
<li><p>Employee First Name</p></li>
<li><p>Car ID (integer)</p></li>
<li><p>Current Employment Type (Department; categorical)</p></li>
<li><p>Current Employment Title (job title; categorical)</p></li>
</ol>
<h3 id="a-csv-file-of-vehicle-tracking-data-gps.csv">2.3.2. A CSV file of vehicle tracking data (gps.csv)</h3>
<p>3.1 Timestamp</p>
<p>3.2 Car ID (integer)</p>
<p>3.3 Latitude</p>
<p>3.4 Longitude</p>
<h3 id="a-csv-file-containing-loyalty-card-transaction-data-loyalty_data.csv">2.3.3. A CSV file containing loyalty card transaction data (loyalty_data.csv)</h3>
<p>4.1 Timestamp</p>
<p>4.2 Location (name of the business)</p>
<p>4.3 Price (real)</p>
<p>4.4 Loyalty Number (A 5-character code starting with L that is unique for each card)</p>
<h3 id="a-csv-file-containing-credit-and-debit-card-transaction-data-cc_data.csv">2.3.4. A CSV file containing credit and debit card transaction data (cc_data.csv)</h3>
<p>5.1 Timestamp</p>
<p>5.2 Location (name of the business)</p>
<p>5.3 Price (real)</p>
<p>5.4 Last 4 digits of the credit or debit card number</p>
<h3 id="esri-shapefiles-of-abila-in-the-geospatial-folder">2.3.5. ESRI shapefiles of Abila (in the Geospatial folder)</h3>
<h3 id="a-tourist-map-of-abila-with-locations-of-interest-identified-in-jpeg-format-mc2-tourist.jpg">2.3.6. A tourist map of Abila with locations of interest identified, in JPEG format (MC2-Tourist.jpg)</h3>
<h2 id="importing-of-data">2.4. Importing of data</h2>
<p>We will import the 4 different <em>csv</em> datasets that were provided</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>car</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/mc2/car-assignments.csv"</span><span class='op'>)</span>
<span class='va'>cc</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/mc2/cc_data.csv"</span><span class='op'>)</span>
<span class='va'>gps</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/mc2/gps.csv"</span><span class='op'>)</span>
<span class='va'>loyalty</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/mc2/loyalty_data.csv"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>If we take a look at the above datasets in excel, we will see that there are foreign characters in some of the datasets provided. An example is the Katerinaâ€™s Cafe as shown below. To address this, we will need to encode the dataset to allow rstudio to read properly.</p>
<p><img src="img/katerine.png" /></p>
<p>To allow use to know the encoding type for both cc and loyalty dataset. Guess encoding will be used to detect the encoding type as shown below..</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>guess_encoding</span><span class='op'>(</span><span class='va'>cc</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 1 x 2
  encoding confidence
  &lt;chr&gt;         &lt;dbl&gt;
1 ASCII             1</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>guess_encoding</span><span class='op'>(</span><span class='va'>loyalty</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 1 x 2
  encoding confidence
  &lt;chr&gt;         &lt;dbl&gt;
1 ASCII             1</code></pre>
</div>
<p>Next, we will add the code locale = locale(encoding = â€œASCIIâ€ on both cc and loyalty dataset)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>car</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/mc2/car-assignments.csv"</span><span class='op'>)</span>
<span class='va'>cc</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/mc2/cc_data.csv"</span>, locale <span class='op'>=</span> <span class='fu'>locale</span><span class='op'>(</span>encoding <span class='op'>=</span> <span class='st'>"ASCII"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>gps</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/mc2/gps.csv"</span><span class='op'>)</span>
<span class='va'>loyalty</span> <span class='op'>&lt;-</span> <span class='fu'>read_csv</span><span class='op'>(</span><span class='st'>"data/mc2/loyalty_data.csv"</span>,locale <span class='op'>=</span> <span class='fu'>locale</span><span class='op'>(</span>encoding <span class='op'>=</span> <span class='st'>"ASCII"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h2 id="data-examination">2.5. Data examination</h2>
<p>First, we will look at both cc and loyalty card dataset by using the <em>glimpse</em> function as shown below. There are 1490 rows and 1392 rows in both the cc and loyatly dataset respectfully. If we take look closely, we will see that these two datasets are closely linked by location, price and timestamp except the last4ccnum and loyaltynum are different.</p>
<p>If we take a look back at the MC2 background, we will observe that Kronos based companies are allowed to collect credit card and loyalty cards information on GAStech employees purchases as such these two datasets are similar in nature.</p>
<p>However, the rows for both cc and loyalty card data are different. This anomaly might have a few reasoning, 1) the employees did not used their credit cards while doing purchases but loyalty card was presented. 2) Vice versa, employees might also used their credit card but did not present their loyalty card during purchases.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>glimpse</span><span class='op'>(</span><span class='va'>cc</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Rows: 1,490
Columns: 4
$ timestamp  &lt;chr&gt; &quot;1/6/2014 7:28&quot;, &quot;1/6/2014 7:34&quot;, &quot;1/6/2014 7:35&quot;~
$ location   &lt;chr&gt; &quot;Brew&#39;ve Been Served&quot;, &quot;Hallowed Grounds&quot;, &quot;Brew&#39;~
$ price      &lt;dbl&gt; 11.34, 52.22, 8.33, 16.72, 4.24, 4.17, 28.73, 9.6~
$ last4ccnum &lt;dbl&gt; 4795, 7108, 6816, 9617, 7384, 5368, 7253, 4948, 9~</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>glimpse</span><span class='op'>(</span><span class='va'>loyalty</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Rows: 1,392
Columns: 4
$ timestamp  &lt;chr&gt; &quot;1/6/2014&quot;, &quot;1/6/2014&quot;, &quot;1/6/2014&quot;, &quot;1/6/2014&quot;, &quot;~
$ location   &lt;chr&gt; &quot;Brew&#39;ve Been Served&quot;, &quot;Brew&#39;ve Been Served&quot;, &quot;Ha~
$ price      &lt;dbl&gt; 4.17, 9.60, 16.53, 11.51, 12.93, 4.27, 11.20, 15.~
$ loyaltynum &lt;chr&gt; &quot;L2247&quot;, &quot;L9406&quot;, &quot;L8328&quot;, &quot;L6417&quot;, &quot;L1107&quot;, &quot;L40~</code></pre>
</div>
<p>Next, we will look at the vehicle datasets. The 44 rows car datasets are represented by the employee, employment information with their car assignment ID.</p>
<p>The gps datasets are based on the car movements in respect to their lat and long position with timestamp.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>glimpse</span><span class='op'>(</span><span class='va'>car</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Rows: 44
Columns: 5
$ LastName               &lt;chr&gt; &quot;Calixto&quot;, &quot;Azada&quot;, &quot;Balas&quot;, &quot;Barranc~
$ FirstName              &lt;chr&gt; &quot;Nils&quot;, &quot;Lars&quot;, &quot;Felix&quot;, &quot;Ingrid&quot;, &quot;I~
$ CarID                  &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12~
$ CurrentEmploymentType  &lt;chr&gt; &quot;Information Technology&quot;, &quot;Engineerin~
$ CurrentEmploymentTitle &lt;chr&gt; &quot;IT Helpdesk&quot;, &quot;Engineer&quot;, &quot;Engineer&quot;~</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>glimpse</span><span class='op'>(</span><span class='va'>gps</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Rows: 685,169
Columns: 4
$ Timestamp &lt;chr&gt; &quot;1/6/2014 6:28&quot;, &quot;1/6/2014 6:28&quot;, &quot;1/6/2014 6:28&quot;,~
$ id        &lt;dbl&gt; 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35~
$ lat       &lt;dbl&gt; 36.07623, 36.07622, 36.07621, 36.07622, 36.07621, ~
$ long      &lt;dbl&gt; 24.87469, 24.87460, 24.87444, 24.87425, 24.87417, ~</code></pre>
</div>
<h2 id="data-preparation-1">2.6. Data Preparation</h2>
<h3 id="cc-and-loyalty-dataset">2.6.1 CC and Loyalty dataset</h3>
<p>We will prepare the cc and loyalty datasets for data exploration later.</p>
<h3 id="changing-the-datatypes-of-last4ccnum-loyaltynum">2.6.1.1. Changing the datatypes of last4ccnum &amp; loyaltynum</h3>
<p>The last4ccnum of the cc datasets and the loyaltynum of the loyalty dataset should be a categorical data type. As such, we will change it by using the <em>as.factor</em> function.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cc</span><span class='op'>$</span><span class='va'>last4ccnum</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>cc</span><span class='op'>$</span><span class='va'>last4ccnum</span><span class='op'>)</span>
<span class='va'>loyalty</span><span class='op'>$</span><span class='va'>loyaltynum</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>loyalty</span><span class='op'>$</span><span class='va'>loyaltynum</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Next, we will modify the datatype for both the timestamp of cc and loyalty dataset using the <em>clock</em> package. If we observe below, the data_time_parse function is use to change the timestamp to <em>dttm</em> (datetime) format while the date_parse function is used to change the data to <em>date</em> format.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cc</span><span class='op'>$</span><span class='va'>timestamp</span> <span class='op'>&lt;-</span> <span class='fu'>date_time_parse</span><span class='op'>(</span><span class='va'>cc</span><span class='op'>$</span><span class='va'>timestamp</span>,
                                 zone <span class='op'>=</span> <span class='st'>""</span>,
                                 format <span class='op'>=</span> <span class='st'>"%m/%d/%Y %H:%M"</span><span class='op'>)</span>

<span class='va'>loyalty</span><span class='op'>$</span><span class='va'>timestamp</span> <span class='op'>&lt;-</span> <span class='fu'>date_parse</span><span class='op'>(</span><span class='va'>loyalty</span><span class='op'>$</span><span class='va'>timestamp</span>,
                                 format <span class='op'>=</span> <span class='st'>"%m/%d/%Y"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>We will double check the dataset to confirm that the datatype has been changed to the one we wanted.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>glimpse</span><span class='op'>(</span><span class='va'>cc</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Rows: 1,490
Columns: 4
$ timestamp  &lt;dttm&gt; 2014-01-06 07:28:00, 2014-01-06 07:34:00, 2014-0~
$ location   &lt;chr&gt; &quot;Brew&#39;ve Been Served&quot;, &quot;Hallowed Grounds&quot;, &quot;Brew&#39;~
$ price      &lt;dbl&gt; 11.34, 52.22, 8.33, 16.72, 4.24, 4.17, 28.73, 9.6~
$ last4ccnum &lt;fct&gt; 4795, 7108, 6816, 9617, 7384, 5368, 7253, 4948, 9~</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>glimpse</span><span class='op'>(</span><span class='va'>loyalty</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Rows: 1,392
Columns: 4
$ timestamp  &lt;date&gt; 2014-01-06, 2014-01-06, 2014-01-06, 2014-01-06, ~
$ location   &lt;chr&gt; &quot;Brew&#39;ve Been Served&quot;, &quot;Brew&#39;ve Been Served&quot;, &quot;Ha~
$ price      &lt;dbl&gt; 4.17, 9.60, 16.53, 11.51, 12.93, 4.27, 11.20, 15.~
$ loyaltynum &lt;fct&gt; L2247, L9406, L8328, L6417, L1107, L4034, L6110, ~</code></pre>
</div>
<h3 id="splitting-the-timestamp-data-into-individual-date-time-and-day-columns.">2.6.1.2 Splitting the timestamp data into individual date, time and day columns.</h3>
<p>To allow us to dive deeper into our analysis later, we will split the timestamp dataset into date, time and day columns. We will first add more columns by using the <em>mutate</em> function from dplyr to add day, date and time columns in the cc dataset and importing in to the <em>cc_dtsplit</em> object.</p>
<p>There is no need to add columns for the loyatly dataset as we will join both the datasets together in which day will be included in the joined dataset.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cc_dtsplit</span> <span class='op'>&lt;-</span> <span class='va'>cc</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>day <span class='op'>=</span> <span class='fu'>date_weekday_factor</span><span class='op'>(</span><span class='va'>cc</span><span class='op'>$</span><span class='va'>timestamp</span><span class='op'>)</span>, date <span class='op'>=</span>  <span class='fu'>as_date</span><span class='op'>(</span><span class='va'>cc</span><span class='op'>$</span><span class='va'>timestamp</span><span class='op'>)</span>, time <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span><span class='op'>(</span><span class='va'>cc</span><span class='op'>$</span><span class='va'>timestamp</span>, format <span class='op'>=</span> <span class='st'>"%H:%M"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>cc_dtsplit</span>
</code></pre>
</div>
<pre><code># A tibble: 1,490 x 7
   timestamp           location      price last4ccnum day   date      
   &lt;dttm&gt;              &lt;chr&gt;         &lt;dbl&gt; &lt;fct&gt;      &lt;ord&gt; &lt;date&gt;    
 1 2014-01-06 07:28:00 Brew&#39;ve Been~ 11.3  4795       Mon   2014-01-06
 2 2014-01-06 07:34:00 Hallowed Gro~ 52.2  7108       Mon   2014-01-06
 3 2014-01-06 07:35:00 Brew&#39;ve Been~  8.33 6816       Mon   2014-01-06
 4 2014-01-06 07:36:00 Hallowed Gro~ 16.7  9617       Mon   2014-01-06
 5 2014-01-06 07:37:00 Brew&#39;ve Been~  4.24 7384       Mon   2014-01-06
 6 2014-01-06 07:38:00 Brew&#39;ve Been~  4.17 5368       Mon   2014-01-06
 7 2014-01-06 07:42:00 Coffee Camel~ 28.7  7253       Mon   2014-01-06
 8 2014-01-06 07:43:00 Brew&#39;ve Been~  9.6  4948       Mon   2014-01-06
 9 2014-01-06 07:43:00 Brew&#39;ve Been~ 16.9  9683       Mon   2014-01-06
10 2014-01-06 07:47:00 Hallowed Gro~ 16.5  8129       Mon   2014-01-06
# ... with 1,480 more rows, and 1 more variable: time &lt;chr&gt;</code></pre>
</div>
<p>To allow us to join both datasets together, we will need to rename the timestamp column from the loyatly dataset to <em>date</em> so that both the date columns have the same name.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>loyalty_dt</span> <span class='op'>&lt;-</span> <span class='fu'>rename</span><span class='op'>(</span><span class='va'>loyalty</span>, date <span class='op'>=</span> <span class='va'>timestamp</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>We will take a look at our newly cleaned datasets to double check the changed we have made previously.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>glimpse</span><span class='op'>(</span><span class='va'>cc_dtsplit</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Rows: 1,490
Columns: 7
$ timestamp  &lt;dttm&gt; 2014-01-06 07:28:00, 2014-01-06 07:34:00, 2014-0~
$ location   &lt;chr&gt; &quot;Brew&#39;ve Been Served&quot;, &quot;Hallowed Grounds&quot;, &quot;Brew&#39;~
$ price      &lt;dbl&gt; 11.34, 52.22, 8.33, 16.72, 4.24, 4.17, 28.73, 9.6~
$ last4ccnum &lt;fct&gt; 4795, 7108, 6816, 9617, 7384, 5368, 7253, 4948, 9~
$ day        &lt;ord&gt; Mon, Mon, Mon, Mon, Mon, Mon, Mon, Mon, Mon, Mon,~
$ date       &lt;date&gt; 2014-01-06, 2014-01-06, 2014-01-06, 2014-01-06, ~
$ time       &lt;chr&gt; &quot;07:28&quot;, &quot;07:34&quot;, &quot;07:35&quot;, &quot;07:36&quot;, &quot;07:37&quot;, &quot;07:~</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>glimpse</span><span class='op'>(</span><span class='va'>loyalty_dt</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Rows: 1,392
Columns: 4
$ date       &lt;date&gt; 2014-01-06, 2014-01-06, 2014-01-06, 2014-01-06, ~
$ location   &lt;chr&gt; &quot;Brew&#39;ve Been Served&quot;, &quot;Brew&#39;ve Been Served&quot;, &quot;Ha~
$ price      &lt;dbl&gt; 4.17, 9.60, 16.53, 11.51, 12.93, 4.27, 11.20, 15.~
$ loyaltynum &lt;fct&gt; L2247, L9406, L8328, L6417, L1107, L4034, L6110, ~</code></pre>
</div>
<h3 id="changing-the-datatypes-of-car-gps">2.6.1.3. Changing the datatypes of car &amp; gps</h3>
<p>First, we will take a look at the car &amp; gps datasets. Notice that the CarID and id for both datasets are not of the correct categorical datatype. We will proceed to change both the two columns.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>glimpse</span><span class='op'>(</span><span class='va'>car</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Rows: 44
Columns: 5
$ LastName               &lt;chr&gt; &quot;Calixto&quot;, &quot;Azada&quot;, &quot;Balas&quot;, &quot;Barranc~
$ FirstName              &lt;chr&gt; &quot;Nils&quot;, &quot;Lars&quot;, &quot;Felix&quot;, &quot;Ingrid&quot;, &quot;I~
$ CarID                  &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12~
$ CurrentEmploymentType  &lt;chr&gt; &quot;Information Technology&quot;, &quot;Engineerin~
$ CurrentEmploymentTitle &lt;chr&gt; &quot;IT Helpdesk&quot;, &quot;Engineer&quot;, &quot;Engineer&quot;~</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>glimpse</span><span class='op'>(</span><span class='va'>gps</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Rows: 685,169
Columns: 4
$ Timestamp &lt;chr&gt; &quot;1/6/2014 6:28&quot;, &quot;1/6/2014 6:28&quot;, &quot;1/6/2014 6:28&quot;,~
$ id        &lt;dbl&gt; 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35~
$ lat       &lt;dbl&gt; 36.07623, 36.07622, 36.07621, 36.07622, 36.07621, ~
$ long      &lt;dbl&gt; 24.87469, 24.87460, 24.87444, 24.87425, 24.87417, ~</code></pre>
</div>
<p>Changing of CarID and ID to categorical data.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>car</span><span class='op'>$</span><span class='va'>CarID</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>car</span><span class='op'>$</span><span class='va'>CarID</span><span class='op'>)</span>
<span class='va'>gps</span><span class='op'>$</span><span class='va'>id</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>gps</span><span class='op'>$</span><span class='va'>id</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="combining-both-first-and-last-name.">2.6.1.4. Combining both first and last name.</h3>
<p>Next, we will combine both first and last name of the car datasets into one column for us to analyse the person easily. We will use the <em>tidyr</em> function unite to unify both the first and last name into <em>name</em>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>car_unite</span> <span class='op'>&lt;-</span> <span class='va'>car</span> <span class='op'>%&gt;%</span>
  <span class='fu'>unite</span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"name"</span>, <span class='va'>LastName</span>,<span class='va'>FirstName</span>, sep <span class='op'>=</span> <span class='st'>", "</span>,  remove <span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span> 
</code></pre>
</div>
</div>
<h3 id="change-datatype-of-time-and-rename-id-to-carid">2.6.1.5. Change datatype of time and rename id to Carid</h3>
<p>Next, we will rename the id of gps to CarID to match with the car_unite data. Additionally, the Timestamp data of gps will be changed to the dttm format</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>gps_cleaned</span> <span class='op'>&lt;-</span> <span class='fu'>rename</span><span class='op'>(</span><span class='va'>gps</span>,CarID <span class='op'>=</span> <span class='va'>id</span><span class='op'>)</span>

<span class='va'>gps_cleaned</span><span class='op'>$</span><span class='va'>Timestamp</span> <span class='op'>&lt;-</span> <span class='fu'>date_time_parse</span><span class='op'>(</span><span class='va'>gps_cleaned</span><span class='op'>$</span><span class='va'>Timestamp</span>,
                                 zone <span class='op'>=</span> <span class='st'>""</span>,
                                 format <span class='op'>=</span> <span class='st'>"%m/%d/%Y %H:%M"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Lastly, we will look at our cleaned dataset and we have done cleaning the data.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>glimpse</span><span class='op'>(</span><span class='va'>car_unite</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Rows: 44
Columns: 6
$ name                   &lt;chr&gt; &quot;Calixto, Nils&quot;, &quot;Azada, Lars&quot;, &quot;Bala~
$ LastName               &lt;chr&gt; &quot;Calixto&quot;, &quot;Azada&quot;, &quot;Balas&quot;, &quot;Barranc~
$ FirstName              &lt;chr&gt; &quot;Nils&quot;, &quot;Lars&quot;, &quot;Felix&quot;, &quot;Ingrid&quot;, &quot;I~
$ CarID                  &lt;fct&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12~
$ CurrentEmploymentType  &lt;chr&gt; &quot;Information Technology&quot;, &quot;Engineerin~
$ CurrentEmploymentTitle &lt;chr&gt; &quot;IT Helpdesk&quot;, &quot;Engineer&quot;, &quot;Engineer&quot;~</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>glimpse</span><span class='op'>(</span><span class='va'>gps_cleaned</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Rows: 685,169
Columns: 4
$ Timestamp &lt;dttm&gt; 2014-01-06 06:28:00, 2014-01-06 06:28:00, 2014-01~
$ CarID     &lt;fct&gt; 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35~
$ lat       &lt;dbl&gt; 36.07623, 36.07622, 36.07621, 36.07622, 36.07621, ~
$ long      &lt;dbl&gt; 24.87469, 24.87460, 24.87444, 24.87425, 24.87417, ~</code></pre>
</div>
<h1 id="answers">4. Answers</h1>
<h3 id="using-just-the-credit-and-loyalty-card-data-identify-the-most-popular-locations-and-when-they-are-popular.-what-anomalies-do-you-see-what-corrections-would-you-recommend-to-correct-these-anomalies-please-limit-your-answer-to-8-images-and-300-words.">4.1. Using just the credit and loyalty card data, identify the most popular locations, and when they are popular. What anomalies do you see? What corrections would you recommend to correct these anomalies? Please limit your answer to 8 images and 300 words.</h3>
<p>As shown previosuly in our data preparation segment, there is a difference in rows (difference of 98 rows) between the cc and loyalty card data. This shows an anomaly that one of the cards were used but not both during purchases which might results in a difference in number of entries.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>glimpse</span><span class='op'>(</span><span class='va'>cc_dtsplit</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Rows: 1,490
Columns: 7
$ timestamp  &lt;dttm&gt; 2014-01-06 07:28:00, 2014-01-06 07:34:00, 2014-0~
$ location   &lt;chr&gt; &quot;Brew&#39;ve Been Served&quot;, &quot;Hallowed Grounds&quot;, &quot;Brew&#39;~
$ price      &lt;dbl&gt; 11.34, 52.22, 8.33, 16.72, 4.24, 4.17, 28.73, 9.6~
$ last4ccnum &lt;fct&gt; 4795, 7108, 6816, 9617, 7384, 5368, 7253, 4948, 9~
$ day        &lt;ord&gt; Mon, Mon, Mon, Mon, Mon, Mon, Mon, Mon, Mon, Mon,~
$ date       &lt;date&gt; 2014-01-06, 2014-01-06, 2014-01-06, 2014-01-06, ~
$ time       &lt;chr&gt; &quot;07:28&quot;, &quot;07:34&quot;, &quot;07:35&quot;, &quot;07:36&quot;, &quot;07:37&quot;, &quot;07:~</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>glimpse</span><span class='op'>(</span><span class='va'>loyalty_dt</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Rows: 1,392
Columns: 4
$ date       &lt;date&gt; 2014-01-06, 2014-01-06, 2014-01-06, 2014-01-06, ~
$ location   &lt;chr&gt; &quot;Brew&#39;ve Been Served&quot;, &quot;Brew&#39;ve Been Served&quot;, &quot;Ha~
$ price      &lt;dbl&gt; 4.17, 9.60, 16.53, 11.51, 12.93, 4.27, 11.20, 15.~
$ loyaltynum &lt;fct&gt; L2247, L9406, L8328, L6417, L1107, L4034, L6110, ~</code></pre>
</div>
<p>As explained previously, the cc and loyalty dataset are similar in nature with just an exception of the last4ccnum and loyaltynum, therefore, a join is required to match rows where the users uses both cc and loyalty card data. However, before a join is performed, we will analyse both the cc and loyalty dataset based on location counts.</p>
<p>A first exploratory data analysis by using a bar chart is performed on the cc_dtsplit dataset to find out the location which were patronize the most.</p>
<p>Based on the bar chart below, we are able to observe that there are 4 locations that are siginificantly higher in visitors than the rest of the locations. The highest is Katerinaâ€™s cafe with a total of 212 visits followed by Hippokampos, Guysâ€™Gyros and Brewâ€™s been served. These four places excluding Hippokampos which is not determinable in the map provided are all restaurants/bars.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cc_dtsplit_bar</span> <span class='op'>&lt;-</span> <span class='va'>cc_dtsplit</span> <span class='op'>%&gt;%</span>
  <span class='fu'>count</span><span class='op'>(</span><span class='va'>location</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>location <span class='op'>=</span> <span class='fu'>fct_reorder</span><span class='op'>(</span><span class='va'>location</span>, <span class='va'>n</span>, .desc <span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>plot_ly</span><span class='op'>(</span>x <span class='op'>=</span> <span class='op'>~</span><span class='va'>location</span>, y <span class='op'>=</span> <span class='op'>~</span><span class='va'>n</span>, marker <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='op'>~</span><span class='va'>n</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>add_bars</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/layout.html'>layout</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Total number of visitation by location"</span>, xaxis <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span>,yaxis <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Number of visitors"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>cc_dtsplit_bar</span>
</code></pre>
</div>
<div id="htmlwidget-d0c60ffb08d4edf39f9b" style="width:624px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-d0c60ffb08d4edf39f9b">{"x":{"visdat":{"4aec2554658":["function () ","plotlyVisDat"]},"cur_data":"4aec2554658","attrs":{"4aec2554658":{"x":{},"y":{},"marker":{"color":{}},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Total number of visitation by location","xaxis":{"domain":[0,1],"automargin":true,"title":"","type":"category","categoryorder":"array","categoryarray":["Katerina\u0012s Cafi","Hippokampos","Guy's Gyros","Brew've Been Served","Hallowed Grounds","Ouzeri Elian","Abila Zacharo","Gelatogalore","Kalami Kafenion","Bean There Done That","Frydos Autosupply n' More","Coffee Cameleon","Jack's Magical Beans","Brewed Awakenings","Abila Airport","Albert's Fine Clothing","Nationwide Refinery","Shoppers' Delight","Carlyle Chemical Inc.","Stewart and Sons Fabrication","General Grocer","Kronos Mart","Chostus Hotel","Coffee Shack","Desafio Golf Course","Roberts and Sons","Ahaggo Museum","Kronos Pipe and Irrigation","Maximum Iron and Steel","Abila Scrapyard","Octavio's Office Supplies","Frank's Fuel","U-Pump","Daily Dealz"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Number of visitors"},"hovermode":"closest","showlegend":false},"source":"A","config":{"showSendToCloud":false},"data":[{"x":["Abila Airport","Abila Scrapyard","Abila Zacharo","Ahaggo Museum","Albert's Fine Clothing","Bean There Done That","Brew've Been Served","Brewed Awakenings","Carlyle Chemical Inc.","Chostus Hotel","Coffee Cameleon","Coffee Shack","Daily Dealz","Desafio Golf Course","Frank's Fuel","Frydos Autosupply n' More","Gelatogalore","General Grocer","Guy's Gyros","Hallowed Grounds","Hippokampos","Jack's Magical Beans","Kalami Kafenion","Katerina\u0012s Cafi","Kronos Mart","Kronos Pipe and Irrigation","Maximum Iron and Steel","Nationwide Refinery","Octavio's Office Supplies","Ouzeri Elian","Roberts and Sons","Shoppers' Delight","Stewart and Sons Fabrication","U-Pump"],"y":[25,4,72,6,25,47,156,30,19,9,38,8,1,8,2,47,64,10,158,92,171,37,64,212,10,6,6,24,4,87,8,20,18,2],"marker":{"color":[25,4,72,6,25,47,156,30,19,9,38,8,1,8,2,47,64,10,158,92,171,37,64,212,10,6,6,24,4,87,8,20,18,2],"line":{"color":"rgba(31,119,180,1)"}},"type":"bar","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<p>Next, we will take a look at the loyalty_dt dataset.</p>
<p>Based on the bar chart below, we are able to observe that the 4 locations that were visited mostly are the same four locations that was shown on the cc_dtsplit dataset.</p>
<p>One difference is that <em>Ouzeri Elian</em> jumps to the fifth spot which differs from the cc_dtsplit dataset where <em>Ouzeri Elian</em> is in the sixth spot.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>loyalty_dt_bar</span> <span class='op'>&lt;-</span> <span class='va'>loyalty_dt</span> <span class='op'>%&gt;%</span>
  <span class='fu'>count</span><span class='op'>(</span><span class='va'>location</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>location <span class='op'>=</span> <span class='fu'>fct_reorder</span><span class='op'>(</span><span class='va'>location</span>, <span class='va'>n</span>, .desc <span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>plot_ly</span><span class='op'>(</span>x <span class='op'>=</span> <span class='op'>~</span><span class='va'>location</span>, y <span class='op'>=</span> <span class='op'>~</span><span class='va'>n</span>, marker <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='op'>~</span><span class='va'>n</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>add_bars</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/layout.html'>layout</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Total number of visitation by "</span>, xaxis <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span>,yaxis <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Number of visitors"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>loyalty_dt_bar</span>
</code></pre>
</div>
<div id="htmlwidget-2a4c8526addf1ddf3173" style="width:624px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-2a4c8526addf1ddf3173">{"x":{"visdat":{"4aec53116a08":["function () ","plotlyVisDat"]},"cur_data":"4aec53116a08","attrs":{"4aec53116a08":{"x":{},"y":{},"marker":{"color":{}},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Total number of visitation by ","xaxis":{"domain":[0,1],"automargin":true,"title":"","type":"category","categoryorder":"array","categoryarray":["Katerina\u0012s Cafi","Hippokampos","Guy's Gyros","Brew've Been Served","Ouzeri Elian","Hallowed Grounds","Abila Zacharo","Kalami Kafenion","Gelatogalore","Bean There Done That","Frydos Autosupply n' More","Coffee Cameleon","Jack's Magical Beans","Brewed Awakenings","Abila Airport","Albert's Fine Clothing","Nationwide Refinery","Carlyle Chemical Inc.","Shoppers' Delight","Stewart and Sons Fabrication","General Grocer","Coffee Shack","Chostus Hotel","Desafio Golf Course","Kronos Mart","Ahaggo Museum","Kronos Pipe and Irrigation","Maximum Iron and Steel","Roberts and Sons","Abila Scrapyard","Octavio's Office Supplies","Frank's Fuel","U-Pump"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Number of visitors"},"hovermode":"closest","showlegend":false},"source":"A","config":{"showSendToCloud":false},"data":[{"x":["Abila Airport","Abila Scrapyard","Abila Zacharo","Ahaggo Museum","Albert's Fine Clothing","Bean There Done That","Brew've Been Served","Brewed Awakenings","Carlyle Chemical Inc.","Chostus Hotel","Coffee Cameleon","Coffee Shack","Desafio Golf Course","Frank's Fuel","Frydos Autosupply n' More","Gelatogalore","General Grocer","Guy's Gyros","Hallowed Grounds","Hippokampos","Jack's Magical Beans","Kalami Kafenion","Katerina\u0012s Cafi","Kronos Mart","Kronos Pipe and Irrigation","Maximum Iron and Steel","Nationwide Refinery","Octavio's Office Supplies","Ouzeri Elian","Roberts and Sons","Shoppers' Delight","Stewart and Sons Fabrication","U-Pump"],"y":[26,4,71,6,25,45,140,29,19,8,37,9,8,2,42,60,12,146,80,155,35,66,195,8,6,6,23,3,84,6,18,17,1],"marker":{"color":[26,4,71,6,25,45,140,29,19,8,37,9,8,2,42,60,12,146,80,155,35,66,195,8,6,6,23,3,84,6,18,17,1],"line":{"color":"rgba(31,119,180,1)"}},"type":"bar","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<p>Next, an inner join will be conducted by joining date, location and price and will will output into a new object <em>cc_loyalty_join</em>.</p>
<p>Notice that there are only 1,087 rows wheareas both cc_dtsplit and loyalty_dt has 1490 and 1392 rows respectfully. These shows that some of the data in cc does not match the loyalty data which strengthens the initial anomaly that some of the employees uses one of each card but not both during purchases.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cc_loyalty_join</span> <span class='op'>&lt;-</span> <span class='va'>cc_dtsplit</span> <span class='op'>%&gt;%</span>
  <span class='fu'>inner_join</span><span class='op'>(</span><span class='va'>loyalty_dt</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"date"</span>,<span class='st'>"location"</span>, <span class='st'>"price"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>cc_loyalty_join</span>
</code></pre>
</div>
<pre><code># A tibble: 1,087 x 8
   timestamp           location      price last4ccnum day   date      
   &lt;dttm&gt;              &lt;chr&gt;         &lt;dbl&gt; &lt;fct&gt;      &lt;ord&gt; &lt;date&gt;    
 1 2014-01-06 07:28:00 Brew&#39;ve Been~ 11.3  4795       Mon   2014-01-06
 2 2014-01-06 07:35:00 Brew&#39;ve Been~  8.33 6816       Mon   2014-01-06
 3 2014-01-06 07:36:00 Hallowed Gro~ 16.7  9617       Mon   2014-01-06
 4 2014-01-06 07:37:00 Brew&#39;ve Been~  4.24 7384       Mon   2014-01-06
 5 2014-01-06 07:38:00 Brew&#39;ve Been~  4.17 5368       Mon   2014-01-06
 6 2014-01-06 07:43:00 Brew&#39;ve Been~  9.6  4948       Mon   2014-01-06
 7 2014-01-06 07:43:00 Brew&#39;ve Been~ 16.9  9683       Mon   2014-01-06
 8 2014-01-06 07:47:00 Hallowed Gro~ 16.5  8129       Mon   2014-01-06
 9 2014-01-06 07:48:00 Hallowed Gro~ 10.7  3492       Mon   2014-01-06
10 2014-01-06 07:49:00 Coffee Camel~  8.39 5921       Mon   2014-01-06
# ... with 1,077 more rows, and 2 more variables: time &lt;chr&gt;,
#   loyaltynum &lt;fct&gt;</code></pre>
</div>
<p>After joining the dataset, we found that there are 1087 rows of data available. This means that some of the credit card purchases are not linked to any of the loyalty card, vice versa, some of the loyalty card are not linked to the credit card purchases. These strengthen the anomaly that we have highlighted before. We will take a look at those datasets that does not match later.</p>
<p>Before we begin further analysis on further anomalies between the two datasets. We shall conduct some exploratory data analysis. First, we will analyse the most popular place visited during the duration of study.</p>
<p>To do the above, we will group all the location by the number of visitations. Taking a look at the raw output, we can see that the 4 most visited place is the same four as mentioned previosuly.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cc_location_count</span> <span class='op'>&lt;-</span> <span class='va'>cc_loyalty_join</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>location</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>summarize</span><span class='op'>(</span>count <span class='op'>=</span> <span class='fu'>n</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>arrange</span><span class='op'>(</span><span class='fu'>desc</span><span class='op'>(</span><span class='va'>count</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>cc_location_count</span>
</code></pre>
</div>
<pre><code># A tibble: 32 x 2
   location               count
   &lt;chr&gt;                  &lt;int&gt;
 1 &quot;Katerina\u0012s Cafi&quot;   155
 2 &quot;Guy&#39;s Gyros&quot;            121
 3 &quot;Hippokampos&quot;            117
 4 &quot;Brew&#39;ve Been Served&quot;    111
 5 &quot;Ouzeri Elian&quot;            62
 6 &quot;Hallowed Grounds&quot;        60
 7 &quot;Kalami Kafenion&quot;         53
 8 &quot;Abila Zacharo&quot;           52
 9 &quot;Gelatogalore&quot;            48
10 &quot;Bean There Done That&quot;    36
# ... with 22 more rows</code></pre>
</div>
<p>Next, a bar chart is produced sorted descendingly by the number of visitations.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cc_join</span> <span class='op'>&lt;-</span> <span class='va'>cc_loyalty_join</span> <span class='op'>%&gt;%</span>
  <span class='fu'>count</span><span class='op'>(</span><span class='va'>location</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>location <span class='op'>=</span> <span class='fu'>fct_reorder</span><span class='op'>(</span><span class='va'>location</span>, <span class='va'>n</span>, .desc <span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>plot_ly</span><span class='op'>(</span>x <span class='op'>=</span> <span class='op'>~</span><span class='va'>location</span>, y <span class='op'>=</span> <span class='op'>~</span><span class='va'>n</span>, marker <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='op'>~</span><span class='va'>n</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>add_bars</span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>"inner-join"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/layout.html'>layout</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Total number of visitation by area"</span>, xaxis <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span>,yaxis <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Number of visitors"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>cc_join</span>
</code></pre>
</div>
<div id="htmlwidget-d91bf0f97b91dc24af37" style="width:624px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-d91bf0f97b91dc24af37">{"x":{"visdat":{"4aec356e5715":["function () ","plotlyVisDat"]},"cur_data":"4aec356e5715","attrs":{"4aec356e5715":{"x":{},"y":{},"marker":{"color":{}},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar","name":"inner-join","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Total number of visitation by area","xaxis":{"domain":[0,1],"automargin":true,"title":"","type":"category","categoryorder":"array","categoryarray":["Katerina\u0012s Cafi","Guy's Gyros","Hippokampos","Brew've Been Served","Ouzeri Elian","Hallowed Grounds","Kalami Kafenion","Abila Zacharo","Gelatogalore","Bean There Done That","Frydos Autosupply n' More","Coffee Cameleon","Jack's Magical Beans","Albert's Fine Clothing","Brewed Awakenings","Abila Airport","Nationwide Refinery","Carlyle Chemical Inc.","Shoppers' Delight","Stewart and Sons Fabrication","General Grocer","Coffee Shack","Desafio Golf Course","Chostus Hotel","Maximum Iron and Steel","Ahaggo Museum","Kronos Pipe and Irrigation","Abila Scrapyard","Roberts and Sons","Octavio's Office Supplies","Frank's Fuel","U-Pump"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Number of visitors"},"hovermode":"closest","showlegend":false},"source":"A","config":{"showSendToCloud":false},"data":[{"x":["Abila Airport","Abila Scrapyard","Abila Zacharo","Ahaggo Museum","Albert's Fine Clothing","Bean There Done That","Brew've Been Served","Brewed Awakenings","Carlyle Chemical Inc.","Chostus Hotel","Coffee Cameleon","Coffee Shack","Desafio Golf Course","Frank's Fuel","Frydos Autosupply n' More","Gelatogalore","General Grocer","Guy's Gyros","Hallowed Grounds","Hippokampos","Jack's Magical Beans","Kalami Kafenion","Katerina\u0012s Cafi","Kronos Pipe and Irrigation","Maximum Iron and Steel","Nationwide Refinery","Octavio's Office Supplies","Ouzeri Elian","Roberts and Sons","Shoppers' Delight","Stewart and Sons Fabrication","U-Pump"],"y":[20,4,52,5,24,36,111,21,16,6,28,7,7,2,34,48,8,121,60,117,25,53,155,5,6,19,3,62,4,15,12,1],"marker":{"color":[20,4,52,5,24,36,111,21,16,6,28,7,7,2,34,48,8,121,60,117,25,53,155,5,6,19,3,62,4,15,12,1],"line":{"color":"rgba(31,119,180,1)"}},"type":"bar","name":"inner-join","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<p>From the chart above, we can observe that <em>â€œKaterineâ€s Cafe" (155 counts)</em>, <em>â€œGuyâ€™s Gyrosâ€ (121 counts)</em>, <em>â€œHippokamposâ€ (117 counts)</em>, <em>â€œBrewâ€™ve Been Serveâ€ (111 counts)</em> have the most visitation during the period of study. If we take a look closely, the 4th most visited place is actually around 2x the 5th most visited place. This shows that top 4 most visited places takes up most of places visited by patrons.</p>
<p>Although we have shown the overall most visited places. However, the more interesting analysis lies in when are the places visited by patrons. As such, we will group the joined data by location, date, day and time to see at which point of time was the location the most.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cc_loyalty_group</span> <span class='op'>&lt;-</span> <span class='va'>cc_loyalty_join</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>location</span>,<span class='va'>date</span>,<span class='va'>day</span>,<span class='va'>time</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>summarize</span><span class='op'>(</span>count <span class='op'>=</span> <span class='fu'>n</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>arrange</span><span class='op'>(</span><span class='fu'>desc</span><span class='op'>(</span><span class='va'>count</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>cc_loyalty_group</span>
</code></pre>
</div>
<pre><code># A tibble: 992 x 5
   location             date       day   time  count
   &lt;chr&gt;                &lt;date&gt;     &lt;ord&gt; &lt;chr&gt; &lt;int&gt;
 1 Bean There Done That 2014-01-13 Mon   12:00     6
 2 Bean There Done That 2014-01-06 Mon   12:00     5
 3 Bean There Done That 2014-01-10 Fri   12:00     5
 4 Bean There Done That 2014-01-17 Fri   12:00     5
 5 Bean There Done That 2014-01-16 Thu   12:00     4
 6 Guy&#39;s Gyros          2014-01-19 Sun   19:45     4
 7 Jack&#39;s Magical Beans 2014-01-13 Mon   12:00     4
 8 Jack&#39;s Magical Beans 2014-01-16 Thu   12:00     4
 9 Bean There Done That 2014-01-14 Tue   12:00     3
10 Bean There Done That 2014-01-15 Wed   12:00     3
# ... with 982 more rows</code></pre>
</div>
<p>From the above table we can already observe that â€œBean There Done Thatâ€ was patronized the most at one point of time. Next, are â€œGuyâ€™s Gyrosâ€ and â€œJackâ€™s Magical Beansâ€. Interestingly, â€œBean There Done Thatâ€ has the highest count of high visitation at one point of time.</p>
<p>Next, we will plot a line chart of the restaurant based on count of 3 or more based on a time series line chart to see if there is a trend. The reason to plot 3 or more is to show those location that were highly visited at one point of time.</p>
<p>We will first filter the dataset.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cc_loyalty_top</span> <span class='op'>&lt;-</span> <span class='va'>cc_loyalty_group</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>count</span> <span class='op'>&gt;=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Next, we will create the line chart.</p>
<p>Based on the most frequented places, we can see that January 13 clock the highest count for one day. Additonally, Bean there done that has clocked the highest visitations per day followed by Jackâ€™s Magical Beans.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cc_timeseries</span> <span class='op'>&lt;-</span> <span class='va'>cc_loyalty_top</span> <span class='op'>%&gt;%</span>
  <span class='fu'>plot_ly</span><span class='op'>(</span>x <span class='op'>=</span> <span class='op'>~</span><span class='va'>date</span>, y <span class='op'>=</span><span class='op'>~</span><span class='va'>count</span>, color <span class='op'>=</span> <span class='op'>~</span><span class='va'>location</span>, hoverinfo <span class='op'>=</span> <span class='st'>"text"</span>,
          text <span class='op'>=</span> <span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Location:"</span>, <span class='va'>location</span>, <span class='st'>"&lt;br&gt;"</span>,<span class='st'>"Date:"</span>, <span class='va'>date</span>, <span class='st'>"&lt;br&gt;"</span>,<span class='st'>"Time:"</span>, <span class='va'>time</span>, <span class='st'>"&lt;br&gt;"</span>, <span class='st'>"Day:"</span>, <span class='va'>day</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>add_lines</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>add_markers</span><span class='op'>(</span>showlegend <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/layout.html'>layout</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Most frequented places by groups of people"</span>, xaxis <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>""</span>, dtick <span class='op'>=</span> <span class='op'>~</span><span class='va'>date</span>, showgrid <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>, yaxis <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Number of people"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>cc_timeseries</span>
</code></pre>
</div>
<div id="htmlwidget-d06e7440935015690058" style="width:624px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-d06e7440935015690058">{"x":{"visdat":{"4aec781267c":["function () ","plotlyVisDat"]},"cur_data":"4aec781267c","attrs":{"4aec781267c":{"x":{},"y":{},"hoverinfo":"text","text":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","mode":"lines","inherit":true},"4aec781267c.1":{"x":{},"y":{},"hoverinfo":"text","text":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","mode":"markers","showlegend":false,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Most frequented places by groups of people","xaxis":{"domain":[0,1],"automargin":true,"title":"","dtick":["2014-01-13","2014-01-06","2014-01-10","2014-01-17","2014-01-16","2014-01-19","2014-01-13","2014-01-16","2014-01-14","2014-01-15","2014-01-08","2014-01-14","2014-01-14","2014-01-15","2014-01-06","2014-01-10","2014-01-14","2014-01-10","2014-01-16","2014-01-06","2014-01-08","2014-01-10"],"showgrid":false},"yaxis":{"domain":[0,1],"automargin":true,"title":"Number of people"},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":["2014-01-06","2014-01-10","2014-01-13","2014-01-14","2014-01-15","2014-01-16","2014-01-17"],"y":[5,5,6,3,3,4,5],"hoverinfo":["text","text","text","text","text","text","text"],"text":["Location: Bean There Done That <br> Date: 2014-01-06 <br> Time: 12:00 <br> Day: Mon","Location: Bean There Done That <br> Date: 2014-01-10 <br> Time: 12:00 <br> Day: Fri","Location: Bean There Done That <br> Date: 2014-01-13 <br> Time: 12:00 <br> Day: Mon","Location: Bean There Done That <br> Date: 2014-01-14 <br> Time: 12:00 <br> Day: Tue","Location: Bean There Done That <br> Date: 2014-01-15 <br> Time: 12:00 <br> Day: Wed","Location: Bean There Done That <br> Date: 2014-01-16 <br> Time: 12:00 <br> Day: Thu","Location: Bean There Done That <br> Date: 2014-01-17 <br> Time: 12:00 <br> Day: Fri"],"type":"scatter","mode":"lines","name":"Bean There Done That","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-08","2014-01-14","2014-01-14","2014-01-15"],"y":[3,3,3,3],"hoverinfo":["text","text","text","text"],"text":["Location: Brew've Been Served <br> Date: 2014-01-08 <br> Time: 08:01 <br> Day: Wed","Location: Brew've Been Served <br> Date: 2014-01-14 <br> Time: 07:45 <br> Day: Tue","Location: Brew've Been Served <br> Date: 2014-01-14 <br> Time: 07:53 <br> Day: Tue","Location: Brew've Been Served <br> Date: 2014-01-15 <br> Time: 07:58 <br> Day: Wed"],"type":"scatter","mode":"lines","name":"Brew've Been Served","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-06","2014-01-10","2014-01-14"],"y":[3,3,3],"hoverinfo":["text","text","text"],"text":["Location: Brewed Awakenings <br> Date: 2014-01-06 <br> Time: 12:00 <br> Day: Mon","Location: Brewed Awakenings <br> Date: 2014-01-10 <br> Time: 12:00 <br> Day: Fri","Location: Brewed Awakenings <br> Date: 2014-01-14 <br> Time: 12:00 <br> Day: Tue"],"type":"scatter","mode":"lines","name":"Brewed Awakenings","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"line":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-19"],"y":[4],"hoverinfo":"text","text":"Location: Guy's Gyros <br> Date: 2014-01-19 <br> Time: 19:45 <br> Day: Sun","type":"scatter","mode":"lines","name":"Guy's Gyros","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"line":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-10","2014-01-16"],"y":[3,3],"hoverinfo":["text","text"],"text":["Location: Hallowed Grounds <br> Date: 2014-01-10 <br> Time: 07:41 <br> Day: Fri","Location: Hallowed Grounds <br> Date: 2014-01-16 <br> Time: 07:44 <br> Day: Thu"],"type":"scatter","mode":"lines","name":"Hallowed Grounds","marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"line":{"color":"rgba(166,216,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-06","2014-01-08","2014-01-10","2014-01-13","2014-01-16"],"y":[3,3,3,4,4],"hoverinfo":["text","text","text","text","text"],"text":["Location: Jack's Magical Beans <br> Date: 2014-01-06 <br> Time: 12:00 <br> Day: Mon","Location: Jack's Magical Beans <br> Date: 2014-01-08 <br> Time: 12:00 <br> Day: Wed","Location: Jack's Magical Beans <br> Date: 2014-01-10 <br> Time: 12:00 <br> Day: Fri","Location: Jack's Magical Beans <br> Date: 2014-01-13 <br> Time: 12:00 <br> Day: Mon","Location: Jack's Magical Beans <br> Date: 2014-01-16 <br> Time: 12:00 <br> Day: Thu"],"type":"scatter","mode":"lines","name":"Jack's Magical Beans","marker":{"color":"rgba(255,217,47,1)","line":{"color":"rgba(255,217,47,1)"}},"textfont":{"color":"rgba(255,217,47,1)"},"error_y":{"color":"rgba(255,217,47,1)"},"error_x":{"color":"rgba(255,217,47,1)"},"line":{"color":"rgba(255,217,47,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-13","2014-01-06","2014-01-10","2014-01-17","2014-01-16","2014-01-14","2014-01-15"],"y":[6,5,5,5,4,3,3],"hoverinfo":["text","text","text","text","text","text","text"],"text":["Location: Bean There Done That <br> Date: 2014-01-13 <br> Time: 12:00 <br> Day: Mon","Location: Bean There Done That <br> Date: 2014-01-06 <br> Time: 12:00 <br> Day: Mon","Location: Bean There Done That <br> Date: 2014-01-10 <br> Time: 12:00 <br> Day: Fri","Location: Bean There Done That <br> Date: 2014-01-17 <br> Time: 12:00 <br> Day: Fri","Location: Bean There Done That <br> Date: 2014-01-16 <br> Time: 12:00 <br> Day: Thu","Location: Bean There Done That <br> Date: 2014-01-14 <br> Time: 12:00 <br> Day: Tue","Location: Bean There Done That <br> Date: 2014-01-15 <br> Time: 12:00 <br> Day: Wed"],"type":"scatter","mode":"markers","showlegend":false,"name":"Bean There Done That","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-08","2014-01-14","2014-01-14","2014-01-15"],"y":[3,3,3,3],"hoverinfo":["text","text","text","text"],"text":["Location: Brew've Been Served <br> Date: 2014-01-08 <br> Time: 08:01 <br> Day: Wed","Location: Brew've Been Served <br> Date: 2014-01-14 <br> Time: 07:45 <br> Day: Tue","Location: Brew've Been Served <br> Date: 2014-01-14 <br> Time: 07:53 <br> Day: Tue","Location: Brew've Been Served <br> Date: 2014-01-15 <br> Time: 07:58 <br> Day: Wed"],"type":"scatter","mode":"markers","showlegend":false,"name":"Brew've Been Served","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-06","2014-01-10","2014-01-14"],"y":[3,3,3],"hoverinfo":["text","text","text"],"text":["Location: Brewed Awakenings <br> Date: 2014-01-06 <br> Time: 12:00 <br> Day: Mon","Location: Brewed Awakenings <br> Date: 2014-01-10 <br> Time: 12:00 <br> Day: Fri","Location: Brewed Awakenings <br> Date: 2014-01-14 <br> Time: 12:00 <br> Day: Tue"],"type":"scatter","mode":"markers","showlegend":false,"name":"Brewed Awakenings","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"line":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-19"],"y":[4],"hoverinfo":"text","text":"Location: Guy's Gyros <br> Date: 2014-01-19 <br> Time: 19:45 <br> Day: Sun","type":"scatter","mode":"markers","showlegend":false,"name":"Guy's Gyros","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"line":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-10","2014-01-16"],"y":[3,3],"hoverinfo":["text","text"],"text":["Location: Hallowed Grounds <br> Date: 2014-01-10 <br> Time: 07:41 <br> Day: Fri","Location: Hallowed Grounds <br> Date: 2014-01-16 <br> Time: 07:44 <br> Day: Thu"],"type":"scatter","mode":"markers","showlegend":false,"name":"Hallowed Grounds","marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"line":{"color":"rgba(166,216,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-13","2014-01-16","2014-01-06","2014-01-08","2014-01-10"],"y":[4,4,3,3,3],"hoverinfo":["text","text","text","text","text"],"text":["Location: Jack's Magical Beans <br> Date: 2014-01-13 <br> Time: 12:00 <br> Day: Mon","Location: Jack's Magical Beans <br> Date: 2014-01-16 <br> Time: 12:00 <br> Day: Thu","Location: Jack's Magical Beans <br> Date: 2014-01-06 <br> Time: 12:00 <br> Day: Mon","Location: Jack's Magical Beans <br> Date: 2014-01-08 <br> Time: 12:00 <br> Day: Wed","Location: Jack's Magical Beans <br> Date: 2014-01-10 <br> Time: 12:00 <br> Day: Fri"],"type":"scatter","mode":"markers","showlegend":false,"name":"Jack's Magical Beans","marker":{"color":"rgba(255,217,47,1)","line":{"color":"rgba(255,217,47,1)"}},"textfont":{"color":"rgba(255,217,47,1)"},"error_y":{"color":"rgba(255,217,47,1)"},"error_x":{"color":"rgba(255,217,47,1)"},"line":{"color":"rgba(255,217,47,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<p>Next, we will analyse the highest frequented location based on day and time. To do that, we will need to use this unite to combine both day and time together and group the, by location and daytime.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cc_loyalty_day</span> <span class='op'>&lt;-</span> <span class='va'>cc_loyalty_join</span> <span class='op'>%&gt;%</span>
  <span class='fu'>unite</span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"daytime"</span>, <span class='va'>day</span>,<span class='va'>time</span>, sep <span class='op'>=</span> <span class='st'>" "</span>,  remove <span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>location</span>, <span class='va'>daytime</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>summarize</span><span class='op'>(</span>count <span class='op'>=</span> <span class='fu'>n</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>arrange</span><span class='op'>(</span><span class='fu'>desc</span><span class='op'>(</span><span class='va'>count</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>cc_loyalty_day</span>
</code></pre>
</div>
<pre><code># A tibble: 937 x 3
# Groups:   location [32]
   location             daytime   count
   &lt;chr&gt;                &lt;chr&gt;     &lt;int&gt;
 1 Bean There Done That Mon 12:00    11
 2 Bean There Done That Fri 12:00    10
 3 Jack&#39;s Magical Beans Mon 12:00     7
 4 Bean There Done That Thu 12:00     6
 5 Jack&#39;s Magical Beans Thu 12:00     6
 6 Bean There Done That Wed 12:00     5
 7 Brewed Awakenings    Fri 12:00     5
 8 Brewed Awakenings    Mon 12:00     5
 9 Jack&#39;s Magical Beans Fri 12:00     5
10 Jack&#39;s Magical Beans Wed 12:00     5
# ... with 927 more rows</code></pre>
</div>
<p>Next, a bar chart is plotted by filtering out those with more than or equal to 5. From the bar chart, we are able to see that Bean there done that has the highest visitations at a point of time, this is similar to the analysis we did before. The highest is 11 counts on Mon, 12:00H, next is Fri, 12:00H with 11 counts. The nect highest visited location at a point of time is Jackâ€™s Magical Beans which clock 7 counts on Mon, 12:00H, followed by Thu, 12:00H of 6 counts.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cc_day</span> <span class='op'>&lt;-</span> <span class='va'>cc_loyalty_day</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>count</span> <span class='op'>&gt;=</span><span class='fl'>5</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>plot_ly</span><span class='op'>(</span>x <span class='op'>=</span> <span class='op'>~</span><span class='va'>daytime</span>, y <span class='op'>=</span> <span class='op'>~</span><span class='va'>count</span>, color <span class='op'>=</span> <span class='op'>~</span><span class='va'>location</span>, hoverinfo <span class='op'>=</span> <span class='st'>"text"</span>, text <span class='op'>=</span> <span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Location:"</span>, <span class='va'>location</span>, <span class='st'>"&lt;br&gt;"</span>,<span class='st'>"Day Time:"</span>, <span class='va'>daytime</span>, <span class='st'>"&lt;br&gt;"</span>, <span class='st'>"No.of visitors:"</span>, <span class='va'>count</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>add_bars</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/layout.html'>layout</a></span> <span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Total counts of visitors by day and time"</span>, xaxis <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>""</span>, size <span class='op'>=</span> <span class='fl'>3</span>, dtick <span class='op'>=</span> <span class='op'>~</span><span class='va'>daytime</span><span class='op'>)</span>, yaxis <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Number of visitors"</span><span class='op'>)</span> <span class='op'>)</span>

<span class='va'>cc_day</span>
</code></pre>
</div>
<div id="htmlwidget-8896d3c8bf7fafcb69e1" style="width:624px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-8896d3c8bf7fafcb69e1">{"x":{"visdat":{"4aec7b23956":["function () ","plotlyVisDat"]},"cur_data":"4aec7b23956","attrs":{"4aec7b23956":{"x":{},"y":{},"hoverinfo":"text","text":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Total counts of visitors by day and time","xaxis":{"domain":[0,1],"automargin":true,"title":"","size":3,"dtick":["Mon 12:00","Fri 12:00","Mon 12:00","Thu 12:00","Thu 12:00","Wed 12:00","Fri 12:00","Mon 12:00","Fri 12:00","Wed 12:00"],"type":"category","categoryorder":"array","categoryarray":["Fri 12:00","Mon 12:00","Thu 12:00","Wed 12:00"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Number of visitors"},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":["Mon 12:00","Fri 12:00","Thu 12:00","Wed 12:00"],"y":[11,10,6,5],"hoverinfo":["text","text","text","text"],"text":["Location: Bean There Done That <br> Day Time: Mon 12:00 <br> No.of visitors: 11","Location: Bean There Done That <br> Day Time: Fri 12:00 <br> No.of visitors: 10","Location: Bean There Done That <br> Day Time: Thu 12:00 <br> No.of visitors: 6","Location: Bean There Done That <br> Day Time: Wed 12:00 <br> No.of visitors: 5"],"type":"bar","name":"Bean There Done That","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Fri 12:00","Mon 12:00"],"y":[5,5],"hoverinfo":["text","text"],"text":["Location: Brewed Awakenings <br> Day Time: Fri 12:00 <br> No.of visitors: 5","Location: Brewed Awakenings <br> Day Time: Mon 12:00 <br> No.of visitors: 5"],"type":"bar","name":"Brewed Awakenings","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Mon 12:00","Thu 12:00","Fri 12:00","Wed 12:00"],"y":[7,6,5,5],"hoverinfo":["text","text","text","text"],"text":["Location: Jack's Magical Beans <br> Day Time: Mon 12:00 <br> No.of visitors: 7","Location: Jack's Magical Beans <br> Day Time: Thu 12:00 <br> No.of visitors: 6","Location: Jack's Magical Beans <br> Day Time: Fri 12:00 <br> No.of visitors: 5","Location: Jack's Magical Beans <br> Day Time: Wed 12:00 <br> No.of visitors: 5"],"type":"bar","name":"Jack's Magical Beans","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<p>Having completed some EDA by inner joining both cc and loyalty dataset. We will sieve out those dataset that were in cc but not in loyalty. The method to do this is by using anti-join. Anti-join will take out those dataset that does not belongs to the secondary dataset but in the main dataset.</p>
<p>This method is similar to full join therafter sieving those NA values.</p>
<p>From the anti-joined data below, we are able to see that there are 409 rows that were in cc but not in loyalty. This form an anomaly that cc were used in the purchases but not the loyalty card.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cc_loyalty_antijoin</span> <span class='op'>&lt;-</span> <span class='va'>cc_dtsplit</span> <span class='op'>%&gt;%</span>
  <span class='fu'>anti_join</span><span class='op'>(</span><span class='va'>loyalty_dt</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"date"</span>,<span class='st'>"location"</span>, <span class='st'>"price"</span><span class='op'>)</span><span class='op'>)</span>


<span class='va'>cc_loyalty_antijoin</span>
</code></pre>
</div>
<pre><code># A tibble: 409 x 7
   timestamp           location      price last4ccnum day   date      
   &lt;dttm&gt;              &lt;chr&gt;         &lt;dbl&gt; &lt;fct&gt;      &lt;ord&gt; &lt;date&gt;    
 1 2014-01-06 07:34:00 Hallowed Gr~ 5.22e1 7108       Mon   2014-01-06
 2 2014-01-06 07:42:00 Coffee Came~ 2.87e1 7253       Mon   2014-01-06
 3 2014-01-06 07:52:00 Brew&#39;ve Bee~ 3.28e1 9405       Mon   2014-01-06
 4 2014-01-06 07:54:00 Hallowed Gr~ 1.69e1 7889       Mon   2014-01-06
 5 2014-01-06 07:54:00 Hallowed Gr~ 3.29e1 2681       Mon   2014-01-06
 6 2014-01-06 08:00:00 Hallowed Gr~ 9.69e0 6691       Mon   2014-01-06
 7 2014-01-06 08:14:00 Coffee Came~ 3.2 e0 2418       Mon   2014-01-06
 8 2014-01-06 12:00:00 Coffee Shack 5.15e1 7117       Mon   2014-01-06
 9 2014-01-06 12:00:00 Jack&#39;s Magi~ 2.78e1 8156       Mon   2014-01-06
10 2014-01-06 12:16:00 Abila Airpo~ 1.87e3 8642       Mon   2014-01-06
# ... with 399 more rows, and 1 more variable: time &lt;chr&gt;</code></pre>
</div>
<p>Next, we will create a basic bar chart based on the anti join dataset.</p>
<p>Based on the bar chart below, we can see that similar to the inner join dataset, the four locations are Katerinaâ€™s Cafe, Hippokampos, Brewâ€™s been served and Guyâ€™s Gyros with the highest count of 59 clock at Katerinaâ€™s Cafe.</p>
<p>One major difference between this anti joined dataset versus the inner joined is that the descending gradient for each restaurant is not as steep as the inner joined. In the inner joined dataset, the 4th highest visited location is almost 2x the 5th highest visited location. As for the below chart, we can see that the decrement is not that steep.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cc_anti</span> <span class='op'>&lt;-</span> <span class='va'>cc_loyalty_antijoin</span> <span class='op'>%&gt;%</span>
  <span class='fu'>count</span><span class='op'>(</span><span class='va'>location</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>location <span class='op'>=</span> <span class='fu'>fct_reorder</span><span class='op'>(</span><span class='va'>location</span>, <span class='va'>n</span>, .desc <span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>plot_ly</span><span class='op'>(</span>x <span class='op'>=</span> <span class='op'>~</span><span class='va'>location</span>, y <span class='op'>=</span> <span class='op'>~</span><span class='va'>n</span>, marker <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='op'>~</span><span class='va'>n</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>add_bars</span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>"anti-join"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/layout.html'>layout</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Total number of visitation by area"</span>, xaxis <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>""</span>, automargin <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,yaxis <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Number of visitors"</span>, automargin <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>cc_anti</span>
</code></pre>
</div>
<div id="htmlwidget-18cf3a578c585ce2c54d" style="width:624px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-18cf3a578c585ce2c54d">{"x":{"visdat":{"4aec702b449d":["function () ","plotlyVisDat"]},"cur_data":"4aec702b449d","attrs":{"4aec702b449d":{"x":{},"y":{},"marker":{"color":{}},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar","name":"anti-join","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Total number of visitation by area","xaxis":{"domain":[0,1],"automargin":true,"title":"","type":"category","categoryorder":"array","categoryarray":["Katerina\u0012s Cafi","Hippokampos","Brew've Been Served","Guy's Gyros","Hallowed Grounds","Ouzeri Elian","Abila Zacharo","Gelatogalore","Frydos Autosupply n' More","Jack's Magical Beans","Bean There Done That","Kalami Kafenion","Coffee Cameleon","Kronos Mart","Brewed Awakenings","Stewart and Sons Fabrication","Abila Airport","Nationwide Refinery","Shoppers' Delight","Roberts and Sons","Carlyle Chemical Inc.","Chostus Hotel","General Grocer","Ahaggo Museum","Albert's Fine Clothing","Coffee Shack","Daily Dealz","Desafio Golf Course","Kronos Pipe and Irrigation","Octavio's Office Supplies","U-Pump"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Number of visitors"},"hovermode":"closest","showlegend":false},"source":"A","config":{"showSendToCloud":false},"data":[{"x":["Abila Airport","Abila Zacharo","Ahaggo Museum","Albert's Fine Clothing","Bean There Done That","Brew've Been Served","Brewed Awakenings","Carlyle Chemical Inc.","Chostus Hotel","Coffee Cameleon","Coffee Shack","Daily Dealz","Desafio Golf Course","Frydos Autosupply n' More","Gelatogalore","General Grocer","Guy's Gyros","Hallowed Grounds","Hippokampos","Jack's Magical Beans","Kalami Kafenion","Katerina\u0012s Cafi","Kronos Mart","Kronos Pipe and Irrigation","Nationwide Refinery","Octavio's Office Supplies","Ouzeri Elian","Roberts and Sons","Shoppers' Delight","Stewart and Sons Fabrication","U-Pump"],"y":[5,20,1,1,11,45,9,3,3,10,1,1,1,13,16,2,39,32,56,12,11,59,10,1,5,1,25,4,5,6,1],"marker":{"color":[5,20,1,1,11,45,9,3,3,10,1,1,1,13,16,2,39,32,56,12,11,59,10,1,5,1,25,4,5,6,1],"line":{"color":"rgba(31,119,180,1)"}},"type":"bar","name":"anti-join","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<p>Next, we will group the anti joined dataset to extract the number of visitations at a point of time. Based on the raw grouped data below, we can see that the count of visitations is quite linear with no high variations observed.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cc_loyalty_anti_group</span> <span class='op'>&lt;-</span> <span class='va'>cc_loyalty_antijoin</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>location</span>, <span class='va'>day</span>, <span class='va'>date</span>, <span class='va'>time</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>summarize</span><span class='op'>(</span>count <span class='op'>=</span> <span class='fu'>n</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>arrange</span><span class='op'>(</span><span class='fu'>desc</span><span class='op'>(</span><span class='va'>count</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>cc_loyalty_anti_group</span>
</code></pre>
</div>
<pre><code># A tibble: 391 x 5
   location             day   date       time  count
   &lt;chr&gt;                &lt;ord&gt; &lt;date&gt;     &lt;chr&gt; &lt;int&gt;
 1 Bean There Done That Tue   2014-01-07 12:00     3
 2 Brewed Awakenings    Tue   2014-01-07 12:00     3
 3 Jack&#39;s Magical Beans Thu   2014-01-09 12:00     3
 4 Bean There Done That Tue   2014-01-14 12:00     2
 5 Bean There Done That Wed   2014-01-08 12:00     2
 6 Brew&#39;ve Been Served  Fri   2014-01-10 07:56     2
 7 Guy&#39;s Gyros          Tue   2014-01-07 20:10     2
 8 Hallowed Grounds     Mon   2014-01-06 07:54     2
 9 Hallowed Grounds     Wed   2014-01-08 07:39     2
10 Hallowed Grounds     Thu   2014-01-16 07:51     2
# ... with 381 more rows</code></pre>
</div>
<p>Using the group data, we will create a time-series chart to see the trend throughout the duration of study. We will output those data with count of more than or equal to 2.</p>
<p>Based on the chart below, we can observe that Bean there done that and Jackâ€™s Magical Beans at one point has the highest visitations of 3 transactions. The rest of the location are quite constant with 2 transactions.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"> <span class='va'>cc_anti_timeseries</span> <span class='op'>&lt;-</span> <span class='va'>cc_loyalty_anti_group</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>count</span> <span class='op'>&gt;=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>plot_ly</span><span class='op'>(</span>x <span class='op'>=</span> <span class='op'>~</span><span class='va'>date</span>, y <span class='op'>=</span><span class='op'>~</span><span class='va'>count</span>, color <span class='op'>=</span> <span class='op'>~</span><span class='va'>location</span>, hoverinfo <span class='op'>=</span> <span class='st'>"text"</span>,
          text <span class='op'>=</span> <span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Location:"</span>, <span class='va'>location</span>, <span class='st'>"&lt;br&gt;"</span>,<span class='st'>"Date:"</span>, <span class='va'>date</span>, <span class='st'>"&lt;br&gt;"</span>,<span class='st'>"Time:"</span>, <span class='va'>time</span>, <span class='st'>"&lt;br&gt;"</span>, <span class='st'>"Day:"</span>, <span class='va'>day</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>add_lines</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>add_markers</span><span class='op'>(</span>showlegend <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/layout.html'>layout</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Most frequented places by groups of people"</span>, xaxis <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>""</span>, dtick <span class='op'>=</span> <span class='op'>~</span><span class='va'>date</span>, showgrid <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>, yaxis <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Number of people"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>cc_anti_timeseries</span>
</code></pre>
</div>
<div id="htmlwidget-13a3ca5a432e4019941f" style="width:624px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-13a3ca5a432e4019941f">{"x":{"visdat":{"4aec62336999":["function () ","plotlyVisDat"]},"cur_data":"4aec62336999","attrs":{"4aec62336999":{"x":{},"y":{},"hoverinfo":"text","text":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","mode":"lines","inherit":true},"4aec62336999.1":{"x":{},"y":{},"hoverinfo":"text","text":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","mode":"markers","showlegend":false,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Most frequented places by groups of people","xaxis":{"domain":[0,1],"automargin":true,"title":"","dtick":["2014-01-07","2014-01-07","2014-01-09","2014-01-14","2014-01-08","2014-01-10","2014-01-07","2014-01-06","2014-01-08","2014-01-16","2014-01-11","2014-01-07","2014-01-14","2014-01-15","2014-01-07"],"showgrid":false},"yaxis":{"domain":[0,1],"automargin":true,"title":"Number of people"},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":["2014-01-07","2014-01-08","2014-01-14"],"y":[3,2,2],"hoverinfo":["text","text","text"],"text":["Location: Bean There Done That <br> Date: 2014-01-07 <br> Time: 12:00 <br> Day: Tue","Location: Bean There Done That <br> Date: 2014-01-08 <br> Time: 12:00 <br> Day: Wed","Location: Bean There Done That <br> Date: 2014-01-14 <br> Time: 12:00 <br> Day: Tue"],"type":"scatter","mode":"lines","name":"Bean There Done That","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-10"],"y":[2],"hoverinfo":"text","text":"Location: Brew've Been Served <br> Date: 2014-01-10 <br> Time: 07:56 <br> Day: Fri","type":"scatter","mode":"lines","name":"Brew've Been Served","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-07"],"y":[3],"hoverinfo":"text","text":"Location: Brewed Awakenings <br> Date: 2014-01-07 <br> Time: 12:00 <br> Day: Tue","type":"scatter","mode":"lines","name":"Brewed Awakenings","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"line":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-07"],"y":[2],"hoverinfo":"text","text":"Location: Guy's Gyros <br> Date: 2014-01-07 <br> Time: 20:10 <br> Day: Tue","type":"scatter","mode":"lines","name":"Guy's Gyros","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"line":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-06","2014-01-08","2014-01-16"],"y":[2,2,2],"hoverinfo":["text","text","text"],"text":["Location: Hallowed Grounds <br> Date: 2014-01-06 <br> Time: 07:54 <br> Day: Mon","Location: Hallowed Grounds <br> Date: 2014-01-08 <br> Time: 07:39 <br> Day: Wed","Location: Hallowed Grounds <br> Date: 2014-01-16 <br> Time: 07:51 <br> Day: Thu"],"type":"scatter","mode":"lines","name":"Hallowed Grounds","marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"line":{"color":"rgba(166,216,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-11"],"y":[2],"hoverinfo":"text","text":"Location: Hippokampos <br> Date: 2014-01-11 <br> Time: 13:37 <br> Day: Sat","type":"scatter","mode":"lines","name":"Hippokampos","marker":{"color":"rgba(255,217,47,1)","line":{"color":"rgba(255,217,47,1)"}},"textfont":{"color":"rgba(255,217,47,1)"},"error_y":{"color":"rgba(255,217,47,1)"},"error_x":{"color":"rgba(255,217,47,1)"},"line":{"color":"rgba(255,217,47,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-07","2014-01-09","2014-01-14","2014-01-15"],"y":[2,3,2,2],"hoverinfo":["text","text","text","text"],"text":["Location: Jack's Magical Beans <br> Date: 2014-01-07 <br> Time: 12:00 <br> Day: Tue","Location: Jack's Magical Beans <br> Date: 2014-01-09 <br> Time: 12:00 <br> Day: Thu","Location: Jack's Magical Beans <br> Date: 2014-01-14 <br> Time: 12:00 <br> Day: Tue","Location: Jack's Magical Beans <br> Date: 2014-01-15 <br> Time: 12:00 <br> Day: Wed"],"type":"scatter","mode":"lines","name":"Jack's Magical Beans","marker":{"color":"rgba(229,196,148,1)","line":{"color":"rgba(229,196,148,1)"}},"textfont":{"color":"rgba(229,196,148,1)"},"error_y":{"color":"rgba(229,196,148,1)"},"error_x":{"color":"rgba(229,196,148,1)"},"line":{"color":"rgba(229,196,148,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-07"],"y":[2],"hoverinfo":"text","text":"Location: Katerina\u0012s Cafi <br> Date: 2014-01-07 <br> Time: 20:13 <br> Day: Tue","type":"scatter","mode":"lines","name":"Katerina\u0012s Cafi","marker":{"color":"rgba(179,179,179,1)","line":{"color":"rgba(179,179,179,1)"}},"textfont":{"color":"rgba(179,179,179,1)"},"error_y":{"color":"rgba(179,179,179,1)"},"error_x":{"color":"rgba(179,179,179,1)"},"line":{"color":"rgba(179,179,179,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-07","2014-01-14","2014-01-08"],"y":[3,2,2],"hoverinfo":["text","text","text"],"text":["Location: Bean There Done That <br> Date: 2014-01-07 <br> Time: 12:00 <br> Day: Tue","Location: Bean There Done That <br> Date: 2014-01-14 <br> Time: 12:00 <br> Day: Tue","Location: Bean There Done That <br> Date: 2014-01-08 <br> Time: 12:00 <br> Day: Wed"],"type":"scatter","mode":"markers","showlegend":false,"name":"Bean There Done That","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-10"],"y":[2],"hoverinfo":"text","text":"Location: Brew've Been Served <br> Date: 2014-01-10 <br> Time: 07:56 <br> Day: Fri","type":"scatter","mode":"markers","showlegend":false,"name":"Brew've Been Served","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-07"],"y":[3],"hoverinfo":"text","text":"Location: Brewed Awakenings <br> Date: 2014-01-07 <br> Time: 12:00 <br> Day: Tue","type":"scatter","mode":"markers","showlegend":false,"name":"Brewed Awakenings","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"line":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-07"],"y":[2],"hoverinfo":"text","text":"Location: Guy's Gyros <br> Date: 2014-01-07 <br> Time: 20:10 <br> Day: Tue","type":"scatter","mode":"markers","showlegend":false,"name":"Guy's Gyros","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"line":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-06","2014-01-08","2014-01-16"],"y":[2,2,2],"hoverinfo":["text","text","text"],"text":["Location: Hallowed Grounds <br> Date: 2014-01-06 <br> Time: 07:54 <br> Day: Mon","Location: Hallowed Grounds <br> Date: 2014-01-08 <br> Time: 07:39 <br> Day: Wed","Location: Hallowed Grounds <br> Date: 2014-01-16 <br> Time: 07:51 <br> Day: Thu"],"type":"scatter","mode":"markers","showlegend":false,"name":"Hallowed Grounds","marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"line":{"color":"rgba(166,216,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-11"],"y":[2],"hoverinfo":"text","text":"Location: Hippokampos <br> Date: 2014-01-11 <br> Time: 13:37 <br> Day: Sat","type":"scatter","mode":"markers","showlegend":false,"name":"Hippokampos","marker":{"color":"rgba(255,217,47,1)","line":{"color":"rgba(255,217,47,1)"}},"textfont":{"color":"rgba(255,217,47,1)"},"error_y":{"color":"rgba(255,217,47,1)"},"error_x":{"color":"rgba(255,217,47,1)"},"line":{"color":"rgba(255,217,47,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-09","2014-01-07","2014-01-14","2014-01-15"],"y":[3,2,2,2],"hoverinfo":["text","text","text","text"],"text":["Location: Jack's Magical Beans <br> Date: 2014-01-09 <br> Time: 12:00 <br> Day: Thu","Location: Jack's Magical Beans <br> Date: 2014-01-07 <br> Time: 12:00 <br> Day: Tue","Location: Jack's Magical Beans <br> Date: 2014-01-14 <br> Time: 12:00 <br> Day: Tue","Location: Jack's Magical Beans <br> Date: 2014-01-15 <br> Time: 12:00 <br> Day: Wed"],"type":"scatter","mode":"markers","showlegend":false,"name":"Jack's Magical Beans","marker":{"color":"rgba(229,196,148,1)","line":{"color":"rgba(229,196,148,1)"}},"textfont":{"color":"rgba(229,196,148,1)"},"error_y":{"color":"rgba(229,196,148,1)"},"error_x":{"color":"rgba(229,196,148,1)"},"line":{"color":"rgba(229,196,148,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-07"],"y":[2],"hoverinfo":"text","text":"Location: Katerina\u0012s Cafi <br> Date: 2014-01-07 <br> Time: 20:13 <br> Day: Tue","type":"scatter","mode":"markers","showlegend":false,"name":"Katerina\u0012s Cafi","marker":{"color":"rgba(179,179,179,1)","line":{"color":"rgba(179,179,179,1)"}},"textfont":{"color":"rgba(179,179,179,1)"},"error_y":{"color":"rgba(179,179,179,1)"},"error_x":{"color":"rgba(179,179,179,1)"},"line":{"color":"rgba(179,179,179,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<p>Similar to the above inner joined dataset, we will create a daytime column to observe which daytime has the highest count.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cc_loyalty_day_anti</span> <span class='op'>&lt;-</span> <span class='va'>cc_loyalty_antijoin</span> <span class='op'>%&gt;%</span>
  <span class='fu'>unite</span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"daytime"</span>, <span class='va'>day</span>,<span class='va'>time</span>, sep <span class='op'>=</span> <span class='st'>" "</span>,  remove <span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>location</span>, <span class='va'>daytime</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>summarize</span><span class='op'>(</span>count <span class='op'>=</span> <span class='fu'>n</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>arrange</span><span class='op'>(</span><span class='fu'>desc</span><span class='op'>(</span><span class='va'>count</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>cc_loyalty_day_anti</span>
</code></pre>
</div>
<pre><code># A tibble: 379 x 3
# Groups:   location [31]
   location             daytime   count
   &lt;chr&gt;                &lt;chr&gt;     &lt;int&gt;
 1 Bean There Done That Tue 12:00     5
 2 Jack&#39;s Magical Beans Tue 12:00     4
 3 Bean There Done That Wed 12:00     3
 4 Brewed Awakenings    Tue 12:00     3
 5 Hallowed Grounds     Thu 07:51     3
 6 Hallowed Grounds     Wed 07:39     3
 7 Jack&#39;s Magical Beans Thu 12:00     3
 8 Jack&#39;s Magical Beans Wed 12:00     3
 9 Bean There Done That Thu 12:00     2
10 Brew&#39;ve Been Served  Fri 07:56     2
# ... with 369 more rows</code></pre>
</div>
<p>Based on the chart below, we can see that the highest count per daytime is 5 counts of visitors at Bean there done that which was clocked on Tue, 12:00pm followed by Jackâ€™s Magical bean of 4 counts on the same day.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cc_anti_day</span> <span class='op'>&lt;-</span> <span class='va'>cc_loyalty_day_anti</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>count</span> <span class='op'>&gt;=</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>plot_ly</span><span class='op'>(</span>x <span class='op'>=</span> <span class='op'>~</span><span class='va'>daytime</span>, y <span class='op'>=</span> <span class='op'>~</span><span class='va'>count</span>, color <span class='op'>=</span> <span class='op'>~</span><span class='va'>location</span>, hoverinfo <span class='op'>=</span> <span class='st'>"text"</span>, text <span class='op'>=</span> <span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Location:"</span>, <span class='va'>location</span>, <span class='st'>"&lt;br&gt;"</span>,<span class='st'>"Day Time:"</span>, <span class='va'>daytime</span>, <span class='st'>"&lt;br&gt;"</span>, <span class='st'>"No.of visitors:"</span>, <span class='va'>count</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>add_bars</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/layout.html'>layout</a></span> <span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Total counts of visitors by day and time"</span>, xaxis <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>""</span>, size <span class='op'>=</span> <span class='fl'>3</span>, dtick <span class='op'>=</span> <span class='op'>~</span><span class='va'>daytime</span><span class='op'>)</span>, automargin <span class='op'>=</span> <span class='cn'>TRUE</span>, yaxis <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Number of visitors"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>cc_anti_day</span>
</code></pre>
</div>
<div id="htmlwidget-cf91e6258d7e33b6dfc4" style="width:624px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-cf91e6258d7e33b6dfc4">{"x":{"visdat":{"4aec4005502":["function () ","plotlyVisDat"]},"cur_data":"4aec4005502","attrs":{"4aec4005502":{"x":{},"y":{},"hoverinfo":"text","text":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Total counts of visitors by day and time","xaxis":{"domain":[0,1],"automargin":true,"title":"","size":3,"dtick":["Tue 12:00","Tue 12:00","Wed 12:00","Tue 12:00","Thu 07:51","Wed 07:39","Thu 12:00","Wed 12:00"],"type":"category","categoryorder":"array","categoryarray":["Thu 07:51","Thu 12:00","Tue 12:00","Wed 07:39","Wed 12:00"]},"automargin":true,"yaxis":{"domain":[0,1],"automargin":true,"title":"Number of visitors"},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":["Tue 12:00","Wed 12:00"],"y":[5,3],"hoverinfo":["text","text"],"text":["Location: Bean There Done That <br> Day Time: Tue 12:00 <br> No.of visitors: 5","Location: Bean There Done That <br> Day Time: Wed 12:00 <br> No.of visitors: 3"],"type":"bar","name":"Bean There Done That","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Tue 12:00"],"y":[3],"hoverinfo":"text","text":"Location: Brewed Awakenings <br> Day Time: Tue 12:00 <br> No.of visitors: 3","type":"bar","name":"Brewed Awakenings","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Thu 07:51","Wed 07:39"],"y":[3,3],"hoverinfo":["text","text"],"text":["Location: Hallowed Grounds <br> Day Time: Thu 07:51 <br> No.of visitors: 3","Location: Hallowed Grounds <br> Day Time: Wed 07:39 <br> No.of visitors: 3"],"type":"bar","name":"Hallowed Grounds","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Tue 12:00","Thu 12:00","Wed 12:00"],"y":[4,3,3],"hoverinfo":["text","text","text"],"text":["Location: Jack's Magical Beans <br> Day Time: Tue 12:00 <br> No.of visitors: 4","Location: Jack's Magical Beans <br> Day Time: Thu 12:00 <br> No.of visitors: 3","Location: Jack's Magical Beans <br> Day Time: Wed 12:00 <br> No.of visitors: 3"],"type":"bar","name":"Jack's Magical Beans","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<p>Next, we will anti join from loyalty to cc.</p>
<p>Based on the anti-joined data, we observe that there are 311 rows of transaction which uses loyalty card with no credit card.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cc_loyalty_antijoin_right</span> <span class='op'>&lt;-</span> <span class='va'>loyalty_dt</span><span class='op'>%&gt;%</span>
  <span class='fu'>anti_join</span><span class='op'>(</span><span class='va'>cc_dtsplit</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"date"</span>,<span class='st'>"location"</span>, <span class='st'>"price"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>cc_loyalty_antijoin_right</span>
</code></pre>
</div>
<pre><code># A tibble: 311 x 4
   date       location                    price loyaltynum
   &lt;date&gt;     &lt;chr&gt;                       &lt;dbl&gt; &lt;fct&gt;     
 1 2014-01-06 &quot;Coffee Shack&quot;              11.5  L6417     
 2 2014-01-06 &quot;Hallowed Grounds&quot;          12.9  L1107     
 3 2014-01-06 &quot;Abila Zacharo&quot;             26.9  L9018     
 4 2014-01-06 &quot;Katerina\u0012s Cafi&quot;      38.6  L6110     
 5 2014-01-06 &quot;Frydos Autosupply n&#39; More&quot; 89.3  L4034     
 6 2014-01-07 &quot;Hallowed Grounds&quot;           8.42 L1107     
 7 2014-01-07 &quot;Coffee Cameleon&quot;           12.4  L9018     
 8 2014-01-07 &quot;Ouzeri Elian&quot;              17.7  L2247     
 9 2014-01-07 &quot;Katerina\u0012s Cafi&quot;      25.0  L2343     
10 2014-01-08 &quot;Brew&#39;ve Been Served&quot;       14.9  L2247     
# ... with 301 more rows</code></pre>
</div>
<p>Notice that there is no day after the anti join was performed this is due to the fact that originally, the loyalty_dt dataset does not have the day included. As such, day is being created using the date_weekday_factor function.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cc_loyalty_antijoin_mutate</span> <span class='op'>&lt;-</span> <span class='va'>cc_loyalty_antijoin_right</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>day <span class='op'>=</span> <span class='fu'>date_weekday_factor</span><span class='op'>(</span><span class='va'>cc_loyalty_antijoin_right</span><span class='op'>$</span><span class='va'>date</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>cc_loyalty_antijoin_mutate</span>
</code></pre>
</div>
<pre><code># A tibble: 311 x 5
   date       location                    price loyaltynum day  
   &lt;date&gt;     &lt;chr&gt;                       &lt;dbl&gt; &lt;fct&gt;      &lt;ord&gt;
 1 2014-01-06 &quot;Coffee Shack&quot;              11.5  L6417      Mon  
 2 2014-01-06 &quot;Hallowed Grounds&quot;          12.9  L1107      Mon  
 3 2014-01-06 &quot;Abila Zacharo&quot;             26.9  L9018      Mon  
 4 2014-01-06 &quot;Katerina\u0012s Cafi&quot;      38.6  L6110      Mon  
 5 2014-01-06 &quot;Frydos Autosupply n&#39; More&quot; 89.3  L4034      Mon  
 6 2014-01-07 &quot;Hallowed Grounds&quot;           8.42 L1107      Tue  
 7 2014-01-07 &quot;Coffee Cameleon&quot;           12.4  L9018      Tue  
 8 2014-01-07 &quot;Ouzeri Elian&quot;              17.7  L2247      Tue  
 9 2014-01-07 &quot;Katerina\u0012s Cafi&quot;      25.0  L2343      Tue  
10 2014-01-08 &quot;Brew&#39;ve Been Served&quot;       14.9  L2247      Wed  
# ... with 301 more rows</code></pre>
</div>
<p>Similar to the previous inner join and left anti join data. The four highest visited locations are Katerinaâ€™s Cafe, Hippokampos, Brewâ€™s been served and Guyâ€™s Gyros.</p>
<p>Katerinaâ€™s Cafe and Hippokampos lead the two most visited location of 42 and 40 respectively.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cc_anti_right</span> <span class='op'>&lt;-</span> <span class='va'>cc_loyalty_antijoin_mutate</span> <span class='op'>%&gt;%</span>
  <span class='fu'>count</span><span class='op'>(</span><span class='va'>location</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>location <span class='op'>=</span> <span class='fu'>fct_reorder</span><span class='op'>(</span><span class='va'>location</span>, <span class='va'>n</span>, .desc <span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>plot_ly</span><span class='op'>(</span>x <span class='op'>=</span> <span class='op'>~</span><span class='va'>location</span>, y <span class='op'>=</span> <span class='op'>~</span><span class='va'>n</span>, marker <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='op'>~</span><span class='va'>n</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>add_bars</span><span class='op'>(</span>name <span class='op'>=</span> <span class='st'>"anti-join-right"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/layout.html'>layout</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Total number of visitation by area"</span>, xaxis <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>""</span>, automargin <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,yaxis <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Number of visitors"</span>, automargin <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>cc_anti_right</span>
</code></pre>
</div>
<div id="htmlwidget-4a09dae42ae25ca0723f" style="width:624px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-4a09dae42ae25ca0723f">{"x":{"visdat":{"4aec43182509":["function () ","plotlyVisDat"]},"cur_data":"4aec43182509","attrs":{"4aec43182509":{"x":{},"y":{},"marker":{"color":{}},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar","name":"anti-join-right","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Total number of visitation by area","xaxis":{"domain":[0,1],"automargin":true,"title":"","type":"category","categoryorder":"array","categoryarray":["Katerina\u0012s Cafi","Hippokampos","Brew've Been Served","Guy's Gyros","Ouzeri Elian","Hallowed Grounds","Abila Zacharo","Kalami Kafenion","Gelatogalore","Jack's Magical Beans","Bean There Done That","Coffee Cameleon","Brewed Awakenings","Frydos Autosupply n' More","Kronos Mart","Abila Airport","Stewart and Sons Fabrication","General Grocer","Nationwide Refinery","Carlyle Chemical Inc.","Shoppers' Delight","Chostus Hotel","Coffee Shack","Roberts and Sons","Ahaggo Museum","Albert's Fine Clothing","Desafio Golf Course","Kronos Pipe and Irrigation"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Number of visitors"},"hovermode":"closest","showlegend":false},"source":"A","config":{"showSendToCloud":false},"data":[{"x":["Abila Airport","Abila Zacharo","Ahaggo Museum","Albert's Fine Clothing","Bean There Done That","Brew've Been Served","Brewed Awakenings","Carlyle Chemical Inc.","Chostus Hotel","Coffee Cameleon","Coffee Shack","Desafio Golf Course","Frydos Autosupply n' More","Gelatogalore","General Grocer","Guy's Gyros","Hallowed Grounds","Hippokampos","Jack's Magical Beans","Kalami Kafenion","Katerina\u0012s Cafi","Kronos Mart","Kronos Pipe and Irrigation","Nationwide Refinery","Ouzeri Elian","Roberts and Sons","Shoppers' Delight","Stewart and Sons Fabrication"],"y":[6,19,1,1,9,29,8,3,2,9,2,1,8,12,4,27,20,40,10,13,42,8,1,4,22,2,3,5],"marker":{"color":[6,19,1,1,9,29,8,3,2,9,2,1,8,12,4,27,20,40,10,13,42,8,1,4,22,2,3,5],"line":{"color":"rgba(31,119,180,1)"}},"type":"bar","name":"anti-join-right","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<p>Next, we will group the right anti joined dataset to get the count per day based on location.</p>
<p>From the below chart, we can see that Hallowed Grounds have the highest count of 6 visitations on 2014-01-09.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cc_loyalty_day_anti_right</span> <span class='op'>&lt;-</span> <span class='va'>cc_loyalty_antijoin_mutate</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>location</span>, <span class='va'>date</span>,<span class='va'>day</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>summarize</span><span class='op'>(</span>count <span class='op'>=</span> <span class='fu'>n</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>arrange</span><span class='op'>(</span><span class='fu'>desc</span><span class='op'>(</span><span class='va'>count</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>cc_loyalty_day_anti_right</span>
</code></pre>
</div>
<pre><code># A tibble: 161 x 4
   location               date       day   count
   &lt;chr&gt;                  &lt;date&gt;     &lt;ord&gt; &lt;int&gt;
 1 &quot;Hallowed Grounds&quot;     2014-01-09 Thu       6
 2 &quot;Brew&#39;ve Been Served&quot;  2014-01-08 Wed       5
 3 &quot;Brew&#39;ve Been Served&quot;  2014-01-09 Thu       5
 4 &quot;Brew&#39;ve Been Served&quot;  2014-01-10 Fri       5
 5 &quot;Guy&#39;s Gyros&quot;          2014-01-15 Wed       5
 6 &quot;Hippokampos&quot;          2014-01-10 Fri       5
 7 &quot;Katerina\u0012s Cafi&quot; 2014-01-13 Mon       5
 8 &quot;Katerina\u0012s Cafi&quot; 2014-01-14 Tue       5
 9 &quot;Katerina\u0012s Cafi&quot; 2014-01-16 Thu       5
10 &quot;Abila Zacharo&quot;        2014-01-13 Mon       4
# ... with 151 more rows</code></pre>
</div>
<p>Next, we will created a bar chart to analyse those visitations of more than or equal to 4 counts. Based on the chart below, we can see that although Hallowed Grounds has the highest visitation at one point, however, it only clock once. This is also considered another anomaly as the count of visitations is not consistent in the dataset provided.</p>
<p>The next highest count of 5 visitations were clocked by Guysâ€™s Gyros on 2014-01-15, Hippokampos on 2014-01-10, Katerinaâ€™s Cafe and Brewâ€™s been served on three different occasions.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cc_anti_day_right</span> <span class='op'>&lt;-</span> <span class='va'>cc_loyalty_day_anti_right</span> <span class='op'>%&gt;%</span>
  <span class='fu'>unite</span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"daydate"</span>, <span class='va'>day</span>, <span class='va'>date</span>, sep <span class='op'>=</span> <span class='st'>" "</span>, remove <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>count</span> <span class='op'>&gt;=</span><span class='fl'>4</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>plot_ly</span><span class='op'>(</span>x <span class='op'>=</span> <span class='op'>~</span><span class='va'>daydate</span>, y <span class='op'>=</span> <span class='op'>~</span><span class='va'>count</span>, color <span class='op'>=</span> <span class='op'>~</span><span class='va'>location</span>, hoverinfo <span class='op'>=</span> <span class='st'>"text"</span>, text <span class='op'>=</span> <span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Location:"</span>, <span class='va'>location</span>, <span class='st'>"&lt;br&gt;"</span>,<span class='st'>"DayDate:"</span>, <span class='va'>daydate</span>, <span class='st'>"&lt;br&gt;"</span>, <span class='st'>"No.of visitors:"</span>, <span class='va'>count</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>add_bars</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/layout.html'>layout</a></span> <span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Total counts of visitors by date"</span>, xaxis <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>""</span>, size <span class='op'>=</span> <span class='fl'>3</span>, dtick <span class='op'>=</span> <span class='op'>~</span><span class='va'>daydate</span><span class='op'>)</span>, automargin <span class='op'>=</span> <span class='cn'>TRUE</span>, yaxis <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Number of visitors"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>cc_anti_day_right</span>
</code></pre>
</div>
<div id="htmlwidget-b64a1a51cfe7fb09be73" style="width:624px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-b64a1a51cfe7fb09be73">{"x":{"visdat":{"4aec65c823b7":["function () ","plotlyVisDat"]},"cur_data":"4aec65c823b7","attrs":{"4aec65c823b7":{"x":{},"y":{},"hoverinfo":"text","text":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Total counts of visitors by date","xaxis":{"domain":[0,1],"automargin":true,"title":"","size":3,"dtick":["Thu 2014-01-09","Wed 2014-01-08","Thu 2014-01-09","Fri 2014-01-10","Wed 2014-01-15","Fri 2014-01-10","Mon 2014-01-13","Tue 2014-01-14","Thu 2014-01-16","Mon 2014-01-13","Fri 2014-01-17","Tue 2014-01-07","Tue 2014-01-07","Mon 2014-01-13","Wed 2014-01-15","Fri 2014-01-17","Tue 2014-01-14","Tue 2014-01-07","Wed 2014-01-15","Fri 2014-01-17","Tue 2014-01-07","Wed 2014-01-08","Tue 2014-01-14"],"type":"category","categoryorder":"array","categoryarray":["Fri 2014-01-10","Fri 2014-01-17","Mon 2014-01-13","Thu 2014-01-09","Thu 2014-01-16","Tue 2014-01-07","Tue 2014-01-14","Wed 2014-01-08","Wed 2014-01-15"]},"automargin":true,"yaxis":{"domain":[0,1],"automargin":true,"title":"Number of visitors"},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":["Mon 2014-01-13","Fri 2014-01-17"],"y":[4,4],"hoverinfo":["text","text"],"text":["Location: Abila Zacharo <br> DayDate: Mon 2014-01-13 <br> No.of visitors: 4","Location: Abila Zacharo <br> DayDate: Fri 2014-01-17 <br> No.of visitors: 4"],"type":"bar","name":"Abila Zacharo","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Wed 2014-01-08","Thu 2014-01-09","Fri 2014-01-10"],"y":[5,5,5],"hoverinfo":["text","text","text"],"text":["Location: Brew've Been Served <br> DayDate: Wed 2014-01-08 <br> No.of visitors: 5","Location: Brew've Been Served <br> DayDate: Thu 2014-01-09 <br> No.of visitors: 5","Location: Brew've Been Served <br> DayDate: Fri 2014-01-10 <br> No.of visitors: 5"],"type":"bar","name":"Brew've Been Served","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Wed 2014-01-15","Tue 2014-01-07"],"y":[5,4],"hoverinfo":["text","text"],"text":["Location: Guy's Gyros <br> DayDate: Wed 2014-01-15 <br> No.of visitors: 5","Location: Guy's Gyros <br> DayDate: Tue 2014-01-07 <br> No.of visitors: 4"],"type":"bar","name":"Guy's Gyros","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Thu 2014-01-09"],"y":[6],"hoverinfo":"text","text":"Location: Hallowed Grounds <br> DayDate: Thu 2014-01-09 <br> No.of visitors: 6","type":"bar","name":"Hallowed Grounds","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Fri 2014-01-10","Tue 2014-01-07","Mon 2014-01-13","Wed 2014-01-15","Fri 2014-01-17"],"y":[5,4,4,4,4],"hoverinfo":["text","text","text","text","text"],"text":["Location: Hippokampos <br> DayDate: Fri 2014-01-10 <br> No.of visitors: 5","Location: Hippokampos <br> DayDate: Tue 2014-01-07 <br> No.of visitors: 4","Location: Hippokampos <br> DayDate: Mon 2014-01-13 <br> No.of visitors: 4","Location: Hippokampos <br> DayDate: Wed 2014-01-15 <br> No.of visitors: 4","Location: Hippokampos <br> DayDate: Fri 2014-01-17 <br> No.of visitors: 4"],"type":"bar","name":"Hippokampos","marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Tue 2014-01-14"],"y":[4],"hoverinfo":"text","text":"Location: Jack's Magical Beans <br> DayDate: Tue 2014-01-14 <br> No.of visitors: 4","type":"bar","name":"Jack's Magical Beans","marker":{"color":"rgba(255,217,47,1)","line":{"color":"rgba(255,217,47,1)"}},"textfont":{"color":"rgba(255,217,47,1)"},"error_y":{"color":"rgba(255,217,47,1)"},"error_x":{"color":"rgba(255,217,47,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Mon 2014-01-13","Tue 2014-01-14","Thu 2014-01-16","Tue 2014-01-07","Wed 2014-01-15","Fri 2014-01-17"],"y":[5,5,5,4,4,4],"hoverinfo":["text","text","text","text","text","text"],"text":["Location: Katerina\u0012s Cafi <br> DayDate: Mon 2014-01-13 <br> No.of visitors: 5","Location: Katerina\u0012s Cafi <br> DayDate: Tue 2014-01-14 <br> No.of visitors: 5","Location: Katerina\u0012s Cafi <br> DayDate: Thu 2014-01-16 <br> No.of visitors: 5","Location: Katerina\u0012s Cafi <br> DayDate: Tue 2014-01-07 <br> No.of visitors: 4","Location: Katerina\u0012s Cafi <br> DayDate: Wed 2014-01-15 <br> No.of visitors: 4","Location: Katerina\u0012s Cafi <br> DayDate: Fri 2014-01-17 <br> No.of visitors: 4"],"type":"bar","name":"Katerina\u0012s Cafi","marker":{"color":"rgba(229,196,148,1)","line":{"color":"rgba(229,196,148,1)"}},"textfont":{"color":"rgba(229,196,148,1)"},"error_y":{"color":"rgba(229,196,148,1)"},"error_x":{"color":"rgba(229,196,148,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Tue 2014-01-07","Wed 2014-01-08","Tue 2014-01-14"],"y":[4,4,4],"hoverinfo":["text","text","text"],"text":["Location: Ouzeri Elian <br> DayDate: Tue 2014-01-07 <br> No.of visitors: 4","Location: Ouzeri Elian <br> DayDate: Wed 2014-01-08 <br> No.of visitors: 4","Location: Ouzeri Elian <br> DayDate: Tue 2014-01-14 <br> No.of visitors: 4"],"type":"bar","name":"Ouzeri Elian","marker":{"color":"rgba(179,179,179,1)","line":{"color":"rgba(179,179,179,1)"}},"textfont":{"color":"rgba(179,179,179,1)"},"error_y":{"color":"rgba(179,179,179,1)"},"error_x":{"color":"rgba(179,179,179,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<p>Next, we will created a time-series chart to see the trends of visitations to the respective locations.</p>
<p>One more peculiar occurrence can be discovered from the chart below. Brewâ€™s Been Served has 5 transactions consecutively for 3 days. However, after which no visits were recorded of Brewâ€™ve been served for right anti join of more than or equal to 4 transactions.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"> <span class='va'>cc_anti_timeseries_right</span> <span class='op'>&lt;-</span> <span class='va'>cc_loyalty_day_anti_right</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>count</span> <span class='op'>&gt;=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>plot_ly</span><span class='op'>(</span>x <span class='op'>=</span> <span class='op'>~</span><span class='va'>date</span>, y <span class='op'>=</span><span class='op'>~</span><span class='va'>count</span>, color <span class='op'>=</span> <span class='op'>~</span><span class='va'>location</span>, hoverinfo <span class='op'>=</span> <span class='st'>"text"</span>,
          text <span class='op'>=</span> <span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Location:"</span>, <span class='va'>location</span>, <span class='st'>"&lt;br&gt;"</span>,<span class='st'>"Date:"</span>, <span class='va'>date</span>, <span class='st'>"&lt;br&gt;"</span>, <span class='st'>"&lt;br&gt;"</span>, <span class='st'>"Day:"</span>, <span class='va'>day</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>add_lines</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>add_markers</span><span class='op'>(</span>showlegend <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/layout.html'>layout</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Most frequented places by groups of people"</span>, xaxis <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>""</span>, dtick <span class='op'>=</span> <span class='op'>~</span><span class='va'>date</span>, showgrid <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>, yaxis <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Number of people"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>cc_anti_timeseries_right</span>
</code></pre>
</div>
<div id="htmlwidget-585e1e5f1fd97f6cdadb" style="width:624px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-585e1e5f1fd97f6cdadb">{"x":{"visdat":{"4aec433e6988":["function () ","plotlyVisDat"]},"cur_data":"4aec433e6988","attrs":{"4aec433e6988":{"x":{},"y":{},"hoverinfo":"text","text":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","mode":"lines","inherit":true},"4aec433e6988.1":{"x":{},"y":{},"hoverinfo":"text","text":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","mode":"markers","showlegend":false,"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Most frequented places by groups of people","xaxis":{"domain":[0,1],"automargin":true,"title":"","dtick":["2014-01-09","2014-01-08","2014-01-09","2014-01-10","2014-01-15","2014-01-10","2014-01-13","2014-01-14","2014-01-16","2014-01-13","2014-01-17","2014-01-07","2014-01-07","2014-01-13","2014-01-15","2014-01-17","2014-01-14","2014-01-07","2014-01-15","2014-01-17","2014-01-07","2014-01-08","2014-01-14"],"showgrid":false},"yaxis":{"domain":[0,1],"automargin":true,"title":"Number of people"},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":["2014-01-13","2014-01-17"],"y":[4,4],"hoverinfo":["text","text"],"text":["Location: Abila Zacharo <br> Date: 2014-01-13 <br> <br> Day: Mon","Location: Abila Zacharo <br> Date: 2014-01-17 <br> <br> Day: Fri"],"type":"scatter","mode":"lines","name":"Abila Zacharo","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-08","2014-01-09","2014-01-10"],"y":[5,5,5],"hoverinfo":["text","text","text"],"text":["Location: Brew've Been Served <br> Date: 2014-01-08 <br> <br> Day: Wed","Location: Brew've Been Served <br> Date: 2014-01-09 <br> <br> Day: Thu","Location: Brew've Been Served <br> Date: 2014-01-10 <br> <br> Day: Fri"],"type":"scatter","mode":"lines","name":"Brew've Been Served","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-07","2014-01-15"],"y":[4,5],"hoverinfo":["text","text"],"text":["Location: Guy's Gyros <br> Date: 2014-01-07 <br> <br> Day: Tue","Location: Guy's Gyros <br> Date: 2014-01-15 <br> <br> Day: Wed"],"type":"scatter","mode":"lines","name":"Guy's Gyros","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"line":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-09"],"y":[6],"hoverinfo":"text","text":"Location: Hallowed Grounds <br> Date: 2014-01-09 <br> <br> Day: Thu","type":"scatter","mode":"lines","name":"Hallowed Grounds","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"line":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-07","2014-01-10","2014-01-13","2014-01-15","2014-01-17"],"y":[4,5,4,4,4],"hoverinfo":["text","text","text","text","text"],"text":["Location: Hippokampos <br> Date: 2014-01-07 <br> <br> Day: Tue","Location: Hippokampos <br> Date: 2014-01-10 <br> <br> Day: Fri","Location: Hippokampos <br> Date: 2014-01-13 <br> <br> Day: Mon","Location: Hippokampos <br> Date: 2014-01-15 <br> <br> Day: Wed","Location: Hippokampos <br> Date: 2014-01-17 <br> <br> Day: Fri"],"type":"scatter","mode":"lines","name":"Hippokampos","marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"line":{"color":"rgba(166,216,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-14"],"y":[4],"hoverinfo":"text","text":"Location: Jack's Magical Beans <br> Date: 2014-01-14 <br> <br> Day: Tue","type":"scatter","mode":"lines","name":"Jack's Magical Beans","marker":{"color":"rgba(255,217,47,1)","line":{"color":"rgba(255,217,47,1)"}},"textfont":{"color":"rgba(255,217,47,1)"},"error_y":{"color":"rgba(255,217,47,1)"},"error_x":{"color":"rgba(255,217,47,1)"},"line":{"color":"rgba(255,217,47,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-07","2014-01-13","2014-01-14","2014-01-15","2014-01-16","2014-01-17"],"y":[4,5,5,4,5,4],"hoverinfo":["text","text","text","text","text","text"],"text":["Location: Katerina\u0012s Cafi <br> Date: 2014-01-07 <br> <br> Day: Tue","Location: Katerina\u0012s Cafi <br> Date: 2014-01-13 <br> <br> Day: Mon","Location: Katerina\u0012s Cafi <br> Date: 2014-01-14 <br> <br> Day: Tue","Location: Katerina\u0012s Cafi <br> Date: 2014-01-15 <br> <br> Day: Wed","Location: Katerina\u0012s Cafi <br> Date: 2014-01-16 <br> <br> Day: Thu","Location: Katerina\u0012s Cafi <br> Date: 2014-01-17 <br> <br> Day: Fri"],"type":"scatter","mode":"lines","name":"Katerina\u0012s Cafi","marker":{"color":"rgba(229,196,148,1)","line":{"color":"rgba(229,196,148,1)"}},"textfont":{"color":"rgba(229,196,148,1)"},"error_y":{"color":"rgba(229,196,148,1)"},"error_x":{"color":"rgba(229,196,148,1)"},"line":{"color":"rgba(229,196,148,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-07","2014-01-08","2014-01-14"],"y":[4,4,4],"hoverinfo":["text","text","text"],"text":["Location: Ouzeri Elian <br> Date: 2014-01-07 <br> <br> Day: Tue","Location: Ouzeri Elian <br> Date: 2014-01-08 <br> <br> Day: Wed","Location: Ouzeri Elian <br> Date: 2014-01-14 <br> <br> Day: Tue"],"type":"scatter","mode":"lines","name":"Ouzeri Elian","marker":{"color":"rgba(179,179,179,1)","line":{"color":"rgba(179,179,179,1)"}},"textfont":{"color":"rgba(179,179,179,1)"},"error_y":{"color":"rgba(179,179,179,1)"},"error_x":{"color":"rgba(179,179,179,1)"},"line":{"color":"rgba(179,179,179,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-13","2014-01-17"],"y":[4,4],"hoverinfo":["text","text"],"text":["Location: Abila Zacharo <br> Date: 2014-01-13 <br> <br> Day: Mon","Location: Abila Zacharo <br> Date: 2014-01-17 <br> <br> Day: Fri"],"type":"scatter","mode":"markers","showlegend":false,"name":"Abila Zacharo","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-08","2014-01-09","2014-01-10"],"y":[5,5,5],"hoverinfo":["text","text","text"],"text":["Location: Brew've Been Served <br> Date: 2014-01-08 <br> <br> Day: Wed","Location: Brew've Been Served <br> Date: 2014-01-09 <br> <br> Day: Thu","Location: Brew've Been Served <br> Date: 2014-01-10 <br> <br> Day: Fri"],"type":"scatter","mode":"markers","showlegend":false,"name":"Brew've Been Served","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-15","2014-01-07"],"y":[5,4],"hoverinfo":["text","text"],"text":["Location: Guy's Gyros <br> Date: 2014-01-15 <br> <br> Day: Wed","Location: Guy's Gyros <br> Date: 2014-01-07 <br> <br> Day: Tue"],"type":"scatter","mode":"markers","showlegend":false,"name":"Guy's Gyros","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"line":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-09"],"y":[6],"hoverinfo":"text","text":"Location: Hallowed Grounds <br> Date: 2014-01-09 <br> <br> Day: Thu","type":"scatter","mode":"markers","showlegend":false,"name":"Hallowed Grounds","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"line":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-10","2014-01-07","2014-01-13","2014-01-15","2014-01-17"],"y":[5,4,4,4,4],"hoverinfo":["text","text","text","text","text"],"text":["Location: Hippokampos <br> Date: 2014-01-10 <br> <br> Day: Fri","Location: Hippokampos <br> Date: 2014-01-07 <br> <br> Day: Tue","Location: Hippokampos <br> Date: 2014-01-13 <br> <br> Day: Mon","Location: Hippokampos <br> Date: 2014-01-15 <br> <br> Day: Wed","Location: Hippokampos <br> Date: 2014-01-17 <br> <br> Day: Fri"],"type":"scatter","mode":"markers","showlegend":false,"name":"Hippokampos","marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"line":{"color":"rgba(166,216,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-14"],"y":[4],"hoverinfo":"text","text":"Location: Jack's Magical Beans <br> Date: 2014-01-14 <br> <br> Day: Tue","type":"scatter","mode":"markers","showlegend":false,"name":"Jack's Magical Beans","marker":{"color":"rgba(255,217,47,1)","line":{"color":"rgba(255,217,47,1)"}},"textfont":{"color":"rgba(255,217,47,1)"},"error_y":{"color":"rgba(255,217,47,1)"},"error_x":{"color":"rgba(255,217,47,1)"},"line":{"color":"rgba(255,217,47,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-13","2014-01-14","2014-01-16","2014-01-07","2014-01-15","2014-01-17"],"y":[5,5,5,4,4,4],"hoverinfo":["text","text","text","text","text","text"],"text":["Location: Katerina\u0012s Cafi <br> Date: 2014-01-13 <br> <br> Day: Mon","Location: Katerina\u0012s Cafi <br> Date: 2014-01-14 <br> <br> Day: Tue","Location: Katerina\u0012s Cafi <br> Date: 2014-01-16 <br> <br> Day: Thu","Location: Katerina\u0012s Cafi <br> Date: 2014-01-07 <br> <br> Day: Tue","Location: Katerina\u0012s Cafi <br> Date: 2014-01-15 <br> <br> Day: Wed","Location: Katerina\u0012s Cafi <br> Date: 2014-01-17 <br> <br> Day: Fri"],"type":"scatter","mode":"markers","showlegend":false,"name":"Katerina\u0012s Cafi","marker":{"color":"rgba(229,196,148,1)","line":{"color":"rgba(229,196,148,1)"}},"textfont":{"color":"rgba(229,196,148,1)"},"error_y":{"color":"rgba(229,196,148,1)"},"error_x":{"color":"rgba(229,196,148,1)"},"line":{"color":"rgba(229,196,148,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2014-01-07","2014-01-08","2014-01-14"],"y":[4,4,4],"hoverinfo":["text","text","text"],"text":["Location: Ouzeri Elian <br> Date: 2014-01-07 <br> <br> Day: Tue","Location: Ouzeri Elian <br> Date: 2014-01-08 <br> <br> Day: Wed","Location: Ouzeri Elian <br> Date: 2014-01-14 <br> <br> Day: Tue"],"type":"scatter","mode":"markers","showlegend":false,"name":"Ouzeri Elian","marker":{"color":"rgba(179,179,179,1)","line":{"color":"rgba(179,179,179,1)"}},"textfont":{"color":"rgba(179,179,179,1)"},"error_y":{"color":"rgba(179,179,179,1)"},"error_x":{"color":"rgba(179,179,179,1)"},"line":{"color":"rgba(179,179,179,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<p>Next, we will create a facet grid of all the three joined dataset to analyse everything at one go. To create a facet grid, we will use the subplot function based on the plotly package to create three chart side by side for analysis.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>subplot</span><span class='op'>(</span><span class='va'>cc_join</span>, <span class='va'>cc_anti</span>, <span class='va'>cc_anti_right</span>, nrows <span class='op'>=</span> <span class='fl'>1</span>, shareX <span class='op'>=</span> <span class='cn'>TRUE</span>, shareY <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
<div id="htmlwidget-19fc65ef601169481516" style="width:624px;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-19fc65ef601169481516">{"x":{"data":[{"x":["Abila Airport","Abila Scrapyard","Abila Zacharo","Ahaggo Museum","Albert's Fine Clothing","Bean There Done That","Brew've Been Served","Brewed Awakenings","Carlyle Chemical Inc.","Chostus Hotel","Coffee Cameleon","Coffee Shack","Desafio Golf Course","Frank's Fuel","Frydos Autosupply n' More","Gelatogalore","General Grocer","Guy's Gyros","Hallowed Grounds","Hippokampos","Jack's Magical Beans","Kalami Kafenion","Katerina\u0012s Cafi","Kronos Pipe and Irrigation","Maximum Iron and Steel","Nationwide Refinery","Octavio's Office Supplies","Ouzeri Elian","Roberts and Sons","Shoppers' Delight","Stewart and Sons Fabrication","U-Pump"],"y":[20,4,52,5,24,36,111,21,16,6,28,7,7,2,34,48,8,121,60,117,25,53,155,5,6,19,3,62,4,15,12,1],"marker":{"color":[20,4,52,5,24,36,111,21,16,6,28,7,7,2,34,48,8,121,60,117,25,53,155,5,6,19,3,62,4,15,12,1],"line":{"color":"rgba(31,119,180,1)"}},"type":"bar","name":"inner-join","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Abila Airport","Abila Zacharo","Ahaggo Museum","Albert's Fine Clothing","Bean There Done That","Brew've Been Served","Brewed Awakenings","Carlyle Chemical Inc.","Chostus Hotel","Coffee Cameleon","Coffee Shack","Daily Dealz","Desafio Golf Course","Frydos Autosupply n' More","Gelatogalore","General Grocer","Guy's Gyros","Hallowed Grounds","Hippokampos","Jack's Magical Beans","Kalami Kafenion","Katerina\u0012s Cafi","Kronos Mart","Kronos Pipe and Irrigation","Nationwide Refinery","Octavio's Office Supplies","Ouzeri Elian","Roberts and Sons","Shoppers' Delight","Stewart and Sons Fabrication","U-Pump"],"y":[5,20,1,1,11,45,9,3,3,10,1,1,1,13,16,2,39,32,56,12,11,59,10,1,5,1,25,4,5,6,1],"marker":{"color":[5,20,1,1,11,45,9,3,3,10,1,1,1,13,16,2,39,32,56,12,11,59,10,1,5,1,25,4,5,6,1],"line":{"color":"rgba(255,127,14,1)"}},"type":"bar","name":"anti-join","error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x2","yaxis":"y","frame":null},{"x":["Abila Airport","Abila Zacharo","Ahaggo Museum","Albert's Fine Clothing","Bean There Done That","Brew've Been Served","Brewed Awakenings","Carlyle Chemical Inc.","Chostus Hotel","Coffee Cameleon","Coffee Shack","Desafio Golf Course","Frydos Autosupply n' More","Gelatogalore","General Grocer","Guy's Gyros","Hallowed Grounds","Hippokampos","Jack's Magical Beans","Kalami Kafenion","Katerina\u0012s Cafi","Kronos Mart","Kronos Pipe and Irrigation","Nationwide Refinery","Ouzeri Elian","Roberts and Sons","Shoppers' Delight","Stewart and Sons Fabrication"],"y":[6,19,1,1,9,29,8,3,2,9,2,1,8,12,4,27,20,40,10,13,42,8,1,4,22,2,3,5],"marker":{"color":[6,19,1,1,9,29,8,3,2,9,2,1,8,12,4,27,20,40,10,13,42,8,1,4,22,2,3,5],"line":{"color":"rgba(44,160,44,1)"}},"type":"bar","name":"anti-join-right","error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x3","yaxis":"y","frame":null}],"layout":{"xaxis":{"domain":[0,0.313333333333333],"automargin":true,"title":"","type":"category","categoryorder":"array","categoryarray":["Katerina\u0012s Cafi","Guy's Gyros","Hippokampos","Brew've Been Served","Ouzeri Elian","Hallowed Grounds","Kalami Kafenion","Abila Zacharo","Gelatogalore","Bean There Done That","Frydos Autosupply n' More","Coffee Cameleon","Jack's Magical Beans","Albert's Fine Clothing","Brewed Awakenings","Abila Airport","Nationwide Refinery","Carlyle Chemical Inc.","Shoppers' Delight","Stewart and Sons Fabrication","General Grocer","Coffee Shack","Desafio Golf Course","Chostus Hotel","Maximum Iron and Steel","Ahaggo Museum","Kronos Pipe and Irrigation","Abila Scrapyard","Roberts and Sons","Octavio's Office Supplies","Frank's Fuel","U-Pump"],"anchor":"y"},"xaxis2":{"domain":[0.353333333333333,0.646666666666667],"automargin":true,"title":"","type":"category","categoryorder":"array","categoryarray":["Katerina\u0012s Cafi","Hippokampos","Brew've Been Served","Guy's Gyros","Hallowed Grounds","Ouzeri Elian","Abila Zacharo","Gelatogalore","Frydos Autosupply n' More","Jack's Magical Beans","Bean There Done That","Kalami Kafenion","Coffee Cameleon","Kronos Mart","Brewed Awakenings","Stewart and Sons Fabrication","Abila Airport","Nationwide Refinery","Shoppers' Delight","Roberts and Sons","Carlyle Chemical Inc.","Chostus Hotel","General Grocer","Ahaggo Museum","Albert's Fine Clothing","Coffee Shack","Daily Dealz","Desafio Golf Course","Kronos Pipe and Irrigation","Octavio's Office Supplies","U-Pump"],"anchor":"y"},"xaxis3":{"domain":[0.686666666666667,1],"automargin":true,"title":"","type":"category","categoryorder":"array","categoryarray":["Katerina\u0012s Cafi","Hippokampos","Brew've Been Served","Guy's Gyros","Ouzeri Elian","Hallowed Grounds","Abila Zacharo","Kalami Kafenion","Gelatogalore","Jack's Magical Beans","Bean There Done That","Coffee Cameleon","Brewed Awakenings","Frydos Autosupply n' More","Kronos Mart","Abila Airport","Stewart and Sons Fabrication","General Grocer","Nationwide Refinery","Carlyle Chemical Inc.","Shoppers' Delight","Chostus Hotel","Coffee Shack","Roberts and Sons","Ahaggo Museum","Albert's Fine Clothing","Desafio Golf Course","Kronos Pipe and Irrigation"],"anchor":"y"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Number of visitors","anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Total number of visitation by area","hovermode":"closest","showlegend":true},"attrs":{"4aec356e5715":{"x":{},"y":{},"marker":{"color":{}},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar","name":"inner-join","inherit":true},"4aec702b449d":{"x":{},"y":{},"marker":{"color":{}},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar","name":"anti-join","inherit":true},"4aec43182509":{"x":{},"y":{},"marker":{"color":{}},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar","name":"anti-join-right","inherit":true}},"source":"A","config":{"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<p>Lastly, we will the cc_loyalty_join dataset with itself by â€œlast4ccnumâ€,â€œlocationâ€,â€œpriceâ€, â€œtimeâ€, â€œdateâ€ and filter by different loyaltynum. The cc_loyalty dataset is the initial inner join dataset.</p>
<p>Based on the below tibble. We can see that there are 12 instances where there are 6 cc users using different loyaltynum. This is another anomaly that has been found.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>cc_loyalty_join</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>inner_join</span><span class='op'>(</span><span class='va'>cc_loyalty_join</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"last4ccnum"</span>, <span class='st'>"location"</span>, <span class='st'>"price"</span>,<span class='st'>"time"</span>, <span class='st'>"date"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>loyaltynum.x</span> <span class='op'>!=</span> <span class='va'>loyaltynum.y</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 12 x 11
   timestamp.x         location      price last4ccnum day.x date      
   &lt;dttm&gt;              &lt;chr&gt;         &lt;dbl&gt; &lt;fct&gt;      &lt;ord&gt; &lt;date&gt;    
 1 2014-01-09 19:30:00 &quot;Katerina\u0~ 26.6  5921       Thu   2014-01-09
 2 2014-01-09 19:30:00 &quot;Katerina\u0~ 26.6  5921       Thu   2014-01-09
 3 2014-01-09 20:06:00 &quot;Katerina\u0~ 26.6  4948       Thu   2014-01-09
 4 2014-01-09 20:06:00 &quot;Katerina\u0~ 26.6  4948       Thu   2014-01-09
 5 2014-01-09 20:23:00 &quot;Guy&#39;s Gyros&quot;  8.23 7889       Thu   2014-01-09
 6 2014-01-09 20:23:00 &quot;Guy&#39;s Gyros&quot;  8.23 7889       Thu   2014-01-09
 7 2014-01-09 20:38:00 &quot;Guy&#39;s Gyros&quot;  8.23 5368       Thu   2014-01-09
 8 2014-01-09 20:38:00 &quot;Guy&#39;s Gyros&quot;  8.23 5368       Thu   2014-01-09
 9 2014-01-11 19:29:00 &quot;Hippokampos&quot; 63.2  4795       Sat   2014-01-11
10 2014-01-11 19:29:00 &quot;Hippokampos&quot; 63.2  4795       Sat   2014-01-11
11 2014-01-11 19:45:00 &quot;Hippokampos&quot; 63.2  8332       Sat   2014-01-11
12 2014-01-11 19:45:00 &quot;Hippokampos&quot; 63.2  8332       Sat   2014-01-11
# ... with 5 more variables: time &lt;chr&gt;, loyaltynum.x &lt;fct&gt;,
#   timestamp.y &lt;dttm&gt;, day.y &lt;ord&gt;, loyaltynum.y &lt;fct&gt;</code></pre>
</div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
